webpackJsonp([1],{"+IY7":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return l.default.createElement(s.default,{cardname:"管理"},l.default.createElement("div",{className:"lum-list "},l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/managements/favorites"},l.default.createElement("h4",null,"我的收藏"),l.default.createElement("p",null,"查看、导出、删除收藏的句子。"))),l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/managements/sources"},l.default.createElement("h4",null,"来源管理"),l.default.createElement("p",null,"管理添加获取句子的URL"))),l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/managements/patterns"},l.default.createElement("h4",null,"模式管理"),l.default.createElement("p",null,"根据自己喜好选择来源形成模式"))),l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/managements/sync"},l.default.createElement("h4",null,"离线缓存"),l.default.createElement("p",null,"将来源的全部句子缓存到本地，离线时也可以使用"))),l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/managements/cleaner"},l.default.createElement("h4",null,"缓存清理"),l.default.createElement("p",null,"清理本地缓存，例如已经删除了的来源的遗留下的缓存"))))))}Object.defineProperty(t,"__esModule",{value:!0});var r=n("GiK3"),l=a(r),i=n("F8kA"),u=n("gK+r"),s=a(u);t.default=o},"+Jqa":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("O27J"),d=a(c),f=n("KSGD"),h=a(f),p=(n("CIox"),n("f7Do")),m=a(p),v=n("uY+K"),y=a(v),E=n("mScD"),b=a(E),g=n("8f34"),k=a(g),w=n("YpvI"),O=a(w),_=n("opgY"),S=a(_),N=n("+S9/"),C=a(N),P=n("9jXU"),T=a(P),I=n("a0hn"),R=a(I),A=n("gK+r"),x=a(A),j=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={inited:!1,error:null,total:1,current:1,delModal:!1},n.fetchHitokotos=n.fetchHitokotos.bind(n),n.newHitokoto=n.newHitokoto.bind(n),n.updateHitokoto=n.updateHitokoto.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){this.fetchHitokotos()}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.needRefresh&&this.fetchHitokotos(this.state.current).then(function(){t.props.refreshCollectionHitokotoSuccess()})}},{key:"componentWillUnmount",value:function(){this.props.leaveCollection()}},{key:"getURL",value:function(){if(this.props.rinfo){var e=this.props.rinfo[1],t=this.props.user.nickname;return{username:t,url:k.default.patterManager.getUrlOfUserCol(t,e,!0),collection:e}}}},{key:"fetchHitokotos",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=(this.props.location.pathname,this.props.rinfo[1]),o=d.default.findDOMNode(this);if(o&&(o.scrollIntoView?o.firstElementChild&&o.firstElementChild.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}):o.scrollTop=0),a&&a.length)return y.default.API_viewCollection(a,t,n).then(function(t){var n=t.hitokotos.slice(0);if(e.props.fetchHitokotosSuccess(t.hitokotos),e.setState({inited:!0,error:null,total:t.totalPage,current:t.currentPage}),n.length){var a=n[0],o=a.creator_id,r=a.fid,l=k.default.patterManager.getUrlOfUserCol(o,r,!1);b.default.putHitokotoBulk(l,n)}}).catch(function(t){return(0,O.default)("获取用户hitokoto失败！","error"),e.setState({error:t.message||t,inited:!1}),Promise.reject(t)});this.props.history.push("/myspace/collections")}},{key:"preview",value:function(e){this.props.preview(e,"preview"),this.props.history.push(this.props.location.pathname+"/preview")}},{key:"updateHitokoto",value:function(e){this.props.preview(e,"within"),this.props.history.push(this.props.location.pathname+"/update")}},{key:"newHitokoto",value:function(){var e=this.props.location.pathname;/\/new$/.test(e)||(e+="/new"),this.props.preview(null,"within"),this.props.history.push(e)}},{key:"showDelModal",value:function(e){this.setState({delModal:e})}},{key:"hideDelModal",value:function(){this.setState({delModal:null})}},{key:"removeHitokoto",value:function(){var e=this,t=this.state.delModal,n=this.props.rinfo[1];return y.default.API_deleteHitokoto(n,{id:t._id}).then(function(n){return b.default.removeHitokoto(t._id),(0,O.default)(n.message,"success"),e.hideDelModal(),e.fetchHitokotos(e.state.current),n})}},{key:"render",value:function(){var e=this,t=this.props,n=t.hitokotos,a=(t.location.pathname,void 0);return n.length>0?a=n.map(function(t){return s.default.createElement(T.default,{key:t.id,data:t,viewonly:!0,showState:!0},s.default.createElement("button",{onClick:e.preview.bind(e,t)},"预览"),s.default.createElement("button",{onClick:function(){return e.updateHitokoto(t)}},"修改"),s.default.createElement("button",{onClick:function(){return e.showDelModal(t)},className:"color-red"},"删除"))}):!this.state.error&&this.state.inited&&(a=s.default.createElement("div",{key:"empty",className:"align-center"},s.default.createElement("h1",null,"哦豁..."),s.default.createElement("p",null,"当前句集没有任何东西，点击「新增」添加句子"))),s.default.createElement(x.default,{cardname:this.props.rinfo[1],actions:[s.default.createElement("a",{key:"newone-hito",href:"javascript:",title:"",onClick:this.newHitokoto,"data-text":"新增"},s.default.createElement("i",{className:"iconfont icon-add hide-pc"})),s.default.createElement("a",{key:"pub-api-hito",href:"javascript:",title:"","data-text":"公开API地址",onClick:function(){(0,O.default)("该句集的公开API地址为：\n"+e.getURL().url+"\n该地址支持跨域调用，仅可以获取所有「公开」的句子。","info",!0)}},s.default.createElement("i",{className:"iconfont icon-link"}))]},s.default.createElement(m.default,{ease:"easeOutQuart",animConfig:[{opacity:[1,0]},{left:"0",right:"0",position:"absolute",opacity:[1,0]}]},s.default.createElement("div",{key:"container"},a),this.state.inited?null:s.default.createElement(R.default,{error:this.state.error,retry:function(){return e.fetchHitokotos(e.state.current,10)},key:"loading-co"})),s.default.createElement(C.default,{current:this.state.current||1,total:this.state.total||1,limit:10,func:this.fetchHitokotos}),this.state.delModal?s.default.createElement(S.default,{exit:this.hideDelModal.bind(this)},s.default.createElement("h1",null,"你确定要删除该hitokoto?"),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{role:"exit"},"取消"),s.default.createElement("button",{onClick:this.removeHitokoto.bind(this)},"确定")))):null)}}]),t}(u.Component);j.propTypes={hitokotos:h.default.arrayOf(h.default.object).isRequired,leaveCollection:h.default.func.isRequired,user:h.default.object.isRequired,history:h.default.object.isRequired,rinfo:h.default.array.isRequired,preview:h.default.func.isRequired},t.default=j},"+S9/":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("KSGD"),d=a(c),f=n("X5W0"),h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(t<=n)return 1;var a=Math.floor(n/2),o=1&n,r=e-a,l=e+a+(o?0:-1);return r<1?1:l>t?t-n+1:r},p=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=e.current,l=e.total,i=e.limit;return n.state={rangeStart:h(a,l,i)},n.go=n.go.bind(n),n.toBegin=n.toBegin.bind(n),n.toEnd=n.toEnd.bind(n),n.lastOne=n.lastOne.bind(n),n.nextOne=n.nextOne.bind(n),n.lastRange=n.lastRange.bind(n),n.nextRange=n.nextRange.bind(n),n}return l(t,e),i(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.current,n=e.total,a=e.limit,o=h(t,n,a);this.state.rangeStart;o!=this.state.rangeStart&&this.setState({rangeStart:o})}},{key:"go",value:function(e){e.target.blur(),this.props.func(e.target.textContent,this.props.limit||20)}},{key:"toBegin",value:function(e){e.target.blur(),this.props.func(1,this.props.limit||20)}},{key:"toEnd",value:function(e){e.target.blur(),this.props.func(this.props.total,this.props.limit||20)}},{key:"lastOne",value:function(e){e.target.blur(),this.props.func(this.props.current-1,this.props.limit||20)}},{key:"nextOne",value:function(e){e.target.blur(),this.props.func(this.props.current+1,this.props.limit||20)}},{key:"lastRange",value:function(e){e.target.blur();var t=this.state.rangeStart,n=void 0,a=this.props;a.current,a.total;n=t-a.limit,n<1?this.setState({rangeStart:1}):this.setState({rangeStart:n})}},{key:"nextRange",value:function(e){e.target.blur();var t=this.state.rangeStart,n=void 0,a=void 0,o=this.props,r=(o.current,o.total),l=o.limit;n=t+l,a=r-l,n>a?this.setState({rangeStart:a}):this.setState({rangeStart:n})}},{key:"render",value:function(e){var t=this.props,n=t.current,a=t.total,o=(t.func,t.limit),r=void 0===o?10:o,l=this.state.rangeStart,i=[],u=a<r?a:r;if(1==a)return null;i.push(s.default.createElement("button",{key:"lastone",className:1==n?"disabled":"",onClick:this.lastOne},s.default.createElement("i",{className:"iconfont icon-last"}))),l>2&&(i.push(s.default.createElement("button",{onClick:this.toBegin,key:"tobegin"},"1")),i.push(s.default.createElement("button",{onClick:this.lastRange,key:"lastrange"},s.default.createElement("i",{className:"iconfont icon-more"}))));for(var c=0,d=0;d<u;d++)c=l+d,i.push(s.default.createElement("button",{key:c,onClick:this.go,className:c==n?"disabled":""},c));return l+u<a-2&&(i.push(s.default.createElement("button",{onClick:this.nextRange,key:"nextrange"},s.default.createElement("i",{className:"iconfont icon-more"}))),i.push(s.default.createElement("button",{onClick:this.toEnd,key:"toEnd"},a))),i.push(s.default.createElement("button",{key:"nextone",className:n==a?"disabled":"",onClick:this.nextOne},s.default.createElement("i",{className:"iconfont icon-next"}))),s.default.createElement("div",{className:f.wrapper},i)}}]),t}(u.Component);p.propTypes={func:d.default.func.isRequired,total:d.default.number.isRequired,current:d.default.number.isRequired},t.default=p},"0xOS":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return l.default.createElement(s.default,{cardname:"关于"},l.default.createElement("div",{className:c.article},l.default.createElement("section",null,l.default.createElement("blockquote",null,l.default.createElement("p",null,"简单来说，一言（ヒトコト）指的是就是一句话，可以是动漫中的台词，可以是小说中的语句，也可以是网络上的各种小段子。",l.default.createElement("br",null),"或是感动，或是开心，又或是单纯的回忆，来到这里，留下你所喜欢的那一句句话，与大家分享，这就是一言存在的目的。",l.default.createElement("br",null),"*:本段文本源自",l.default.createElement("a",{href:"http://hitokoto.us",target:"_blank",rel:"noopener"},"hitokoto.us."))),l.default.createElement("br",null),l.default.createElement("p",null,"总而言之，这个网站就是展示能够触动你内心的一句话的网站，你可以在此发布，收藏，分享你收集的句子。这些句子可以是动漫里的，可以是书上摘抄的句子，也可以是网上很有道理的话，或者是电影里的经典台词。")),l.default.createElement("section",null,l.default.createElement("h2",null,"我可以写什么东西？"),l.default.createElement("p",null,"所有你觉得很有意义的句子都可以写，无论是书摘还是对话，或者是网易云音乐里最打动你的评论。")),l.default.createElement("section",null,l.default.createElement("h2",null,"使用指南"),l.default.createElement("p",null,"首先要知道几个概念。来源指明了指从哪里获取句子，是从第三方网站还是本站某个句集中获取句子。模式是对来源的归纳，你可以将所有发布诗词的来源添加到自己创建的诗词模式中，或者将发布书摘的来源加入到自己创建的某个模式中。在模式中，你可以开启或者关闭某个来源。一个来源可以出现在多个模式中，在来源管理中删除来源不会影响到已经在模式中的来源。首页展示是依据模式来运行的，从模式中的来源获取句子，然后根据模式的规则运行（定时刷新、顺序循环）。"),l.default.createElement("ol",null,l.default.createElement("li",null,l.default.createElement("b",null,"特殊偏好"),l.default.createElement("p",null,"比如喜欢电影台词的，可以将所有发布电影台词的来源加入到自己创建的某个模式中，这样这个模式中获取到的就全部都是电影台词了。")),l.default.createElement("li",null,l.default.createElement("b",null,"离线使用"),l.default.createElement("p",null,"如果你希望所有的句子都从本地缓存中获取，不依赖于网络，那么可以在模式中关闭所有来源的「允许使用网络」 并 打开「允许使用本地缓存」。为了保证本地缓存中句子数量充足，可以在「离线缓存」页面中将来源中的所有句子全部同步到本地。")),l.default.createElement("li",null,l.default.createElement("b",null,"定时刷新"),l.default.createElement("p",null,"如果你觉得每次都要手动点击下一条很麻烦，可以在模式中设置定时刷新的秒数，设置为0表示不使用定时刷新。")),l.default.createElement("li",null,l.default.createElement("b",null,"顺序播放"),l.default.createElement("p",null,"如果你希望将某个模式下的句子按照顺序地播放，不随机，可以将模式中的「请求类型」更换为「全部循环」")))),l.default.createElement("section",null,l.default.createElement("h2",null,"本站公开API"),l.default.createElement("p",null,"跨域获取本站句集中公开句子的接口文档  ",l.default.createElement("b",null,l.default.createElement(i.Link,{to:"/doc"},"点此查看调用接口")))),l.default.createElement("section",{className:c.thanksList},l.default.createElement("h2",null,"第三方一言API致谢列表"),l.default.createElement("span",null,"公开的hitokoto来源网站:"),l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement("a",{href:"http://hitokoto.cn",target:"_blank",rel:"noopener"},"http://hitokoto.cn")),l.default.createElement("li",null,l.default.createElement("a",{href:"https://moa.moe/hitoapi",target:"_blank",rel:"noopener"},"https://moa.moe/hitoapi")),l.default.createElement("li",null,l.default.createElement("a",{href:"https://satori.moe/",target:"_blank",rel:"noopener"},"https://satori.moe")))),l.default.createElement("section",{className:c.debug},l.default.createElement("h2",null,"项目仓库"),l.default.createElement("p",null,l.default.createElement("a",{href:"https://github.com/vankai/hitokoto-pwa",target:"_self",rel:"noopener"},"https://github.com/vankai/hitokoto-pwa"))),l.default.createElement("section",{className:c.debug},l.default.createElement("h2",null,"开源协议"),l.default.createElement(i.Link,{to:"/license"},"查看")),l.default.createElement("section",{className:c.debug},l.default.createElement("h2",null,"开发者按钮"),l.default.createElement(i.Link,{to:"/tools"},"工具箱"))))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n("GiK3"),l=a(r),i=n("F8kA"),u=n("gK+r"),s=a(u),c=n("iiOv")},"16R6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={width:document.documentElement.offsetWidth,_list:[],subscriptb:function(e){return a._list.push(e)}};window.addEventListener("resize",function(){a.width=document.documentElement.offsetWidth;for(var e=0,t=a._list.length;e<t;e++)a._list[e]&&a._list[e]()}),t.default=a},"1MFs":function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){var e=localStorage.getItem(c);return e?JSON.parse(e):s}function r(e){localStorage.setItem(c,JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0});var l=n("vxS+"),i=function(e){return e&&e.__esModule?e:{default:e}}(l),u=n("EjY7"),s={font:"simsun",fontWeight:"600",layoutHorizon:!1,backgroundColor:"#ffffff",revert2white:!1,showCover:!1},c="instant_layout",d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),t=arguments[1];switch(t.type){case u.LAYOUT_CHANGE:var n=(0,i.default)(e,a({},t.prop,{$set:t.value}));return r(n),n;default:return e}};t.default=d},"2oh4":function(e,t,n){"use strict";function a(e){var t=o.exec(e);if(!t)throw new Error("函数格式错误！请不要使用ES6的箭头函数");o.exec(e);var n=t[1];if(!n)throw new Error("至少需要一个参数！");~n.search(",")?(console.warn("含有无效形参！"),n=n.split(",")):n=[n];var a=t[2];if(!a)throw new Error("函数体不存在！请检查括号是否配对！");if(!~a.search("return"))throw new Error("函数中无return 语句");return n.push(a),console.log("validate adapter success!"),n}Object.defineProperty(t,"__esModule",{value:!0}),t.AdapterValidate=a;var o=t.FUNC_REGEXP=/function\s*(?:\w*)(?:\s*)\(([^\)]*)\)(?:\s*)\{([\s\S]*)\}/im,r=t.ADAPTER_ORGIN=function(e){return e.source||(e.source=e.from),e},l=t.PERSE_ADAPTER_SAFE=function(e){if("string"!=typeof e)return r;if(0==e.trim().length)return r;try{var t=a(e);return t.err?(console.error(t.err),r):Function.apply(null,t)}catch(e){return console.error(e),r}},i=t.PERSE_ADAPTER=function(e){var t=a(e);return Function.apply(null,t)};t.default={FUNC_REGEXP:o,ADAPTER_ORGIN:r,PERSE_ADAPTER_SAFE:l,PERSE_ADAPTER:i,AdapterValidate:a}},"3CI+":function(e,t){e.exports={mb20:"_1H6OWQI8Rm7IUdYvTKNoXH"}},"3a1N":function(e,t){e.exports={item:"_1UDTamEi9VDuwp8jWkq0wR",timetag:"_3WhPTmqRocQ5YvgfNZ43Ze",userName:"_3Sf5q7a_0diRCd_vcknioB",userHitokotoFlex:"_34soc-PnSnYaOVG-4zRsqG",userHitokotoFlexChild:"_3Eiws_oyfnIigAoQboIAz_",userHitokoto:"_1658z5tm998PRqiAqtggia",userHitokotoSource:"_1xq7jVJqUZYykqiMuv6Y-r",actions:"XD8wSZ2nIHuzG6urgqK1"}},"4/At":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("f7Do"),d=(a(c),n("F8kA"),n("wNBo")),f=a(d),h=n("LhJ3"),p=a(h),m=n("YRpt"),v=a(m),y=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={horizon:!0},n.goBack=n.goBack.bind(n),n.switchLayout=n.switchLayout.bind(n),n}return l(t,e),i(t,[{key:"switchLayout",value:function(){this.setState(function(e){return e.horizon=!e.horizon,e})}},{key:"goBack",value:function(){this.props.history.goBack()}},{key:"render",value:function(){var e=this,t=this.props,n=t.layout,a=(t.path,t.history),o=t.preview,r=a.location.pathname;if(console.log(r,o,this.props),!o)return s.default.createElement(v.default,null,s.default.createElement("h1",null,s.default.createElement("i",{className:"iconfont icon-prompt_fill color-red"}),"hitokoto已被清空"),s.default.createElement("button",{onClick:function(){return e.props.history.goBack()}},"返回"),s.default.createElement("button",{onClick:function(){return e.props.history.push("/")}},"前往首页"));var l=o.id,i=[s.default.createElement("li",{key:l+"style"},s.default.createElement("a",{href:"javascript:",onClick:this.switchLayout},s.default.createElement("i",{className:"iconfont icon-settings"}))),s.default.createElement("li",{key:l+"return"},s.default.createElement("a",{href:"javascript:",onClick:this.goBack},s.default.createElement("i",{className:"iconfont icon-check"})))];return this.state.horizon?s.default.createElement(v.default,{style:{backgroundColor:n.backgroundColor}},s.default.createElement(f.default,{hitokoto:o,layout:n,actions:i})):s.default.createElement(v.default,{style:{backgroundColor:n.backgroundColor}},s.default.createElement(p.default,{hitokoto:o,layout:n,actions:i}))}}]),t}(u.Component);t.default=y},"6RZU":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("2KeS"),r=n("1MFs"),l=a(r),i=n("EamV"),u=a(i),s=n("BQv5"),c=a(s),d=n("RjvE"),f=a(d),h=n("yoG6"),p=a(h),m=n("hrmx"),v=a(m),y=(0,o.combineReducers)({panel:c.default,user:u.default,layout:l.default,collections:f.default,notify:p.default,sources:v.default});t.default=y},"84MT":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("gK+r"),d=a(c),f=n("YpvI"),h=a(f),p=n("8f34"),m=a(p),v=n("UluS"),y=function(e){(0,h.default)(e,"info",!0)},E=m.default.patterManager,b=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=n.props.rinfo,l=Number(a[1]),i=E.patterns.find(function(e){return e.id===l});i||(i={});var u={},s=[],c=JSON.parse(JSON.stringify(i.sources||[]));c.forEach(function(e){u[e.id]=!0}),E.sources.forEach(function(e){if(!u[e.id]){var t=JSON.parse(JSON.stringify(e));t.online=!1,t.local=!1,t.count=0,s.push(t)}});var d=c.concat(s);return n.state={sourcesCopy:d},n.increase=n.increase.bind(n),n.decrease=n.decrease.bind(n),n.goBack=n.goBack.bind(n),n}return l(t,e),i(t,[{key:"goBack",value:function(){this.props.history.goBack()}},{key:"increase",value:function(){var e=Number(this.refs.interval.value);e=e!==e?0:e<0?0:e+1,this.refs.interval.value=e}},{key:"decrease",value:function(){var e=Number(this.refs.interval.value);e=e!==e?0:e<1?0:e-1,this.refs.interval.value=e}},{key:"resetCount",value:function(e,t){this.refs["count"+e].value=0}},{key:"handleUpdate",value:function(){var e=this,t=this.props.rinfo,n=Number(t[1]),a=this.refs.name.value,o=this.refs.default.checked,r=this.refs.interval.value,l=this.refs.type.value;r=Number(r);var i=this.state.sourcesCopy.map(function(t,n){var a=Number(e.refs["count"+n].value);return a!==a&&(a=0),t.count=a,t}).reduce(function(e,t){return(t.local||t.online)&&e.push(t),e},[]),u=this.validatePattern(a,r,i);if(0!=u.length)(0,h.default)(u.join("\n"),"error");else{var s={id:n,name:a,default:o,interval:r,sources:i,type:l};m.default.updatePattern(s.id,s),(0,h.default)("修改模式成功！","success"),this.goBack()}}},{key:"handleNewPattern",value:function(){var e=this,t=this.refs.name.value,n=this.refs.default.checked,a=this.refs.interval.value,o=this.refs.type.value;a=Number(a);var r=this.state.sourcesCopy.map(function(t,n){var a=Number(e.refs["count"+n].value);return a!==a&&(a=0),t.count=a,t}).reduce(function(e,t){return(t.local||t.online)&&e.push(t),e},[]),l=this.validatePattern(t,a,r);if(0!=l.length)(0,h.default)(l.join("\n"),"error");else{var i={id:Date.now(),name:t,default:n,interval:a,sources:r,type:o};E.newPattern(i),(0,h.default)("添加模式成功！","success"),this.goBack()}}},{key:"validatePattern",value:function(e,t,n){var a=[];return 0==e.trim().length&&a.push("模式名字不能为空！"),t!=t&&a.push("请输入正确的刷新时间！"),t<0&&a.push("刷新时间不能小于0!"),t>0&&t<5&&a.push("刷新时间间隔太短!"),0==n.length&&a.push("来源至少有一个为允许状态！"),a}},{key:"sourceChange",value:function(e,t,n){var a=this.state.sourcesCopy;a[e][t]=n,this.setState({sourcesCopy:a})}},{key:"render",value:function(){var e=this,t=this.props.rinfo,n=t[1],a="new"===n,o=(E.sources,void 0);a||(n=Number(n),o=E.patterns.find(function(e){return e.id==n})),o=o||{};var r=this.state.sourcesCopy.map(function(t,n){return s.default.createElement("li",{key:t.id,className:t.local||t.online?"":"inactive"},s.default.createElement("h5",{className:"ellipsis"},t.name,"(",t.url,")"),s.default.createElement("div",{className:v.countBox},s.default.createElement("i",{className:"iconfont icon-refresh",title:"重置循环计数器为0",onClick:e.resetCount.bind(e,n)}),s.default.createElement("input",{type:"number",ref:"count"+n,title:"循环计数器",defaultValue:t.count})),s.default.createElement("div",null,s.default.createElement("input",{hidden:!0,type:"checkbox",id:t.id+"ol",defaultChecked:t.online,onChange:function(t){e.sourceChange(n,"online",t.target.checked)}}),s.default.createElement("label",{htmlFor:t.id+"ol"}),"允许使用网络",s.default.createElement("br",null),s.default.createElement("input",{hidden:!0,type:"checkbox",id:t.id+"local",defaultChecked:t.local,onChange:function(t){e.sourceChange(n,"local",t.target.checked)}}),s.default.createElement("label",{htmlFor:t.id+"local"}),"允许使用本地缓存"))});return s.default.createElement(d.default,{cardname:a?"新增模式":"修改模式"},s.default.createElement("div",{className:"form"},s.default.createElement("div",{className:"text-filed blocked"},s.default.createElement("input",{type:"text",ref:"name",required:!0,defaultValue:o.name}),s.default.createElement("label",{"data-content":"模式名称（取一个好名字吧）"},"模式名称")),s.default.createElement("br",null),s.default.createElement("label",{htmlFor:""},"默认模式："),s.default.createElement("input",{type:"checkbox",id:o.id+"default",defaultChecked:o.default,ref:"default",hidden:!0}),s.default.createElement("label",{htmlFor:o.id+"default"}),s.default.createElement("button",{onClick:function(){return y("默认模式将在应用重新载入时被使用，不是修改后立即使用（在显示设置里修改模式将会立即启用）。")}},s.default.createElement("i",{className:"iconfont icon-question"})),s.default.createElement("br",null),s.default.createElement("div",{className:v.timerbox},s.default.createElement("label",{htmlFor:""},"定时刷新："),s.default.createElement("i",{className:"iconfont icon-jian",onClick:this.decrease})," ",s.default.createElement("input",{type:"number",ref:"interval",defaultValue:o.interval?o.interval:0,placeholder:"秒数"})," ",s.default.createElement("i",{className:"iconfont icon-jia",onClick:this.increase})," ",s.default.createElement("button",{onClick:function(){return y("每隔指定秒数后自动刷新hitokoto。设置为0表示不使用定时刷新。秒数必须大于等于5秒。")}},s.default.createElement("i",{className:"iconfont icon-question"}))),s.default.createElement("br",null),s.default.createElement("label",{htmlFor:""},"请求类型:"),s.default.createElement("select",{ref:"type",defaultValue:o.type||"random"},s.default.createElement("option",{value:"random"},"随机"),s.default.createElement("option",{value:"next"},"全部循环")),s.default.createElement("button",{onClick:function(){return y("全部循环时会发送对应来源的循环计数器的数字，每一次成功获取就加1（后台自动取模运算，用循环计数器和句集长度做模运算）。第三方网站不支持循环计数器时，全部循环将不起作用。")}},s.default.createElement("i",{className:"iconfont icon-question"})),s.default.createElement("br",null),s.default.createElement("label",{htmlFor:""},"来源"),s.default.createElement("button",{onClick:function(){return y("允许使用网络：每个来源的hitokoto都会通过HTTP请求获取，并备份一份到本地缓存中。\n允许使用本地缓存：将会在「离线」时或者「从网络获取失败」时，从本地缓存中获取缓存的hitokoto。\n\n如果只允许使用网络，那么每次获取都必须通过网络请求来获取，并且离线后将不能使用缓存的数据；如果只允许使用本地缓存，那么不会消耗任何流量，将直接从本地缓存中获取（前提是本地缓存中有数据）；如果两个都开启，将会在「从网络中获取失败」或「请求超时」时使用本地缓存。")}},s.default.createElement("i",{className:"iconfont icon-question"})),s.default.createElement("br",null),s.default.createElement("ul",null,r)),s.default.createElement("div",null,a?s.default.createElement("button",{onClick:this.handleNewPattern.bind(this)},"确认新增"):s.default.createElement("button",{onClick:this.handleUpdate.bind(this)},"确认修改"),s.default.createElement("button",{onClick:this.goBack,className:"color-basic"},"取消")))}}]),t}(u.Component);t.default=b},"8Hyw":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("EjY7"),i=n("TamS"),u=a(i),s=function(e){return{layout:e.layout,panel:e.panel}},c=function(e){return{changeLayout:function(t,n){return e((0,l.changeLayout)(t,n))},hide:function(){return e((0,l.hidePanel)("layoutSetting"))}}};t.default=(0,r.connect)(s,c)(u.default)},"8d1s":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("O27J"),d=a(c),f=n("f7Do"),h=a(f),p=n("uY+K"),m=a(p),v=n("8f34"),y=(a(v),n("mScD")),E=(a(y),n("YpvI")),b=a(E),g=n("9jXU"),k=a(g),w=n("gK+r"),O=a(w),_=n("+S9/"),S=a(_),N=n("a0hn"),C=a(N),P=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hitokotos:[],passed:[],inited:!1,error:null,total:1,current:1},n.getNeedReviewHitokotos=n.getNeedReviewHitokotos.bind(n),n.allow=n.allow.bind(n),n.regret=n.regret.bind(n),n.reject=n.reject.bind(n),n.detail=n.detail.bind(n),n.refresh=n.refresh.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){this.getNeedReviewHitokotos(1)}},{key:"refresh",value:function(){this.getNeedReviewHitokotos(this.state.current,this.state.total)}},{key:"getNeedReviewHitokotos",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=d.default.findDOMNode(this);a&&(a.scrollIntoView?a.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}):a.scrollTop=0),this.setState({inited:!1}),m.default.API_Admin_getNeedReviewHitokotos(e,n).then(function(e){t.setState({inited:!0,error:null,hitokotos:e.hitokotos,passed:new Array(e.hitokotos.length).fill(null),current:e.currentPage,total:e.totalPage})}).catch(function(e){(0,b.default)("获取失败！"+e.message||e,"error"),t.setState({error:e.message||e||"获取句集内容失败！",inited:!1})})}},{key:"allow",value:function(e){var t=this,n=e.target.getAttribute("data-index"),a=this.state.hitokotos[n];m.default.API_Admin_changeHitokotoState(a._id,"public").then(function(e){t.setState(function(e){return e.passed[n]=!0,e})})}},{key:"regret",value:function(e){var t=this,n=e.target.getAttribute("data-index"),a=this.state.hitokotos[n];m.default.API_Admin_changeHitokotoState(a._id,"reviewing").then(function(e){t.setState(function(e){return e.passed[n]=null,e})})}},{key:"reject",value:function(e){var t=this,n=e.target.getAttribute("data-index"),a=this.state.hitokotos[n];m.default.API_Admin_changeHitokotoState(a._id,"rejected").then(function(e){t.setState(function(e){return e.passed[n]=!1,e})})}},{key:"detail",value:function(e){var t=e.target.getAttribute("data-index"),n=this.state.hitokotos[t];(0,b.default)(JSON.stringify(n,null,2),"info",!0)}},{key:"userNameClickProxy",value:function(e){var t=this.state.hitokotos[e];t.creator_id&&t.creator?(window.trickyUid=t.creator_id,this.props.history.push("/explore/"+t.creator)):(0,b.default)("无法跳转到用户详情，可能句子不是本网站的。")}},{key:"collectionClickProxy",value:function(e){var t=this.state.hitokotos[e];t.creator_id&&t.creator&&t.collection?(window.trickyUid=t.creator_id,this.props.history.push("/explore/"+t.creator+"/"+t.collection)):(0,b.default)("无法跳转到句集详情，可能句子不是本网站的。")}},{key:"render",value:function(){var e=this,t=this.state.hitokotos,n=null;if(this.state.inited)if(0==t.length)n=s.default.createElement("div",{key:"empty",className:"align-center"},s.default.createElement("h1",{className:"color-red"},"没有待审核的句子！"),s.default.createElement("p",null,"这里什么都没有"));else{var a=this.state.passed;n=t.map(function(t,n){return s.default.createElement(k.default,{key:t._id,data:t,usernameProxy:function(){return e.userNameClickProxy(n)},collectionProxy:function(){return e.collectionClickProxy(n)}},s.default.createElement("button",{"data-index":n,onClick:e.detail},"详细信息"),null===a[n]?[s.default.createElement("button",{key:n+"pass","data-index":n,onClick:e.allow},"通过"),s.default.createElement("button",{key:n+"block","data-index":n,className:"color-red",onClick:e.reject},"驳回")]:s.default.createElement("button",{"data-index":n,onClick:e.regret},"需要再考虑一次"))})}return s.default.createElement(O.default,{cardname:"审核"},s.default.createElement(h.default,{ease:"easeOutQuart",animConfig:[{opacity:[1,0]},{left:"0",right:"0",position:"absolute",opacity:[1,0]}]},this.state.inited?null:s.default.createElement(C.default,{error:this.state.error,retry:function(){e.getNeedReviewHitokotos(e.state.current)},key:"loading"}),s.default.createElement("div",{className:"view"},n)),s.default.createElement("div",{className:"align-center"},s.default.createElement("button",{onClick:this.refresh},"刷新本页")),s.default.createElement(S.default,{current:this.state.current||1,total:this.state.total||1,limit:10,func:this.getNeedReviewHitokotos}))}}]),t}(u.Component);t.default=P},"8f34":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n("rplX");var l=n("j1Hv"),i=a(l),u=n("uY+K"),s=a(u),c=n("YpvI"),d=a(c),f=n("2oh4"),h=n("mtXx"),p=a(h),m=n("mScD"),v=a(m),y=["id","hitokoto","creator","type","source","created_at"],E=[],b=[],g=function(){function e(){var t=this;o(this,e),console.debug("driver initiating"),this.patterManager=new i.default,this.httpManager=s.default,this.state={},this.adaptersMap=null,this.pattern=null,this.sources=null,this.nextHitokotoHandler=Function.prototype,this.lastHitokotoHandler=Function.prototype,this.UIResolver=Function.prototype,this.lastTime=null,this.patternValid=!1,this.processing=!1,this.timerDisabled=!0,this.signal=[],this.errSignal=0,this.drive(this.patterManager.getDefaultPattern()),this.hertbeat=this.reborn(),console.log("hitokoto inited"),this.windowBlur=!1,window.addEventListener("blur",function(){t.stop().windowBlur=!0}),window.addEventListener("focus",function(){t.windowBlur&&(t.start().windowBlur=!1)})}return r(e,[{key:"drive",value:function(e){return e?(this.pattern=e,this.sources=e.sources,this.registAdapter(this.sources),this.patternValid=this.sources.some(function(e){return e.online||e.local})):this.patternValid=!1,this.timmerDisabled=!0,E.length=0,this.lastTime=Date.now(),this.updateProcessing(!1),this.signal.length=0,this}},{key:"start",value:function(){return console.debug("driver start"),this.patternValid=this.sources.some(function(e){return e.online||e.local}),this.patternValid&&this.nextHitokotoHandler!==Function.prototype&&(this.timerDisabled=!1),this.lastTime=Date.now(),this}},{key:"stop",value:function(){return console.debug("driver stop"),this.timerDisabled=!0,this}},{key:"getRandomSource",value:function(){return this.sources[Math.floor(Math.random()*this.sources.length)]}},{key:"reborn",value:function(){return this.rebornDetail(),setInterval(this.rebornDetail.bind(this),1e3)}},{key:"rebornDetail",value:function(){var e=this;if(!this.timerDisabled){if(E.length<5&&0==this.signal.length){var t=this.sources.filter(function(e){return e.online});if(p.default.online&&0!==t.length){var n=this.pattern,a=n.type,o=n.id;t.forEach(function(t,n){var r=""+Date.now()+n;e.signal.push(r),e.getHitokotoFromWEB(t.url,{type:a,source:t}).then(function(n){"next"==a&&e.increaseSourceCount(o,t.id),n.url||(n.url=t.url);var l=e.signal.findIndex(function(e){return e===r});~l&&(e.signal.splice(l,1),E.push(n),e.processing&&(e.updateProcessing(!1),e.next()))}).catch(function(n){var o=e.signal.findIndex(function(e){return e===r});return~o&&e.signal.splice(o,1),e.processing?(e.errSignal+=1,e.errSignal>10&&(e.updateProcessing(!1),e.timerDisabled=!0,(0,d.default)("从网络获取hitokoto出错次数已经超过10次！已暂停播放器!","error",!0))):e.errSignal>0&&(e.errSignal-=1),e.getHitokotoFromIDB(t.url,{type:a,source:t})})})}else{t=this.sources.filter(function(e){return e.local});var r=this.pattern,l=r.type,i=r.id;t.forEach(function(t,n){var a=""+Date.now()+n;e.signal.push(a),e.getHitokotoFromIDB(t.url,{type:l,source:t}).then(function(n){"next"==l&&e.increaseSourceCount(i,t.id),n.url||(n.url=t.url);var o=e.signal.findIndex(function(e){return e===a});~o&&(e.signal.splice(o,1),E.push(n),e.processing&&(e.updateProcessing(!1),e.next()))}).catch(function(t){var n=e.signal.findIndex(function(e){return e===a});~n&&e.signal.splice(n,1),console.log(t)})})}}var u=void 0,s=Date.now();0!==(u=this.pattern.interval)&&s-this.lastTime>1e3*u&&this.next(),b.length>5&&(b.length=5)}}},{key:"next",value:function(){0==E.length?this.updateProcessing(!0):(b.unshift(E.shift()),this.nextHitokotoHandler(b.slice(0,1)[0],this.getCount())),this.errSignal>20&&this.timerDisabled&&(this.timerDisabled=!1,this.errSignal=0),this.lastTime=Date.now()}},{key:"last",value:function(){b.length>1&&E.unshift(b.shift()),this.lastHitokotoHandler(b.slice(0,1)[0],this.getCount()),this.updateProcessing(!1),this.lastTime=Date.now()}},{key:"initRollback",value:function(e){return b.unshift(e),this}},{key:"getCount",value:function(){return{lastCount:b.length,nextCount:E.length}}},{key:"registAdapter",value:function(e){var t=this;return this.adaptersMap={},e.forEach(function(e){t.adaptersMap[e.url]=(0,f.PERSE_ADAPTER_SAFE)(e.adapter)}),this}},{key:"registUIProcessingHandler",value:function(e){return this.UIResolver=e,this}},{key:"registNextHitokotoHandler",value:function(e){return this.nextHitokotoHandler=e,this}},{key:"registLastHitokotoHandler",value:function(e){return this.lastHitokotoHandler=e,this}},{key:"updateProcessing",value:function(e){this.processing=e,this.UIResolver(this.processing)}},{key:"getAdapter",value:function(e){return this.adaptersMap[e]||f.ADAPTER_ORGIN}},{key:"testSourceAdapter",value:function(e,t){var n=void 0;try{n=(0,f.PERSE_ADAPTER)(t)}catch(e){return Promise.reject(e)}return this.httpManager.getHitokoto(e).then(n).then(function(e){if(console.debug("[test.adapter.result]",e),e){var t=[];return y.forEach(function(n){e[n]||t.push(n)}),t.length>0?Promise.reject("返回的对象中缺少成员："+JSON.stringify(t)):Promise.resolve(e)}return Promise.reject(e)})}},{key:"getHitokotoFromIDB",value:function(e,t){return v.default.getHitokoto(e,t).catch(function(e){return Promise.reject(e)})}},{key:"getHitokotoFromWEB",value:function(e,t){var n=t.type,a=t.source,o=this.httpManager.getHitokoto(e,n,a).then(this.getAdapter(e));return o.then(function(t){try{v.default.putHitokoto(e,t)}catch(e){}return t}).catch(function(e){return Promise.reject(e)}),o}},{key:"updateSource",value:function(e,t){this.patterManager.updateSource(e,t),this.pattern.sources.forEach(function(n){n.id==e&&l.SOURCE_UPDATE_KEYS.forEach(function(e){n[e]=t[e]})}),this.drive(this.pattern).start()}},{key:"increaseSourceCount",value:function(e,t){this.patterManager.increaseSourceCount(e,t)}},{key:"updatePattern",value:function(e,t){if(this.patterManager.updatePattern(e,t),this.pattern.id==e){var n=this.patterManager.getPatternById(e);this.drive(n).start()}}},{key:"restorePatterns",value:function(e){e&&e.length&&e.length>0&&(this.patterManager.restorePatterns(e),this.drive(this.patterManager.getDefaultPattern()))}}]),e}();t.default=new g},"9/+i":function(e,t){e.exports={navWrapper:"jhvosvFhgrWUzqVSmDTVj",hamburger:"_3b4rgZr00W_n23Ija7Ftv_",nav:"g9BORknOHuO7JkiEqBNTI",showCover:"_2g5ceMKVHkqCbSyBvAYSfp",navCover:"_2tDt4EC0iVSMsvnqdQSw5l",navPhone:"_31ADfNdcG8bnupjQ729DrY",navPhoneDimmer:"_26Vd7ltcuO9iV68juecPhA"}},"9jXU":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.data,n=t.hitokoto,a=t.source,o=t.author,r=t.creator,i=(t.creator_id,t.category,t.created_at),u=t.collection,c=t.state,d=e.viewonly,m=e.showState,v=e.usernameProxy,y=e.collectionProxy,E=(0,f.default)(i);return l.default.createElement("div",{className:h.item},l.default.createElement("div",{className:"clearfix"},d?null:[v?l.default.createElement("a",{href:"javascript:",key:"user",onClick:v,className:h.userName},l.default.createElement("span",null,r)):l.default.createElement(s.Link,{key:"user",to:"/explore/"+r,className:h.userName},l.default.createElement("span",null,r)),y?l.default.createElement("a",{href:"javascript:",key:"collection",className:"color-basic",onClick:y},u):l.default.createElement(s.Link,{key:"collection",className:"color-basic",to:"/explore/"+r+"/"+u},u),l.default.createElement("br",{key:"br"})],l.default.createElement("span",{className:h.timetag},m?p[c]+" - ":null,E)),l.default.createElement("div",{className:h.userHitokotoFlex},l.default.createElement("div",{className:h.userHitokotoFlexChild+" clearfix"},l.default.createElement("span",{className:h.userHitokoto},n),l.default.createElement("br",null),l.default.createElement("span",{className:h.userHitokotoSource},"—— ",o?o+" ":"",a))),l.default.createElement("div",{className:"clearfix"},l.default.createElement("div",{className:"pull-right "+h.actions},e.children)))}Object.defineProperty(t,"__esModule",{value:!0});var r=n("GiK3"),l=a(r),i=n("KSGD"),u=(a(i),n("f7Do")),s=(a(u),n("F8kA")),c=n("8f34"),d=(a(c),n("HvcI")),f=a(d),h=n("3a1N"),p={public:"公开",private:"私密",reviewing:"审核中",rejected:"驳回(私密)"};o.propTypes={},t.default=(0,s.withRouter)(o)},BQv5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("EjY7"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];switch(t.type){case a.PANEL_OPEN:return a.PANEL_OPEN+t.value;case a.PANEL_HIDE:return a.PANEL_HIDE+t.value;default:return e}};t.default=o},Bn1k:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("f7Do"),d=(a(c),n("8f34")),f=a(d),h=n("gK+r"),p=a(h),m=n("opgY"),v=a(m),y=(n("z55N"),f.default.patterManager),E=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={patterns:y.patterns,update:void 0,newPattern:void 0,deletePaternModal:null},n.showUpdate=n.showUpdate.bind(n),n.handleUpdate=n.handleUpdate.bind(n),n.hideUpdate=n.hideUpdate.bind(n),n.showDeleteModal=n.showDeleteModal.bind(n),n.hideDeleteModal=n.hideDeleteModal.bind(n),n.handleDelete=n.handleDelete.bind(n),n.showNewPattern=n.showNewPattern.bind(n),n.hideNewPattern=n.hideNewPattern.bind(n),n.handleNewPattern=n.handleNewPattern.bind(n),n}return l(t,e),i(t,[{key:"showUpdate",value:function(e){}},{key:"handleUpdate",value:function(e,t){this.hideUpdate(),this.setState({pattern:this.state.patterns})}},{key:"hideUpdate",value:function(){this.setState({update:void 0})}},{key:"showDeleteModal",value:function(e){this.setState({deletePaternModal:e})}},{key:"hideDeleteModal",value:function(){this.setState({deletePaternModal:null})}},{key:"handleDelete",value:function(){var e=this.state.deletePaternModal;f.default.patterManager.deletePattern(e),this.hideUpdate(),this.hideDeleteModal(),this.forceUpdate()}},{key:"showNewPattern",value:function(){}},{key:"hideNewPattern",value:function(){}},{key:"handleNewPattern",value:function(e){f.default.patterManager.newPattern(e),this.hideNewPattern(),this.setState({patterns:JSON.parse(JSON.stringify(f.default.patterManager.patterns))})}},{key:"render",value:function(){var e=this,t=this.props,n=t.history,a=t.location,o=y.patterns.map(function(t){return s.default.createElement("li",{key:t.id},s.default.createElement("div",null,s.default.createElement("h3",{className:"ellipsis"},t.name),s.default.createElement("p",{className:"txt-sm"},t.sources.length,"个来源",t.default?"-默认模式":null," ",f.default.pattern.id==t.id?"-使用中":null),s.default.createElement("p",{className:"acts"},f.default.pattern.id==t.id?null:s.default.createElement("button",{onClick:function(){f.default.drive(t),e.forceUpdate()}},"立即使用"),s.default.createElement("button",{onClick:function(){return n.push(a.pathname+"/"+t.id+"/update")}},"修改"),s.default.createElement("button",{className:"color-red",onClick:function(){return e.showDeleteModal(t.id)}},"删除")," ",s.default.createElement("br",null))))});return s.default.createElement(p.default,{cardname:"模式管理"},s.default.createElement("ul",{className:"lum-list"},o,s.default.createElement("li",{key:"new"},s.default.createElement("div",{className:"pointer",onClick:function(){return n.push(a.pathname+"/new")}},s.default.createElement("h3",null,s.default.createElement("i",{className:"iconfont icon-add"}),"新增")))),this.state.deletePaternModal?s.default.createElement(v.default,{exit:this.hideDeleteModal},s.default.createElement("h1",null,"你确定要删除该模式?"),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{role:"exit"},"取消"),s.default.createElement("button",{onClick:this.handleDelete},"确定")))):null)}}]),t}(u.Component);t.default=E},C0xF:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("EjY7"),i=n("Dwxe"),u=a(i),s=function(e){return{layout:e.layout,panel:e.panel,user:e.user}},c=function(e){return{showRegist:function(){return e((0,l.showPanel)("regist"))},hideLogin:function(){return e((0,l.hidePanel)("login"))},loginDone:function(t){return e((0,l.userLogin)(t))}}};t.default=(0,r.connect)(s,c)(u.default)},C42Q:function(e,t){},D7zQ:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("KSGD"),d=a(c),f=(n("CIox"),n("f7Do")),h=(a(f),n("Vgyu")),p=a(h),m=n("gK+r"),v=a(m),y=n("EWX9"),E=n("mScD"),b=a(E),g=n("YpvI"),k=a(g),w=n("uY+K"),O=a(w),_=n("GoiC"),S=a(_),N=S.default.hitokotoTextarea,C=S.default.hitokotoSouceInput,P=S.default.hitokotoSouceTypeBlock,T=S.default.operations,I=S.default.suggeBox,R=S.default.inputSuggestion,A=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hitokoto:{category:"其他",authorChoices:[],sourceChoices:[]}},n.goBack=n.goBack.bind(n),n.handlePreviewClick=n.handlePreviewClick.bind(n),n.publish=n.publish.bind(n),n.update=n.update.bind(n),n.authorSuggestion=n.getSuggestion.bind(n,"author"),n.clickAuthorSugg=n.clickSuggestion.bind(n,"author"),n.authorBlur=n.blurSuggestion.bind(n,"author"),n.sourceSuggestion=n.getSuggestion.bind(n,"source"),n.clickSourceSugg=n.clickSuggestion.bind(n,"source"),n.sourceBlur=n.blurSuggestion.bind(n,"source"),n}return l(t,e),i(t,[{key:"goBack",value:function(){this.props.history.goBack()}},{key:"getSuggestion",value:function(e,t){var n=this,a=t.target.value;a&&a.trim()&&(0,w.timeoutPromise)(300,b.default.getHitokotoSuggestion(e,a)).then(function(t){n.setState(function(n){return n[e+"Choices"]=t.slice(0,5),n})})}},{key:"clickSuggestion",value:function(e,t){var n=t.target.textContent;this.refs[e].value=n}},{key:"blurSuggestion",value:function(e){var t=this;setTimeout(function(){t.setState(function(t){return t[e+"Choices"]=[],t})},200)}},{key:"handlePreviewClick",value:function(){var e=this.getHitokoto();e&&(this.props.handlePreview(e,"preview"),this.props.history.push(this.props.location.pathname+"/preview"))}},{key:"getHitokoto",value:function(){var e=this.refs,t=e.source.value,n=e.type.value,a=e.author.value,o=e.state.checked,r=this.textarea.value;return 0==r.length?void(0,k.default)("hitokoto内容不能为空！","error"):0==t.length?void(0,k.default)("hitokoto来源不能为空！","error"):{hitokoto:r,author:a,source:t,category:n,state:o}}},{key:"publish",value:function(){var e=this,t=this.getHitokoto();if(t){var n=this.props.rinfo[1];return O.default.API_newHitokoto(n,t).then(function(t){var n=t.hitokoto;return b.default.putHitokoto((0,y.getURL)(n.creator_id,n.fid,!1),n),(0,k.default)(t.message,"success"),e.props.history.goBack(),e.props.refreshHitokotoList(),t})}}},{key:"update",value:function(){var e=this,t=this.getHitokoto();if(t){var n=this.props.rinfo[1];return t._id=this.props.within._id,O.default.API_updateHitokoto(n,t).then(function(t){return(0,k.default)(t.message,"success"),e.props.history.goBack(),e.props.refreshHitokotoList(),t})}}},{key:"render",value:function(){var e=this,t=this.props,n=(t.location.pathname,t.rinfo),a="new"==n[2],o=this.props.within;if(a)o=this.props.preview?this.props.preview:{category:"其他",state:"public"};else if(!a&&!o)return s.default.createElement(v.default,{style:{backgroundColor:"#fff"},cardname:"未知错误"},s.default.createElement("h1",null,"数据已被清空"),s.default.createElement("p",null,"请不要在编辑的时候刷新页面",s.default.createElement("button",{onClick:function(){return e.props.history.push("/")}},"返回首页")));var r=this.state,l=r.authorChoices,i=r.sourceChoices;return s.default.createElement(v.default,{style:{backgroundColor:"#fff"},cardname:a?"新增Hitokoto":"修改hitokoto"},s.default.createElement("div",null,s.default.createElement(p.default,{minRows:3,inputRef:function(t){return e.textarea=t},className:N,placeholder:"请在此输入hitokoto",defaultValue:o.hitokoto})),s.default.createElement("div",{className:I},l&&l.length?s.default.createElement("div",{className:R},l.map(function(t){return s.default.createElement("span",{key:t,onClick:e.clickAuthorSugg},t)})):null,s.default.createElement("input",{type:"text",ref:"author",placeholder:"...在这里写原作者(可选)",onChange:this.authorSuggestion,onFocus:this.authorSuggestion,onBlur:this.authorBlur,className:C,defaultValue:o.author})),s.default.createElement("div",{className:I},i&&i.length?s.default.createElement("div",{className:R},i.map(function(t){return s.default.createElement("span",{key:t,onClick:e.clickSourceSugg},t)})):null,s.default.createElement("input",{type:"text",ref:"source",placeholder:"...在这里写来源出处(必填)",onChange:this.sourceSuggestion,onFocus:this.sourceSuggestion,onBlur:this.sourceBlur,className:C,defaultValue:o.source})),s.default.createElement("div",{className:P},s.default.createElement("p",null,"类别：",s.default.createElement("select",{defaultValue:o.category,ref:"type"},s.default.createElement("option",{value:"动漫"},"动漫"),s.default.createElement("option",{value:"小说"},"小说"),s.default.createElement("option",{value:"散文随笔"},"散文随笔"),s.default.createElement("option",{value:"书摘"},"书摘"),s.default.createElement("option",{value:"诗词"},"诗词"),s.default.createElement("option",{value:"漫画"},"漫画"),s.default.createElement("option",{value:"游戏"},"游戏"),s.default.createElement("option",{value:"电影"},"电影"),s.default.createElement("option",{value:"歌词"},"歌词"),s.default.createElement("option",{value:"电视剧"},"电视剧"),s.default.createElement("option",{value:"来自网络"},"来自网络"),s.default.createElement("option",{value:"原创"},"原创"),s.default.createElement("option",{value:"其他"},"其他"))),s.default.createElement("hr",null),s.default.createElement("p",null,s.default.createElement("span",{className:"form"},"私密",s.default.createElement("a",{href:"javascript:",title:"点击查看提示",onClick:function(){return(0,k.default)("公开的句子将会出现在「探索」中，私密的句子只有自己可以看到，审核中的句子只有审核通过后才会在「探索中」。如果修改已经公开了的句子，那么这个句子将会再次被审核。\n审核机制是为了防止恶意内容，不防君子防小人。","info",!0)}},s.default.createElement("i",{className:"iconfont icon-question"})),"：",s.default.createElement("input",{type:"checkbox",ref:"state",hidden:!0,id:"id-public",defaultChecked:"private"==o.state||"rejected"==o.state}),s.default.createElement("label",{htmlFor:"id-public"}),"(公开的句子将会被审核，审核通过后才会出现在「探索」中。)"),"reviewing"==o.state?s.default.createElement("span",{className:"color-red"},"正在审核中"):null,"rejected"==o.state?s.default.createElement("span",{className:"color-red"},"已驳回，建议修改。"):null)),s.default.createElement("div",{className:T},s.default.createElement("button",{onClick:this.handlePreviewClick},"预览"),a?s.default.createElement("button",{onClick:this.publish},"确认新增"):s.default.createElement("button",{onClick:this.update},"确认修改"),s.default.createElement("button",{onClick:this.goBack},"取消")))}}]),t}(u.Component);A.propTypes={rinfo:d.default.array.isRequired,handlePreview:d.default.func.isRequired,refreshHitokotoList:d.default.func.isRequired},t.default=A},D9xO:function(e,t){e.exports={"mu-category":"_2-N4IxHQex_SKnK6oQg_oT",song:"bGkJgK6xjc4ySd6iC8ijV",layout_horizon:"_2F2H39RoN8uPYsuz38JfRS",Header:"_3ID6dnaBVsEaaFvrKWH8wz",Content:"_jBYuHaFY583gIycQF7ea",overLoadHitokoto:"AJkV3B_CrBS7repkWPzoz",actions:"_1O0C8sVNSAR0nwKTUg-Mhf",layout_vertical:"lNHJSpUF4m0y72ymcyf_e",oprations:"kNmG9V5TyeVGF2DzMxpDX",verticalAnimate:"_3R4whQniZBJm_HCLJewX7S"}},Dwxe:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("KSGD"),d=a(c),f=n("f7Do"),h=a(f),p=(n("F8kA"),n("dtTU")),m=a(p),v=n("8f34"),y=a(v),E=n("uY+K"),b=a(E),g=n("YpvI"),k=a(g),w=n("YRpt"),O=a(w),_=n("EjY7"),S=n("z55N"),N=n("oHpa"),C=a(N),P={display:"inline-block",margin:"5px",padding:"14px 15px",backgroundColor:" #ffd9ea",border:"solid 1px pink",borderRadius:"4px",width:"200px",whiteSpace:"pre-line"},T=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={username:void 0,password:void 0,errinfo:void 0},n.handleKeyPress=n.handleKeyPress.bind(n),n.handlePasswordChange=n.handlePasswordChange.bind(n),n.handleSigninClick=n.handleSigninClick.bind(n),n.handleUsernameChange=n.handleUsernameChange.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){y.default.stop()}},{key:"componentWillUnmount",value:function(){y.default.start()}},{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleKeyPress",value:function(e){"enter"==e.key.toLowerCase()&&this.handleSigninClick()}},{key:"handleSigninClick",value:function(e){var t=this,n=this.state,a=n.username,o=n.password;if(void 0===a)return void this.setState({errinfo:"用户名不能为空！"});if(0==a.trim().length)return void this.setState({errinfo:"用户名不能为空！"});if(void 0===o)return void this.setState({errinfo:"密码不能为空"});if(0==o.trim().length)return void this.setState({errinfo:"密码不能为空"});this.setState({errinfo:""});var r=(0,m.default)(a),l=(0,m.default)(o);b.default.API_login({username:r,password:l}).then(function(e){(0,k.default)(e.message,"success"),t.props.loginDone(e),t.props.hideLogin()}).catch(function(e){t.setState({errinfo:e.message||e||"未知错误"})})}},{key:"render",value:function(){var e=this.props,t=e.hideLogin,n=e.showRegist,a=e.panel,o=void 0;return o=a===_.PANEL_OPEN+"login"?s.default.createElement(O.default,{key:"login0panel",style:{backgroundColor:"transparent"},onClick:t},s.default.createElement("div",{className:C.default["login-box"],onClick:function(e){return e.stopPropagation(),!1}},s.default.createElement("h1",null,"登录"),s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"text",onChange:this.handleUsernameChange,required:!0}),s.default.createElement("label",{"data-content":"账号"},"账号")),s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"password",onChange:this.handlePasswordChange,required:!0,onKeyPress:this.handleKeyPress}),s.default.createElement("label",{"data-content":"密码"},"密码")),this.state.errinfo?s.default.createElement("p",null,s.default.createElement("span",{style:P},this.state.errinfo)):null,s.default.createElement("br",null),s.default.createElement("p",null,s.default.createElement("button",{onClick:this.handleSigninClick},"立即登录"),s.default.createElement("button",{onClick:n},"前往注册")),s.default.createElement("p",null,s.default.createElement("br",null),s.default.createElement("button",{onClick:t},"关闭")))):s.default.createElement("div",null),s.default.createElement(h.default,{type:S.GLOBAL_ANIMATE_TYPE,ease:["easeOutQuart","easeInOutQuart"]},o)}}]),t}(u.Component);T.propTypes={hideLogin:d.default.func.isRequired,showRegist:d.default.func.isRequired,loginDone:d.default.func.isRequired},t.default=T},E5dx:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("f7Do"),d=(a(c),n("RH2O")),f=n("F8kA"),h=n("gK+r"),p=a(h),m=n("nhtK"),v=(a(m),n("z55N"),function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),i(t,[{key:"render",value:function(){var e=this.props.permission;return s.default.createElement(p.default,{cardname:"个人中心"},s.default.createElement("div",{className:"lum-list"},s.default.createElement("ul",null,s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/managements/favorites"},s.default.createElement("h4",null,"我的收藏"),s.default.createElement("p",null,"查看、导出、删除收藏的句子。数据存储在本地，如果清除缓存，可能会导致数据丢失。"))),s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/myspace/collections"},s.default.createElement("h4",null,"我的句集"),s.default.createElement("p",null,"查看所有的句集"))),s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/managements/sources"},s.default.createElement("h4",null,"来源管理"),s.default.createElement("p",null,"管理添加获取句子的URL"))),s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/managements/patterns"},s.default.createElement("h4",null,"模式管理"),s.default.createElement("p",null,"根据自己喜好选择来源形成模式"))),s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/managements/sync"},s.default.createElement("h4",null,"离线缓存"),s.default.createElement("p",null,"将来源的全部句子缓存到本地，离线时也可以使用"))),s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/managements/cleaner"},s.default.createElement("h4",null,"缓存清理"),s.default.createElement("p",null,"清理本地缓存，例如已经删除了的来源的遗留下的缓存"))),s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/managements/backup"},s.default.createElement("h4",null,"备份还原"),s.default.createElement("p",null,"备份本地的所有模式和来源到服务器上，或者从服务器上还原之前备份的数据。"))),s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/myspace/profiles"},s.default.createElement("h4",null,"账号设置"),s.default.createElement("p",null,"修改邮箱，修改密码"))),e?s.default.createElement("li",null,s.default.createElement(f.Link,{to:"/admin"},s.default.createElement("h4",null,"后台管理"),s.default.createElement("p",null,"审核句子，发布广播"))):null)))}}]),t}(u.Component)),y=function(e){return{permission:e.user.permission}};t.default=(0,d.connect)(y)(v)},EA9e:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=new Date,n=t.getFullYear(),a=v[t.getMonth()],o=t.getDate(),r=void 0,i=null,u=null;r=e.user&&e.user.nickname?E:y;var s=e.location.pathname;return e.panel===p.PANEL_OPEN+"nav"&&(u=l.default.createElement("div",{key:"nav-dimmer",onClick:function(){h.default.start(),e.hideNav()},className:m.navPhoneDimmer},l.default.createElement("i",{className:"iconfont icon-close"})),i=l.default.createElement("div",{key:"nav",className:m.navPhone},r(e))),/preview$/.test(s)?l.default.createElement("div",{className:m.navWrapper},l.default.createElement("a",{className:m.hamburger},l.default.createElement("span",null))):l.default.createElement("div",{className:m.navWrapper},l.default.createElement("a",{className:m.hamburger,onClick:function(){h.default.stop(),e.showNav()}},l.default.createElement("span",null)),l.default.createElement("div",{className:m.nav+(e.layout.showCover?" "+m.showCover:"")},r(e)),e.layout.showCover?l.default.createElement("div",{className:m.navCover},l.default.createElement("h1",null,n,l.default.createElement("br",null),a,". ",o)):null,l.default.createElement(c.default,{animConfig:[{opacity:[1,0]},{opacity:[1,0]}],ease:["easeOutQuart","easeInOutQuart"]},u),l.default.createElement(c.default,{animConfig:[{translateX:[0,"-100"]},{translateX:[0,"-100%"]}],ease:["easeOutQuart","easeInOutQuart"]},i))}Object.defineProperty(t,"__esModule",{value:!0});var r=n("GiK3"),l=a(r),i=n("KSGD"),u=a(i),s=n("f7Do"),c=a(s),d=n("F8kA"),f=n("8f34"),h=a(f),p=n("EjY7"),m=n("9/+i"),v=["January","February","March","April","May","June","July","August","September","October","November","December"],y=function(e){return l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement("a",{href:"javascript:",onClick:e.showLogin},"登录")),l.default.createElement("li",null,l.default.createElement("a",{href:"javascript:",onClick:e.showRegist},"注册")),l.default.createElement("li",null,l.default.createElement(d.Link,{to:"/explore"},"探索")),l.default.createElement("li",null,l.default.createElement(d.Link,{to:"/managements"},"管理")),l.default.createElement("li",null,l.default.createElement(d.Link,{to:"/about"},"关于")))},E=function(e){return l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement(d.Link,{to:"/myspace",title:"前往个人中心"},"个人中心")),l.default.createElement("li",null,l.default.createElement(d.Link,{to:"/explore"},"探索")),l.default.createElement("li",null,l.default.createElement(d.Link,{to:"/about"},"关于")),l.default.createElement("li",null,l.default.createElement("a",{href:"javascript:",onClick:e.logout},"注销")))};o.propTypes={user:u.default.object.isRequired,logout:u.default.func.isRequired,showLogin:u.default.func.isRequired,showRegist:u.default.func.isRequired,panel:u.default.string.isRequired,showNav:u.default.func.isRequired,hideNav:u.default.func.isRequired},t.default=(0,d.withRouter)(o)},EWX9:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){return localStorage.getItem(d)}function r(e){localStorage.setItem(d,e)}function l(){var e=localStorage.getItem(v);return e?JSON.parse(e):e}function i(e){null!=e&&("object"==(void 0===e?"undefined":s(e))?localStorage.setItem(v,JSON.stringify(e)):"string"==typeof e&&localStorage.setItem(v,e))}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=t.VERSION="2017081401 count1",d="hikotokosources_version",f=t.SOURCES=[{id:1001,name:"hitokoto.cn",url:"https://v1.hitokoto.cn/",adapter:"function(resp){\n      var source = resp.from;\n      var category = resp.type;\n      delete resp.from;\n      delete resp.category;\n      resp.source = source;\n      resp.category = category;\n      return resp;\n    }",online:!0,local:!0,count:0},{id:1002,name:"hitoapi.cc",url:"https://hitoapi.cc/s",adapter:"function(resp){\n        var id = String(resp.id).slice(0,9);\n        return { \n          category: resp.catname,\n          creator:resp.author,\n          created_at: resp.date,\n          id: id,\n          hitokoto: resp.text,\n          source: resp.source\n        }\n      }",online:!0,local:!0,count:0},{id:1005,name:"hitoapi.cc",url:"https://hitoapi.cc/sp",adapter:"function(resp){\n      return {\n       category: resp.catname,\n       creator: resp.author,\n       created_at: resp.date,\n       id: resp.id,\n       hitokoto: resp.text,\n       source: resp.source\n      }\n    }",online:!0,local:!0,count:0},{id:1006,name:"https://api.satori.moe/hitokoto.php",url:"https://api.satori.moe/hitokoto.php",adapter:'function (resp){ \n     var id = String(resp.id).slice(0,6);\n    return {\n      hitokoto: resp.hitokoto,\n      category: resp.cat,\n      id: id,\n      source: resp.source,\n      creator: "",\n      created_at: resp.addtime\n      }\n    }',online:!0,local:!0,count:0}],h=t.SITE_DEFAULT=[{id:1009,name:"松浦弥太郎的一百个基本",url:location.origin+"/cors/桃码陶/100个基本",adapter:0,online:!0,local:!0,count:0}],p=t.SITE_ALL=[{id:1010,name:"全站随机",url:location.origin+"/cors",adapter:0,online:!0,local:!0,count:0}],m=f.concat(h,p),v="hikotokosources",y=t.getURL=function(e,t,n){return location.protocol+"//"+location.host+(n?"/cors/":"/api/sources/")+e+"/"+t},E=function(){function e(){var t=this;if(a(this,e),this.version_source=o(),this.version_source||(r(c),this.version_source=c),this.sources=l(),this.sources||(i(m),this.sources=m),-1===this.version_source.indexOf("count1")&&(this.sources.forEach(function(e){e.count=0}),i(this.sources)),c>this.version_source){var n={},u=!1;this.sources.forEach(function(e){n[e.url]=!0}),m.forEach(function(e){n[e.url]||(t.sources.push(e),u=!0)}),u&&i(this.sources),r(c)}}return u(e,[{key:"newSource",value:function(e){this.sources.push(e),i(this.sources)}},{key:"removeSourceWithUsernameAndCol",value:function(e,t,n){var a=this.getUrlOfUserCol(e,t,n),o=this.sources.find(function(e){return e.url==a}),r=JSON.parse(JSON.stringify(o));return this.deleteSource(o.id),r}},{key:"newSourceWithUsernameAndCol",value:function(e,t,n,a,o){var r=void 0,l=void 0,u=e+"-"+t;return r=n?this.getUrlOfUserCol(e,t,!0):this.getUrlOfUserCol(a,o,!1),l={id:Date.now(),url:r,name:u,adapter:0,online:!0,local:!0},this.sources.push(l),i(this.sources),JSON.parse(JSON.stringify(l))}},{key:"getUrlOfUserCol",value:function(e,t,n){return y(e,t,n)}},{key:"isSourceExsit",value:function(e){if(!e)return!1;var t=new RegExp("^"+e);return!!~this.sources.findIndex(function(e){return!!t.test(e.url)})||void 0}},{key:"updateSource",value:function(e,t){for(var n=0,a=this.sources.length;n<a;n++)this.sources[n].id==e&&(this.sources[n]=t);i(this.sources)}},{key:"deleteSource",value:function(e){for(var t,n=0,a=this.sources.length;n<a;n++)this.sources[n].id==e&&(t=this.sources.splice(n,1),n--,a--);return i(this.sources),JSON.parse(JSON.stringify(t[0]))}},{key:"restoreSources",value:function(e){e&&e.length&&(this.sources=JSON.parse(JSON.stringify(e)),i(this.sources))}}]),e}();t.default=E},EamV:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=localStorage.getItem(f);return e?JSON.parse(e):{}}function r(e){localStorage.setItem(f,JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0});var l=n("vxS+"),i=a(l),u=n("uY+K"),s=a(u),c=n("EjY7"),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),t=arguments[1];switch(t.type){case c.USER_LOGIN:var n=t.value,a=(0,i.default)(e,{$set:{nickname:n.nickname,token:n.token,uid:n.uid,permission:n.permission}});return r(a),s.default.updateToken(n.token),a;case c.USER_LOGOUT:return r({nickname:"",token:"",uid:"",permission:0}),s.default.updateToken(""),{nickname:"",token:"",uid:"",permission:0};case c.USER_UPDATE_USERNICKNAME:default:return e}};t.default=d;var f="ls_user"},EjY7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.PANEL_OPEN="panel open",o=t.PANEL_HIDE="panel hide",r=(t.showPanel=function(e){return{type:a,value:e}},t.hidePanel=function(e){return{type:o,value:e}},t.USER_LOGIN="user login"),l=t.USER_LOGOUT="user logout",i=t.USER_UPDATE_USERNICKNAME="update user nickname",u=(t.userLogin=function(e){return{type:r,value:e}},t.userLogout=function(){return function(e){return Promise.resolve({type:l}).then(function(t){return e(t)})}},t.updateNickname=function(e){return{type:i,value:e}},t.HITOKOTO_NEXT="hitokoto next",t.HITOKOTO_PROCESSING="hitokoto processing"),s=(t.hitokotoProcessing=function(){return{type:u}},t.hitokotoNext=function(){return function(e){return fetch("http://www.reddit.com/r/joke.json").then(function(e){return e.json()}).then(function(t){return e(receivePosts(subreddit,t))})}},t.LAYOUT_CHANGE="layout change"),c=(t.changeLayout=function(e,t){return{type:s,prop:e,value:t}},t.COLLECTIONS_FETCHED_SUCCESS="collection fetched success"),d=t.COLLECTIONS_FETCHED_FAILED="collection fetched failed",f=(t.fetchCollectionSuccess=function(e){return{type:c,value:e}},t.fetchCollectionFailed=function(e){return{type:d,value:e}},t.LEAVE_COLLECTION="collection leave"),h=(t.leaveCollection=function(){return{type:f,value:""}},t.FETCH_COLLECTION_HITO_SUCCESS="hitokotos of collection"),p=(t.fetchHitokotosSuccess=function(e){return{type:h,value:e}},t.REFRESH_COLLECTION_HITO="refresh collection-hitokoto"),m=(t.refreshHitokotoList=function(){return{type:p}},t.REFRESH_COLLECTION_HITO_DONE="refresh collection-hitokoto done"),v=(t.refreshCollectionHitokotoSuccess=function(){return{type:m}},t.REMOVE_ONE_HITO_SUCCESS="hitokotos remove one success"),y=(t.removeHitokotosSuccess=function(e){return{type:v,value:e}},t.PREVIEW_HITOKOTO="preview hitokoto"),E=(t.previewHitokoto=function(e,t){return{type:y,value:e,ptype:t}},t.CLEAN_PREVIEW="clean preview"),b=(t.cleanPreview=function(e){return{type:E,ptype:e}},t.SHOW_NOTIFICATION="show notification"),g=t.REMOVE_NOTIFICATION="remove notification",k=(t.sendNotification=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;return function(o){var r=Date.now();n||setTimeout(function(){o(k(r))},1e3*a),o({type:b,id:r,value:e,ntype:t,interactive:n})}},t.removeNotification=function(e){return{type:g,value:e}}),w=t.UPDATE_TASK="update task",O=t.REMOVE_TASK="remove task",_=(t.updateTask=function(e,t,n){return{type:w,value:t,id:e,done:n}},t.removeTask=function(e){return{type:O,value:e}},t.SOURCES_NEW_ONE="sources new one"),S=t.SOURCES_REMOVE_ONE="sources remove one",N=t.SOURCES_NEW_ONE_DONE="sources new one done",C=t.SOURCES_REMOVE_ONE_DONE="sources remove one done";t.newOneSource=function(e){return{type:_,value:e}},t.removeOneSource=function(e){return{type:S,value:e}},t.newOneSourceDone=function(){return{type:N}},t.removeOneSourceDone=function(){return{type:C}}},GoiC:function(e,t){e.exports={hitokotoTextarea:"_3bpQ6EH9ZWEDgocEOW5daF",hitokotoSouceInput:"_340qm16_2RAhrUd4mCb1k4",hitokotoSouceTypeBlock:"_2mT8lcEoAzWYstNj1n6TvZ",operations:"_19u4k7oSN7vaiZ86656dE2",suggeBox:"_2EhAwTw-hiIeS30eDMMJTj",inputSuggestion:"YBoR_5hJC1sj4lKD3HKOD"}},HvcI:function(e,t,n){"use strict";function a(e){if("[object Date]"!==Object.prototype.toString.call(e)){var t=e;e=new Date(e);var n=e.getDate();if(n!==n)return void 0===e?"某个时刻":"string"==typeof t?t:"(时间参数不合法)"}var a=e.getFullYear(),r=e.getMonth(),l=e.getDate(),i=e.getHours(),u=e.getMinutes(),s=e.getSeconds(),c=new Date,d=c.getFullYear(),f=c.getMonth(),h=c.getDate(),p=c.getHours(),m=c.getMinutes(),v=c.getSeconds();return d===a?f===r?h===l?p===i?m===u?v===s?"刚刚":v-s+"秒前":m-u+"分钟前":"今天 "+o(i)+":"+o(u):h-l==1?"昨天 "+o(i)+":"+o(u):h-l==2?"前天 "+o(i)+":"+o(u):r+1+"月"+l+"日 "+o(i)+":"+o(u):r+1+"月"+l+"日 "+o(i)+":"+o(u):a+"年"+(r+1)+"月"+l+"日 "+o(i)+":"+o(u)}Object.defineProperty(t,"__esModule",{value:!0});var o=t.addZero=function(e){return e<10?"0"+e:e};t.default=a},IaXC:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return l.default.createElement("div",{className:u.default.logo,onClick:c.default.toggleFullScreen.bind(c.default)},l.default.createElement("h1",{title:"点击此处开启全屏或退出全屏"},"一言"))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n("GiK3"),l=a(r),i=n("iwfW"),u=a(i),s=n("uwXn"),c=a(s)},Ic9l:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r.default.createElement(i.default,{cardname:"更新"},r.default.createElement("h1",{className:"color-red"},"自动刷新页面。。。"))};var o=n("GiK3"),r=a(o),l=n("gK+r"),i=a(l);n("F8kA")},IfnF:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return l.default.createElement(u.default,{cardname:"开源协议"},l.default.createElement("div",{className:s.article},l.default.createElement("section",null,l.default.createElement("h2",null,"Hitokoto-pwa"),l.default.createElement("pre",null,'MIT License\n\nCopyright (c) 2017 陶楷\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.  ')),l.default.createElement("section",null,l.default.createElement("h2",null,"Crypto-js"),l.default.createElement("pre",null,'The MIT License (MIT)\n\nCopyright (c) 2009-2013 Jeff Mott  \nCopyright (c) 2013-2016 Evan Vosberg\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.      \n  ')),l.default.createElement("section",null,l.default.createElement("h2",null,"React"),l.default.createElement("pre",null,'MIT License\n\nCopyright (c) 2013-present, Facebook, Inc.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE. \n  ')),l.default.createElement("section",null,l.default.createElement("h2",null,"React-Redux,Redux,Redux-Thunk"),l.default.createElement("pre",null,'The MIT License (MIT)\n\nCopyright (c) 2015-present Dan Abramov\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.')),l.default.createElement("section",null,l.default.createElement("h2",null,"React-Router"),l.default.createElement("pre",null,'The MIT License (MIT)\n\nCopyright (c) 2015-present, Ryan Florence, Michael Jackson\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights \nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell \ncopies of the Software, and to permit persons to whom the Software is \nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all \ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \nSOFTWARE.            ')),l.default.createElement("section",null,l.default.createElement("h2",null,"Dexie"),l.default.createElement("pre",null,'\n          Apache License\n          Version 2.0, January 2004\n       http://www.apache.org/licenses/\n\nTERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n1. Definitions.\n\n"License" shall mean the terms and conditions for use, reproduction,\nand distribution as defined by Sections 1 through 9 of this document.\n\n"Licensor" shall mean the copyright owner or entity authorized by\nthe copyright owner that is granting the License.\n\n"Legal Entity" shall mean the union of the acting entity and all\nother entities that control, are controlled by, or are under common\ncontrol with that entity. For the purposes of this definition,\n"control" means (i) the power, direct or indirect, to cause the\ndirection or management of such entity, whether by contract or\notherwise, or (ii) ownership of fifty percent (50%) or more of the\noutstanding shares, or (iii) beneficial ownership of such entity.\n\n"You" (or "Your") shall mean an individual or Legal Entity\nexercising permissions granted by this License.\n\n"Source" form shall mean the preferred form for making modifications,\nincluding but not limited to software source code, documentation\nsource, and configuration files.\n\n"Object" form shall mean any form resulting from mechanical\ntransformation or translation of a Source form, including but\nnot limited to compiled object code, generated documentation,\nand conversions to other media types.\n\n"Work" shall mean the work of authorship, whether in Source or\nObject form, made available under the License, as indicated by a\ncopyright notice that is included in or attached to the work\n(an example is provided in the Appendix below).\n\n"Derivative Works" shall mean any work, whether in Source or Object\nform, that is based on (or derived from) the Work and for which the\neditorial revisions, annotations, elaborations, or other modifications\nrepresent, as a whole, an original work of authorship. For the purposes\nof this License, Derivative Works shall not include works that remain\nseparable from, or merely link (or bind by name) to the interfaces of,\nthe Work and Derivative Works thereof.\n\n"Contribution" shall mean any work of authorship, including\nthe original version of the Work and any modifications or additions\nto that Work or Derivative Works thereof, that is intentionally\nsubmitted to Licensor for inclusion in the Work by the copyright owner\nor by an individual or Legal Entity authorized to submit on behalf of\nthe copyright owner. For the purposes of this definition, "submitted"\nmeans any form of electronic, verbal, or written communication sent\nto the Licensor or its representatives, including but not limited to\ncommunication on electronic mailing lists, source code control systems,\nand issue tracking systems that are managed by, or on behalf of, the\nLicensor for the purpose of discussing and improving the Work, but\nexcluding communication that is conspicuously marked or otherwise\ndesignated in writing by the copyright owner as "Not a Contribution."\n\n"Contributor" shall mean Licensor and any individual or Legal Entity\non behalf of whom a Contribution has been received by Licensor and\nsubsequently incorporated within the Work.\n\n2. Grant of Copyright License. Subject to the terms and conditions of\nthis License, each Contributor hereby grants to You a perpetual,\nworldwide, non-exclusive, no-charge, royalty-free, irrevocable\ncopyright license to reproduce, prepare Derivative Works of,\npublicly display, publicly perform, sublicense, and distribute the\nWork and such Derivative Works in Source or Object form.\n\n3. Grant of Patent License. Subject to the terms and conditions of\nthis License, each Contributor hereby grants to You a perpetual,\nworldwide, non-exclusive, no-charge, royalty-free, irrevocable\n(except as stated in this section) patent license to make, have made,\nuse, offer to sell, sell, import, and otherwise transfer the Work,\nwhere such license applies only to those patent claims licensable\nby such Contributor that are necessarily infringed by their\nContribution(s) alone or by combination of their Contribution(s)\nwith the Work to which such Contribution(s) was submitted. If You\ninstitute patent litigation against any entity (including a\ncross-claim or counterclaim in a lawsuit) alleging that the Work\nor a Contribution incorporated within the Work constitutes direct\nor contributory patent infringement, then any patent licenses\ngranted to You under this License for that Work shall terminate\nas of the date such litigation is filed.\n\n4. Redistribution. You may reproduce and distribute copies of the\nWork or Derivative Works thereof in any medium, with or without\nmodifications, and in Source or Object form, provided that You\nmeet the following conditions:\n\n(a) You must give any other recipients of the Work or\nDerivative Works a copy of this License; and\n\n(b) You must cause any modified files to carry prominent notices\nstating that You changed the files; and\n\n(c) You must retain, in the Source form of any Derivative Works\nthat You distribute, all copyright, patent, trademark, and\nattribution notices from the Source form of the Work,\nexcluding those notices that do not pertain to any part of\nthe Derivative Works; and\n\n(d) If the Work includes a "NOTICE" text file as part of its\ndistribution, then any Derivative Works that You distribute must\ninclude a readable copy of the attribution notices contained\nwithin such NOTICE file, excluding those notices that do not\npertain to any part of the Derivative Works, in at least one\nof the following places: within a NOTICE text file distributed\nas part of the Derivative Works; within the Source form or\ndocumentation, if provided along with the Derivative Works; or,\nwithin a display generated by the Derivative Works, if and\nwherever such third-party notices normally appear. The contents\nof the NOTICE file are for informational purposes only and\ndo not modify the License. You may add Your own attribution\nnotices within Derivative Works that You distribute, alongside\nor as an addendum to the NOTICE text from the Work, provided\nthat such additional attribution notices cannot be construed\nas modifying the License.\n\nYou may add Your own copyright statement to Your modifications and\nmay provide additional or different license terms and conditions\nfor use, reproduction, or distribution of Your modifications, or\nfor any such Derivative Works as a whole, provided Your use,\nreproduction, and distribution of the Work otherwise complies with\nthe conditions stated in this License.\n\n5. Submission of Contributions. Unless You explicitly state otherwise,\nany Contribution intentionally submitted for inclusion in the Work\nby You to the Licensor shall be under the terms and conditions of\nthis License, without any additional terms or conditions.\nNotwithstanding the above, nothing herein shall supersede or modify\nthe terms of any separate license agreement you may have executed\nwith Licensor regarding such Contributions.\n\n6. Trademarks. This License does not grant permission to use the trade\nnames, trademarks, service marks, or product names of the Licensor,\nexcept as required for reasonable and customary use in describing the\norigin of the Work and reproducing the content of the NOTICE file.\n\n7. Disclaimer of Warranty. Unless required by applicable law or\nagreed to in writing, Licensor provides the Work (and each\nContributor provides its Contributions) on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\nimplied, including, without limitation, any warranties or conditions\nof TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\nPARTICULAR PURPOSE. You are solely responsible for determining the\nappropriateness of using or redistributing the Work and assume any\nrisks associated with Your exercise of permissions under this License.\n\n8. Limitation of Liability. In no event and under no legal theory,\nwhether in tort (including negligence), contract, or otherwise,\nunless required by applicable law (such as deliberate and grossly\nnegligent acts) or agreed to in writing, shall any Contributor be\nliable to You for damages, including any direct, indirect, special,\nincidental, or consequential damages of any character arising as a\nresult of this License or out of the use or inability to use the\nWork (including but not limited to damages for loss of goodwill,\nwork stoppage, computer failure or malfunction, or any and all\nother commercial damages or losses), even if such Contributor\nhas been advised of the possibility of such damages.\n\n9. Accepting Warranty or Additional Liability. While redistributing\nthe Work or Derivative Works thereof, You may choose to offer,\nand charge a fee for, acceptance of support, warranty, indemnity,\nor other liability obligations and/or rights consistent with this\nLicense. However, in accepting such obligations, You may act only\non Your own behalf and on Your sole responsibility, not on behalf\nof any other Contributor, and only if You agree to indemnify,\ndefend, and hold each Contributor harmless for any liability\nincurred by, or claims asserted against, such Contributor by reason\nof your accepting any such warranty or additional liability.\n\nEND OF TERMS AND CONDITIONS\n\nAPPENDIX: How to apply the Apache License to your work.\n\nTo apply the Apache License to your work, attach the following\nboilerplate notice, with the fields enclosed by brackets "{}"\nreplaced with your own identifying information. (Don\'t include\nthe brackets!)  The text should be enclosed in the appropriate\ncomment syntax for the file format. We also recommend that a\nfile or class name and description of purpose be included on the\nsame "printed page" as the copyright notice for easier\nidentification within third-party archives.\n\nCopyright 2014 David Fahlander\n\nLicensed under the Apache License, Version 2.0 (the "License");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n')),l.default.createElement("section",null,l.default.createElement("h2",null,"react-textarea-autosize"),l.default.createElement("pre",null,'The MIT License (MIT)\n\nCopyright (c) 2013 Andrey Popp\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the "Software"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n')),l.default.createElement("section",null,l.default.createElement("h2",null,"rc-queue-anim"),l.default.createElement("pre",null,'MIT LICENSE\n\nCopyright (c) 2015-present Alipay.com, https://www.alipay.com/\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n"Software"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n')),l.default.createElement("section",null,l.default.createElement("h2",null,"Source Han Serif | 思源宋体 | 思源宋體 | 源ノ明朝 | 본명조"),l.default.createElement("pre",null,'This Font Software is licensed under the SIL Open Font License,\nVersion 1.1.\n\nThis license is copied below, and is also available with a FAQ at:\nhttp://scripts.sil.org/OFL\n\n-----------------------------------------------------------\nSIL OPEN FONT LICENSE Version 1.1 - 26 February 2007\n-----------------------------------------------------------\n\nPREAMBLE\nThe goals of the Open Font License (OFL) are to stimulate worldwide\ndevelopment of collaborative font projects, to support the font\ncreation efforts of academic and linguistic communities, and to\nprovide a free and open framework in which fonts may be shared and\nimproved in partnership with others.\n\nThe OFL allows the licensed fonts to be used, studied, modified and\nredistributed freely as long as they are not sold by themselves. The\nfonts, including any derivative works, can be bundled, embedded,\nredistributed and/or sold with any software provided that any reserved\nnames are not used by derivative works. The fonts and derivatives,\nhowever, cannot be released under any other type of license. The\nrequirement for fonts to remain under this license does not apply to\nany document created using the fonts or their derivatives.\n\nDEFINITIONS\n"Font Software" refers to the set of files released by the Copyright\nHolder(s) under this license and clearly marked as such. This may\ninclude source files, build scripts and documentation.\n\n"Reserved Font Name" refers to any names specified as such after the\ncopyright statement(s).\n\n"Original Version" refers to the collection of Font Software\ncomponents as distributed by the Copyright Holder(s).\n\n"Modified Version" refers to any derivative made by adding to,\ndeleting, or substituting -- in part or in whole -- any of the\ncomponents of the Original Version, by changing formats or by porting\nthe Font Software to a new environment.\n\n"Author" refers to any designer, engineer, programmer, technical\nwriter or other person who contributed to the Font Software.\n\nPERMISSION & CONDITIONS\nPermission is hereby granted, free of charge, to any person obtaining\na copy of the Font Software, to use, study, copy, merge, embed,\nmodify, redistribute, and sell modified and unmodified copies of the\nFont Software, subject to the following conditions:\n\n1) Neither the Font Software nor any of its individual components, in\nOriginal or Modified Versions, may be sold by itself.\n\n2) Original or Modified Versions of the Font Software may be bundled,\nredistributed and/or sold with any software, provided that each copy\ncontains the above copyright notice and this license. These can be\nincluded either as stand-alone text files, human-readable headers or\nin the appropriate machine-readable metadata fields within text or\nbinary files as long as those fields can be easily viewed by the user.\n\n3) No Modified Version of the Font Software may use the Reserved Font\nName(s) unless explicit written permission is granted by the\ncorresponding Copyright Holder. This restriction only applies to the\nprimary font name as presented to the users.\n\n4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font\nSoftware shall not be used to promote, endorse or advertise any\nModified Version, except to acknowledge the contribution(s) of the\nCopyright Holder(s) and the Author(s) or with their explicit written\npermission.\n\n5) The Font Software, modified or unmodified, in part or in whole,\nmust be distributed entirely under this license, and must not be\ndistributed under any other license. The requirement for fonts to\nremain under this license does not apply to any document created using\nthe Font Software.\n\nTERMINATION\nThis license becomes null and void if any of the above conditions are\nnot met.\n\nDISCLAIMER\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT\nOF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE\nCOPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nINCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL\nDAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM\nOTHER DEALINGS IN THE FONT SOFTWARE.\n')))," ")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n("GiK3"),l=a(r),i=n("gK+r"),u=a(i),s=n("iiOv")},IpQa:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("EjY7"),i=n("Xd3r"),u=a(i),s=function(e,t){return{layout:e.layout,panel:e.panel,user:e.user}},c=function(e){return{hideRegist:function(){return e((0,l.hidePanel)("regist"))},showLogin:function(){return e((0,l.showPanel)("login"))},registDone:function(t){return e((0,l.userLogin)(t))}}};t.default=(0,r.connect)(s,c)(u.default)},LCwm:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("F8kA"),d=n("gK+r"),f=a(d),h=n("a0hn"),p=a(h),m=n("uY+K"),v=a(m),y=n("f7Do"),E=a(y),b=n("jdew"),g=a(b),k=n("8f34"),w=a(k),O=n("YpvI"),_=a(O),S=n("YXrc"),N=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={user:{},inited:!1,error:null},n.handleView=n.handleView.bind(n),n.exploreUser=n.exploreUser.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){this.exploreUser()}},{key:"exploreUser",value:function(){var e=this;if(!this.props.uid)return this.props.history.push("/");v.default.API_getPublicUserDetail(this.props.uid).then(function(t){e.setState({inited:!0,error:null,user:t.user})}).catch(function(t){e.setState({error:t.message||t||"获取用户句集失败",inited:!1}),(0,_.default)("获取用户句集失败","error")})}},{key:"handleView",value:function(e){this.props.history.push(this.props.location.pathname+"/"+e)}},{key:"render",value:function(){var e=this,t=this.props,n=(t.location,t.userName),a=this.state.user,o=(w.default.patterManager,null);return this.state.inited&&(o=a.collections.map(function(t,a){return s.default.createElement(g.default,{data:t,key:a,ownerName:n,tabIndex:a+1,view:e.handleView,isPublic:!0})})),s.default.createElement(f.default,{cardname:n},this.state.inited?s.default.createElement(E.default,{animConfig:[{opacity:[1,0],translateX:[0,50]},{opacity:[1,0],position:"absolute",translateX:[0,-50]}],className:S.CardContainer},o):s.default.createElement(p.default,{error:this.state.error,retry:this.exploreUser,key:"loading"}))}}]),t}(u.Component);t.default=(0,c.withRouter)(N)},LdmG:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("F8kA"),d=n("YpvI"),f=a(d),h=n("8f34"),p=a(h),m=n("opgY"),v=a(m),y=n("MRx6"),E=p.default.patterManager,b=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeList:null,alldown:null},n}return l(t,e),i(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.sourceNew,n=e.sourceRemove,a=void 0,o=void 0;if(t||n){a=t&&t.url||n&&n.url,o=E.patterns.map(function(e,t){return!!~e.sources.findIndex(function(e){return e.url==a})});var r=!1;n&&(r=o.every(function(e){return 0==e})),this.setState({activeList:o,alldown:r})}else this.setState({activeList:null})}},{key:"handleClick",value:function(e){var t=this.props,n=t.sourceNew,a=t.sourceRemove,o=n&&n.url||a&&a.url,r=E.patterns[e];if(this.state.activeList[e])if(1==r.sources.length)(0,f.default)("该模式只有一个来源，请在「模式管理」中移除。","error");else{var l=r.sources.findIndex(function(e){return e.url==o});r.sources.splice(l,1),p.default.updatePattern(r.id,JSON.parse(JSON.stringify(r))),this.setState({activeList:this.state.activeList.map(function(t,n){return n!=e&&t})})}else{var i=JSON.parse(JSON.stringify(n));i.online=!0,i.local=!0,r.sources.push(i),p.default.updatePattern(r.id,JSON.parse(JSON.stringify(r))),this.setState({activeList:this.state.activeList.map(function(t,n){return n==e||t})})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.sourceNew,a=t.sourceRemove,o=this.state.activeList;return n?s.default.createElement(v.default,{focus:!0,exit:this.props.newOneSourceDone},s.default.createElement("h3",null,n.name,"加入来源成功!"),s.default.createElement("p",null,"是否将「",n.name,"」在下列模式中激活？(点击激活)"),s.default.createElement("hr",null),s.default.createElement("div",null,s.default.createElement("ul",{className:y.patternsList},E.patterns.map(function(t,n){return s.default.createElement("li",{className:o[n]?y.active:"",key:t.id,onClick:function(){return e.handleClick(n)}},t.name)}))),s.default.createElement("hr",null),s.default.createElement("div",{className:"clearfix"},s.default.createElement("button",null,s.default.createElement(c.Link,{role:"exit",to:"/managements/patterns/new"},"添加模式")),s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{className:"color-basic",role:"exit"},"以后再说"),s.default.createElement("button",{role:"exit"},"确定")))):a?this.state.alldown?s.default.createElement(v.default,{exit:this.props.removeOneSourceDone},s.default.createElement("h3",null,"从来源移除「",a.name,"」成功!"),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{role:"exit"},"确定")))):s.default.createElement(v.default,{focus:!0,exit:this.props.removeOneSourceDone},s.default.createElement("h3",null,"「",a.name,"」移除成功!"),s.default.createElement("p",null,"是否将「",a.name,"」从下列模式中移除？(点击移除)"),s.default.createElement("hr",null),s.default.createElement("div",null,s.default.createElement("ul",{className:y.patternsList},E.patterns.map(function(t,n){return s.default.createElement("li",{className:o[n]?y.active:"disabled",key:t.id,onClick:function(){return e.handleClick(n)}},t.name)}))),s.default.createElement("hr",null),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{className:"color-basic",role:"exit"},"以后再说"),s.default.createElement("button",{role:"exit"},"确定")))):null}}]),t}(u.Component);t.default=b},LhJ3:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.hitokoto,n=t.id,a=t.source,o=t.author,r=t.hitokoto,i=(t.creator,t.created_at,t.type,e.layout),s=i.backgroundColor,d=i.font,f=i.fontWeight,m=e.actions,E=e.animateConfig,b=!1;r&&r.length>y&&(b=!0);var g=l.default.createElement("div",{className:h.Content+(b?" "+h.overLoadHitokoto:""),style:{fontFamily:p.FONT_MAP[d],fontWeight:f},key:n},l.default.createElement("h1",null,r),o||a?l.default.createElement("p",null,l.default.createElement("i",null,"——"),"  ",o||"",o?" ":"",a):"");return l.default.createElement("div",{className:h.layout_vertical,style:{backgroundColor:s,overflow:"hidden"}},l.default.createElement(u.default,null),l.default.createElement(v.default,null)," ",l.default.createElement(c.default,{duration:"1000",className:h.verticalAnimate,animConfig:E},l.default.createElement("div",{className:h.oprations,key:"fff"},l.default.createElement("ul",{component:"ul",className:h.actions},m)),g))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n("GiK3"),l=a(r),i=n("IaXC"),u=a(i),s=n("f7Do"),c=a(s),d=n("16R6"),f=a(d),h=n("D9xO"),p=n("z55N"),m=n("Sw03"),v=a(m),y=f.default.width>768?140:40;f.default.subscriptb(function(){y=f.default.width>768?140:40})},MRx6:function(e,t){e.exports={patternsList:"_2lg0MmJunGKH9OxC2_vlwU",active:"_20ETIwqT-UVudhDy436etr"}},N9Rm:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return l.default.createElement(s.default,{cardname:"后台管理"},l.default.createElement("div",{className:"lum-list"},l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/admin/review"},l.default.createElement("h4",null,"审核句子"),l.default.createElement("p",null,"通过或者Block句子。"))),l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/admin/users"},l.default.createElement("h4",null,"用户管理"),l.default.createElement("p",null,"禁用用户"))),l.default.createElement("li",null,l.default.createElement(i.Link,{to:"/admin/broadcast"},l.default.createElement("h4",null,"通知公告"),l.default.createElement("p",null,"广播公告给所有用户"))))))}Object.defineProperty(t,"__esModule",{value:!0});var r=n("GiK3"),l=a(r),i=n("F8kA"),u=n("gK+r"),s=a(u);t.default=o},O2pb:function(e,t){},OH9m:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r.default.createElement(i.default,{cardname:"404 - Not Found"},r.default.createElement("h1",{className:"color-red"},"众里寻他千百度，",r.default.createElement("br",null),"那人却在灯火阑珊处。"),r.default.createElement("p",null,r.default.createElement("button",null,r.default.createElement(u.Link,{to:"/"},"回到首页"))))};var o=n("GiK3"),r=a(o),l=n("gK+r"),i=a(l),u=n("F8kA")},P9TA:function(e,t){e.exports={settingWrapper:"_2ggBoMME9dnB52gdMMX0aF"}},Ppqp:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("uuIP"),i=a(l),u=n("EjY7"),s=function(e){return{layout:e.layout,collections:e.collections,user:e.user}},c=function(e){return{fetchCollectionSuccess:function(t){return e((0,u.fetchCollectionSuccess)(t))}}};t.default=(0,r.connect)(s,c)(i.default)},QcX0:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=localStorage.getItem(E);return e||(r(),"no")}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no";localStorage.setItem(E,e)}function l(){return g}function i(){return new Promise(function(e,t){g||(g=new v.default),g.update("思源宋体下载中！\n如果过了几秒钟未显示下载进度，可能是服务器未返回Content-Length字段或者浏览器不支持。\n上面这句话看不懂没关系，只要这个任务栏没有报错，就等下去，大概要下载几十秒。"),g.abort=function(){n.abort(),g.failed("任务被取消！")};var n=new XMLHttpRequest;n.open("get","https://pluscdn.heitaov.cn/SourceHanSerifSC-Bold.otf",!0),n.onload=function(){g.success("思源宋体下载完成！"),g=null,e(n.response)},n.onprogress=function(e){if(e.lengthComputable){var t=(e.loaded/1024/1024).toFixed(2),n=(e.total/1024/1024).toFixed(2);g.update("思源宋体已下载 "+t+"MB/"+n+"MB")}},n.onerror=function(){g.failed("思源宋体下载失败！"),g=null,t("下载失败！")},n.responseType="blob",n.send()})}function u(e){return p.default.putAssert(b,e).then(function(){return k=!0,e})}function s(e){return(0,y.timeoutPromise)(1e4,new Promise(function(t,n){var a=new Blob([e],{type:"application/x-font-opentype;"}),o=URL.createObjectURL(a),r=document.createElement("style");r.id=b,r.onload=function(){t("ok"),URL.revokeObjectURL(e)},r.innerHTML='@font-face {font-family: "Source Han Serif SC";\n    src: url(\''+o+"') format('opentype');\n    font-style: normal;\n    font-weight: normal;/* 应该为bold */\n    font-display: swap;\n  }",document.head.appendChild(r)}))}function c(){return k}function d(){return r("yes"),p.default.getAssert(b).then(function(e){return e||i().then(u)}).then(s)}function f(){r("no");var e=document.getElementById(b);e&&document.head.removeChild(e)}Object.defineProperty(t,"__esModule",{value:!0});var h=n("mScD"),p=a(h),m=n("bFiM"),v=a(m),y=n("uY+K"),E="source han",b="sourcehan",g=null,k=!1;p.default.getAssert(b).then(function(e){k=!!e}),t.default={getFontEabled:o,isStored:c,getTask:l,enableFont:d,disableFont:f},"yes"==o()&&p.default.getAssert(b).then(function(e){e?s(e):((new v.default).failed("思源宋体文件失效，已改为禁用。"),r("no"))})},RjvE:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var o=n("vxS+"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),l=n("EjY7"),i={data:[],hitokotos:[],needRefreshHikotokos:!1,within:null,preview:null},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments[1];switch(t.type){case l.COLLECTIONS_FETCHED_SUCCESS:return(0,r.default)(e,{data:{$set:t.value}});case l.LEAVE_COLLECTION:return(0,r.default)(e,{hitokotos:{$set:[]}});case l.REFRESH_COLLECTION_HITO:return(0,r.default)(e,{needRefreshHikotokos:{$set:!0}});case l.REFRESH_COLLECTION_HITO_DONE:return(0,r.default)(e,{needRefreshHikotokos:{$set:!1}});case l.FETCH_COLLECTION_HITO_SUCCESS:return(0,r.default)(e,{hitokotos:{$set:t.value}});case l.REMOVE_ONE_HITO_SUCCESS:var n=e.hitokotos.findIndex(function(e){return e._id===t.value});return~n?(0,r.default)(e,{hitokotos:{$splice:[[n,1]]}}):e;case l.PREVIEW_HITOKOTO:return(0,r.default)(e,a({},t.ptype,{$set:t.value}));case l.CLEAN_PREVIEW:return(0,r.default)(e,a({},t.ptype,{$set:null}));default:return e}};t.default=u},RoSH:function(e,t){e.exports={copyright:"d4PffxbEPUWSybtqtft1c","copyright-open":"_12nMwhe2h-RQTPwI6uNFzr","copyright-close":"_3TsrZFUwv9q0ImhJszwB76",hoverToShow:"AMQS0DoWiJK2A4apGcH_U","copyright-state":"_3OUvvCluC1g8bL8Fab37Jo"}},SC4H:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("8f34"),d=a(c),f=n("uY+K"),h=a(f),p=n("YpvI"),m=a(p),v=n("gK+r"),y=a(v),E=d.default.patterManager,b=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),i(t,[{key:"handleBackup",value:function(){var e={sources:E.sources,patterns:E.patterns},t=this.encode(e);h.default.API_backup({data:t}).then(function(e){(0,m.default)(e.message,"success")})}},{key:"handleRestore",value:function(){var e=this;h.default.API_restore().then(function(t){var n=t.backup,a=void 0;n?(a=e.decode(n),E.restoreSources(a.sources),d.default.restorePatterns(a.patterns),(0,m.default)("恢复成功！","success")):(0,m.default)("无备份！","info")})}},{key:"encode",value:function(e){var t=JSON.stringify(e),n=encodeURIComponent(t);return window.btoa(n)}},{key:"decode",value:function(e){var t=window.atob(e),n=decodeURIComponent(t);return JSON.parse(n)}},{key:"render",value:function(){return s.default.createElement(y.default,{cardname:"备份还原"},s.default.createElement("div",{className:"lum-list "},s.default.createElement("p",null,"如果是自动同步的话，每一步操作都要备份会很麻烦，所以请手动操作，在多设备间同步您的来源和模式。"),s.default.createElement("ul",null,s.default.createElement("li",null,s.default.createElement("a",{href:"javascript:",onClick:this.handleBackup.bind(this)},s.default.createElement("h4",null,"备份"),s.default.createElement("p",null,"将会把本地的来源和模式上传到服务器。"))),s.default.createElement("li",null,s.default.createElement("a",{href:"javascript:",onClick:this.handleRestore.bind(this)},s.default.createElement("h4",null,"还原"),s.default.createElement("p",null,"将会使用服务器上备份的来源和模式替换掉本地的来源和模式"))))))}}]),t}(u.Component);t.default=b},SMjv:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return l.default.createElement(s.default,{cardname:"接口文档"},l.default.createElement("div",{className:c.article},l.default.createElement("section",null,l.default.createElement("h2",null,"#1 获取一个hitokoto"),l.default.createElement("p",null,l.default.createElement("b",null,"GET")," ",l.default.createElement("span",null,"https://hitokoto.heitaov.cn/cors")),l.default.createElement("h4",null,"Query参数："),l.default.createElement("blockquote",null,l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement("b",null,"seed"),"(可选):整数类型，种子计数器，用于顺序获取hitokoto。"),l.default.createElement("li",null,l.default.createElement("b",null,"jsonp"),"(可选):String类型，jsonp函数名"))),l.default.createElement("br",null),l.default.createElement("h4",null,"示例:"),l.default.createElement("p",null,"https://hitokoto.heitaov.cn/cors/偏执狂/默认句集?seed=2333"),l.default.createElement("h4",null,"返回结果"),l.default.createElement("blockquote",null,l.default.createElement("pre",null,l.default.createElement("code",null,'\n  {\n    "_id":"59e701bb441b87b015878046",           //句子的数据库唯一id\n    "updated_at":"2017-10-18T07:24:43.872Z",    //句子更新时间\n    "created_at":"2017-10-18T07:24:43.872Z",    //句子创建时间\n    "id":50,                                    //句子的顺序ID,\n    "source":"fate/stay night",                 //句子的来源\n    "author":"",                                //句子的作者是谁\n    "category":"其他",                          //句子的分类\n    "hitokoto":"Excalibur!",                   //句子的内容\n    "creator_id":"59e6fddfa94d61a551c0a64d",   //创建者的id\n    "state":"public",                          //当前句子的状态\n    "creator":"emmmmm",                        //创建者的名字\n    "fid":"59e6fddfa94d61a551c0a64e",          //句集的数据库唯一id\n    "collection":"默认句集"                     //句集的名称\n  }\n  ')))),l.default.createElement("section",null,l.default.createElement("h2",null,"#2 获取某个句集下的hitokoto"),l.default.createElement("p",null,l.default.createElement("b",null,"GET")," ",l.default.createElement("span",null,"https://hitokoto.heitaov.cn/cors/:username/:collection")),l.default.createElement("h4",null,"Path参数："),l.default.createElement("blockquote",null,l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement("b",null,"username"),"(必选):String类型，用户的名字"),l.default.createElement("li",null,l.default.createElement("b",null,"collection"),"(必选):String类型，句集的名字"))),l.default.createElement("h4",null,"Query参数："),l.default.createElement("blockquote",null,l.default.createElement("ul",null,l.default.createElement("li",null,l.default.createElement("b",null,"seed"),"(可选):整数类型，种子计数器，用于顺序获取hitokoto。"),l.default.createElement("li",null,l.default.createElement("b",null,"jsonp"),"(可选):String类型，jsonp函数名"))),l.default.createElement("br",null),l.default.createElement("h4",null,"返回结果"),l.default.createElement("blockquote",null,l.default.createElement("pre",null,l.default.createElement("code",null,'\n  {\n  "_id":"59e701bb441b87b015878046",           //句子的数据库唯一id\n  "updated_at":"2017-10-18T07:24:43.872Z",    //句子更新时间\n  "created_at":"2017-10-18T07:24:43.872Z",    //句子创建时间\n  "id":50,                                    //句子的顺序ID,\n  "source":"fate/stay night",                 //句子的来源\n  "author":"",                                //句子的作者是谁\n  "category":"其他",                          //句子的分类\n  "hitokoto":"Excalibur!",                   //句子的内容\n  "creator_id":"59e6fddfa94d61a551c0a64d",   //创建者的id\n  "state":"public",                          //当前句子的状态\n  "creator":"emmmmm",                        //创建者的名字\n  "fid":"59e6fddfa94d61a551c0a64e",          //句集的数据库唯一id\n  "collection":"默认句集"                     //句集的名称\n  }\n  '))))))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n("GiK3"),l=a(r),i=(n("F8kA"),n("f7Do")),u=(a(i),n("gK+r")),s=a(u),c=n("iiOv")},SUp7:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("D7zQ"),i=a(l),u=n("EjY7"),s=function(e){return{layout:e.layout,within:e.collections.within,preview:e.collections.preview,nickname:e.user.nickname}},c=function(e){return{refreshHitokotoList:function(){return e((0,u.refreshHitokotoList)())},handlePreview:function(){return e(u.previewHitokoto.apply(void 0,arguments))}}};t.default=(0,r.connect)(s,c)(i.default)},Sw03:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("EjY7"),i=n("EA9e"),u=a(i),s=function(e){return{layout:e.layout,panel:e.panel,user:e.user}},c=function(e){return{showRegist:function(){return e((0,l.showPanel)("regist"))},showLogin:function(){return e((0,l.showPanel)("login"))},logout:function(){return e((0,l.userLogout)())},showNav:function(){return e((0,l.showPanel)("nav"))},hideNav:function(){return e((0,l.hidePanel)("nav"))}}};t.default=(0,r.connect)(s,c)(u.default)},T0SW:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("+Jqa"),i=a(l),u=n("EjY7"),s=function(e){return{hitokotos:e.collections.hitokotos,needRefresh:e.collections.needRefreshHikotokos,user:e.user}},c=function(e){return{fetchHitokotosSuccess:function(t){return e((0,u.fetchHitokotosSuccess)(t))},refreshCollectionHitokotoSuccess:function(){return e((0,u.refreshCollectionHitokotoSuccess)())},leaveCollection:function(){return e((0,u.leaveCollection)())},preview:function(){return e(u.previewHitokoto.apply(void 0,arguments))}}};t.default=(0,r.connect)(s,c)(i.default)},TamS:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("KSGD"),d=a(c),f=n("F8kA"),h=n("f7Do"),p=a(h),m=n("opgY"),v=a(m),y=n("YRpt"),E=a(y),b=n("8f34"),g=a(b),k=n("YpvI"),w=a(k),O=n("QcX0"),_=a(O),S=n("P9TA"),N=n("EjY7"),C=n("z55N"),P=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={currentPatternID:g.default.pattern.id,showLoadFontModal:!1},n.hideLoadFontModal=n.hideLoadFontModal.bind(n),n.confirmDownload=n.confirmDownload.bind(n),n}return l(t,e),i(t,[{key:"handlePatternChange",value:function(e){if(e!==g.default.pattern.id){var t=g.default.patterManager.getPatternById(e);g.default.drive(t).start(),this.setState({currentPatternID:e})}}},{key:"changedFont",value:function(e){if(e.target.checked)_.default.enableFont().catch(function(e){(0,w.default)(e)});else{var t=_.default.getTask();t?t.abort():_.default.disableFont()}}},{key:"handleClickFont",value:function(e){"no"==_.default.getFontEabled()&&(_.default.isStored()||(e.stopPropagation(),e.preventDefault(),this.setState({showLoadFontModal:!0})))}},{key:"confirmDownload",value:function(){this.hideLoadFontModal(),this.refs.sourcehan.click(),(0,w.default)("再次提醒，要中断下载任务，可以刷新页面 或 关闭「加载思源宋体」开关！")}},{key:"hideLoadFontModal",value:function(){this.setState({showLoadFontModal:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.changeLayout,a=t.layout,o=a.font,r=a.fontWeight,l=a.layoutHorizon,i=a.backgroundColor,u=a.revert2white,c=a.showCover,d=t.hide,f=(t.patternChange,t.panel),h=g.default.patterManager.patterns,m=this.state.currentPatternID,y=void 0;h&&(y=h.map(function(e){return s.default.createElement("option",{key:e.id,value:e.id},e.name)}),y=s.default.createElement("dl",{key:"s-pattern"},s.default.createElement("dt",null,"模式"),s.default.createElement("dd",null,s.default.createElement("select",{name:"mode",onChange:function(t){e.handlePatternChange(Number(t.target.value))},defaultValue:m},y))));var b=void 0;return b=f===N.PANEL_OPEN+"layoutSetting"?s.default.createElement(E.default,{style:{backgroundColor:"rgba(255,255,255,.01)"},key:"layoutsetting",onClick:d},s.default.createElement("div",{className:S.settingWrapper,onClick:function(e){return e.stopPropagation(),!1}},s.default.createElement("div",{className:"clearfix"},s.default.createElement("dl",null,s.default.createElement("dt",null,"字体"),s.default.createElement("dd",null,s.default.createElement("select",{value:o,onChange:function(e){n("font",e.target.value)}},s.default.createElement("option",{value:"default"},"默认"),s.default.createElement("option",{value:"simsun"},"宋体"),s.default.createElement("option",{value:"fangsong"},"仿宋"),s.default.createElement("option",{value:"kai"},"楷体")))),s.default.createElement("dl",{key:"s-frontw"},s.default.createElement("dt",null,"字重"),s.default.createElement("dd",null,s.default.createElement("select",{defaultValue:r,onChange:function(e){n("fontWeight",e.target.value)}},s.default.createElement("option",{value:"100"},"100"),s.default.createElement("option",{value:"200"},"200"),s.default.createElement("option",{value:"300"},"300"),s.default.createElement("option",{value:"400"},"400"),s.default.createElement("option",{value:"500"},"500"),s.default.createElement("option",{value:"600"},"600"),s.default.createElement("option",{value:"700"},"700"),s.default.createElement("option",{value:"800"},"800"),s.default.createElement("option",{value:"900"},"900")))),s.default.createElement("dl",{key:"s-frontd"},s.default.createElement("dt",null,"文字方向"),s.default.createElement("dd",null,s.default.createElement("select",{defaultValue:l,onChange:function(e){n("layoutHorizon","true"==e.target.value)}},s.default.createElement("option",{value:"true"},"横向"),s.default.createElement("option",{value:"false"},"竖向")))),s.default.createElement("dl",{key:"s-bgc"},s.default.createElement("dt",null,"页面背景颜色"),s.default.createElement("dd",null,s.default.createElement("input",{type:"color",onChange:function(e){n("backgroundColor",e.target.value)},defaultValue:i}))),s.default.createElement("dl",{key:"s-r2w"},s.default.createElement("dt",null,"使用白色UI"),s.default.createElement("dd",{className:"form"},s.default.createElement("input",{type:"checkbox",hidden:!0,onChange:function(e){n("revert2white",e.target.checked)},id:"id-r2w",defaultChecked:u}),s.default.createElement("label",{htmlFor:"id-r2w"}))),s.default.createElement("dl",{key:"s-cover"},s.default.createElement("dt",null,"隐藏PC导航"),s.default.createElement("dd",{className:"form"},s.default.createElement("input",{type:"checkbox",hidden:!0,onChange:function(e){n("showCover",e.target.checked)},id:"id-cover",defaultChecked:c}),s.default.createElement("label",{htmlFor:"id-cover"}))),s.default.createElement("dl",{key:"s-sh"},s.default.createElement("dt",null,"加载思源宋体"),s.default.createElement("dd",{className:"form"},s.default.createElement("input",{type:"checkbox",hidden:!0,id:"id-sourcehan",ref:"sourcehan",onChange:this.changedFont.bind(this),defaultChecked:"yes"==_.default.getFontEabled()}),s.default.createElement("label",{htmlFor:"id-sourcehan",onClick:this.handleClickFont.bind(this)}))),y))):s.default.createElement("div",{key:"none"}),[s.default.createElement(p.default,{key:"panel",type:C.GLOBAL_ANIMATE_TYPE,ease:["easeOutQuart","easeInOutQuart"]},b),this.state.showLoadFontModal?s.default.createElement(v.default,{key:"modal",exit:this.hideLoadFontModal},s.default.createElement("h3",{className:"color-red"},"注意：下载字体将会消耗24MB的流量！"),s.default.createElement("p",null,"只有这一次下载会消耗24MB的流量，字体下载后，将会缓存到本地，以后将会直接从本地读取。建议电脑用户自行安装思源宋体，然后禁用该选项，这是最好的解决方式。"),s.default.createElement("p",null,"可能出现的现象：进入页面后，页面中间的文字会消失1秒，然后恢复正常；由于字体文件过大，进入展示页面时会卡顿一次。"),s.default.createElement("p",{className:"color-red"},"注意：如果要中断下载，可以刷新页面 或 关闭「加载思源宋体」开关！"),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{role:"exit"},"取消"),s.default.createElement("button",{onClick:this.confirmDownload},"下载思源宋体(24MB)")))):null]}}]),t}(u.Component);P.propTypes={changeLayout:d.default.func.isRequired,layout:d.default.shape({font:d.default.string.isRequired,fontWeight:d.default.string.isRequired,layoutHorizon:d.default.bool.isRequired,backgroundColor:d.default.string.isRequired}),hide:d.default.func.isRequired,panel:d.default.string.isRequired},t.default=(0,f.withRouter)(P)},UA1V:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=(n("F8kA"),n("bFiM")),d=a(c),f=n("YpvI"),h=a(f),p=n("HvcI"),m=(a(p),n("uY+K")),v=(a(m),n("mScD")),y=a(v),E=n("mtXx"),b=(a(E),n("8f34")),g=a(b),k=n("gK+r"),w=a(k),O=n("opgY"),_=a(O),S=g.default.patterManager,N=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=new Map;S.patterns.forEach(function(e){e.sources.forEach(function(e){a.set(e.url,e.name)})});var l=new Map;return S.sources.forEach(function(e){l.set(e.url,e.name)}),n.state={states:null,inPatterns:a,inSources:l,chooseModal:!1},n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){var e=this;y.default.getStates().then(function(t){e.setState({states:t})})}},{key:"clearCache",value:function(e){var t=this;y.default.clearOneSource(e).then(function(n){return y.default.removeSyncRecord(e).then(function(a){(0,h.default)("共删除"+n+"条！","success"),t.setState(function(t){var n=t.states.findIndex(function(t){return t[0]==e});return t.states.splice(n,1),t.inSources.delete(e),t.inPatterns.delete(e),t})})})}},{key:"showChooseModal",value:function(e){this.setState({chooseModal:e})}},{key:"export",value:function(e){var t=new d.default;t.update("准备数据中..."),y.default.exportHitokotos(this.state.chooseModal).then(function(n){return t.update("数据准备完成，格式转换中..."),"txt"==e?new Blob(n.map(function(e){return"\n"+e.id+"\n"+e.hitokoto+"\n"+e.author+" - "+e.source+"\n由 "+e.creator+" 创建于\n"+e.created_at+"\n\n"}),{type:"text/plain"}):"json"==e?new Blob([JSON.stringify(n,null,2)],{type:"application/json"}):void 0}).then(function(n){var a=document.createElement("a");a.href=URL.createObjectURL(n),a.download=(new Date).toLocaleString()+"."+e,a.onclick=function(){URL.revokeObjectURL(n)},a=document.body.appendChild(a),a.click(),t.success("格式转换完成，尝试下载")}).catch(function(e){t.failed("执行失败："+e.message||e)}),this.hideChooseModal()}},{key:"hideChooseModal",value:function(){this.setState({chooseModal:!1})}},{key:"render",value:function(){var e=this,t=void 0,n=this.state,a=n.states,o=n.inPatterns,r=n.inSources;return a?(a=a.slice().sort(function(e,t){return o.has(e[0])+r.has(e[0])-(o.has(t[0])+r.has(t[0]))}),t=a.map(function(t){var n=t[0],a=t[1],l=o.has(n),i=r.has(n),u=void 0;return u=l?o.get(n):i?r.get(n):"已删除的来源",s.default.createElement("li",{key:n},s.default.createElement("div",null,s.default.createElement("h4",{className:l|i?"ellipsis":"color-red ellipsis"},u),s.default.createElement("p",{className:"txt-sm"},"已缓存",a),s.default.createElement("p",{className:"acts"},s.default.createElement("button",{onClick:function(){return e.showChooseModal(n)}},"导出"),s.default.createElement("button",{className:"color-red",onClick:e.clearCache.bind(e,n)},"全部清除"))))})):t=s.default.createElement("li",{key:"loading"},s.default.createElement("div",null,s.default.createElement("h1",null,s.default.createElement("i",{className:"iconfont icon-loading-anim"}),"载入中"))),a&&0==a.length&&(t=s.default.createElement("li",{key:"zero"},s.default.createElement("div",null,s.default.createElement("h1",{className:"color-red"},s.default.createElement("i",{className:"iconfont icon-tishi"}),"非常干净！"),s.default.createElement("p",null,"当前没有使用IndexedDB缓存数据")))),s.default.createElement(w.default,{cardname:"缓存清理"},s.default.createElement("div",{className:"lum-list "},s.default.createElement("ul",null,t)),this.state.chooseModal?s.default.createElement(_.default,{exit:function(){return e.hideChooseModal()}},s.default.createElement("h1",null,"请选择导出的类型："),s.default.createElement("p",null,s.default.createElement("button",{onClick:function(){return e.export("txt")}},"纯文本"),s.default.createElement("button",{onClick:function(){return e.export("json")}},"JSON"))):null)}}]),t}(u.Component);t.default=N},UluS:function(e,t){e.exports={timerbox:"_11eYIUAWOAEtioc5lo0oCz",countBox:"_3deGVrzDNYCWBmA4-TbeKu"}},"WC+y":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=(n("F8kA"),n("bFiM")),d=a(c),f=n("YpvI"),h=a(f),p=n("HvcI"),m=a(p),v=n("uY+K"),y=a(v),E=n("mScD"),b=a(E),g=n("mtXx"),k=a(g),w=n("8f34"),O=a(w),_=n("gK+r"),S=a(_),N=O.default.patterManager,C=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={swSupported:null,localLength:null,syncLength:N.sources.map(function(){return"loading"}),syncRecord:null,working:!1,isUnmounted:!1},n}return l(t,e),i(t,[{key:"componentWillUnmount",value:function(){this.setState({isUnmounted:!0})}},{key:"componentWillMount",value:function(){var e=this;this.setState(function(e){return"serviceWorker"in navigator&&(e.swSupported=!0),k.default.online,e}),Promise.all(N.sources.map(function(e){return b.default.getHitokotoCount(e.url)})).then(function(t){e.state.isUnmounted||e.setState({localLength:t})}),Promise.all(N.sources.map(function(e){return b.default.getSyncRecord(e.url)})).then(function(t){e.state.isUnmounted||e.setState({syncRecord:t})}),N.sources.map(function(t,n){return y.default.API_sync(t.url).catch(function(e){return(0,h.default)("同步功能检测失败！\n来源名："+t.name+"\nURL:"+t.url,"error",!0),{}}).then(function(e){return e.sync}).then(function(t){e.state.isUnmounted||e.setState(function(e){return e.syncLength[n]=t,e})})})}},{key:"refreshOneSource",value:function(e){var t=this,n=N.sources[e].url;this.state.isUnmounted||this.setState({working:!1}),b.default.getHitokotoCount(n).then(function(n){t.state.isUnmounted||t.setState(function(t){t.localLength[e]=n})}),b.default.getSyncRecord(n).then(function(n){t.state.isUnmounted||t.setState(function(t){return t.syncRecord[e]=n,t})}),y.default.API_sync(n).catch(function(t){return(0,h.default)("同步功能检测失败！\n来源名："+N.sources[e].name+"\nURL:"+n,"error",!0),{}}).then(function(e){return e.sync}).then(function(n){t.state.isUnmounted||t.setState(function(t){return t.syncLength[e]=n,t})})}},{key:"syncOne",value:function(e){var t=this;this.setState({working:!0});var n=new d.default;n.update("开始缓存任务！");var a=N.sources[e],o=(this.state.localLength[e],this.state.syncLength[e],this.state.syncRecord[e]),r=a.url,l=void 0,i=0;l=o&&"empty"!=o.lastCursor?o.lastCursor:"empty";(function e(t,a){return y.default.API_sync(t,{cursor:a}).then(function(o){var r=o.data,l=o.limit,u=r.length,s=u==l;return u>0&&(a=r[u-1]._id),i+=u,b.default.putHitokotoBulk(t,r).then(function(e){return b.default.putSyncRecord(t,{lastTime:new Date,lastCursor:a})}).then(function(o){if(n.update("已缓存:"+i+"条..."),s)return e(t,a)})})})(r,l).catch(function(e){n.failed("同步失败！")}).then(function(){0==i?(0,h.default)("同步了0条记录，可能的原因：\n1.用户将以前的句子删除了\n2.用户将以前的句子设置为私密\n3.如果开启审核机制，用户修改了句子，那么句子将处于审核状态\n4.遇到了bug","error",!0):n.success("同步了"+i+"条记录！"),t.refreshOneSource(e)})}},{key:"render",value:function(){var e=this,t=void 0,n=this.state,a=n.localLength,o=n.syncLength,r=n.syncRecord,l=n.working;return a?a&&(t=N.sources.map(function(t,n){var i=o[n];if("loading"==i)return s.default.createElement("li",{key:t.id},s.default.createElement("div",null,s.default.createElement("h4",null,t.name),s.default.createElement("p",{className:"txt-sm"},"已缓存",a[n],"/",s.default.createElement("i",{className:"iconfont icon-loading-anim"}),"检测同步功能中"),s.default.createElement("p",{className:"acts"},s.default.createElement("button",{className:"disabled"},"等待检测完毕...."))));if(void 0===i)return s.default.createElement("li",{key:t.id},s.default.createElement("div",null,s.default.createElement("h4",null,t.name),s.default.createElement("p",{className:"txt-sm"},"已缓存",a[n],"/",s.default.createElement("span",{className:"color-red"},"不支持同步")),s.default.createElement("p",{className:"acts"},s.default.createElement("button",{className:"disabled"},"暂不支持"))));var u=a[n],c=o[n],d=void 0;return r?(d=r[n],u>=c||0==c?s.default.createElement("li",{key:t.id},s.default.createElement("div",null,s.default.createElement("h4",null,t.name),s.default.createElement("p",{className:"txt-sm"},"已缓存",u,"/",c," ",d?" - 上次同步于"+(0,m.default)(d.lastTime):null),s.default.createElement("p",{className:"acts"},s.default.createElement("button",{className:"disabled"},"无需同步")))):s.default.createElement("li",{key:t.id},s.default.createElement("div",null,s.default.createElement("h4",null,t.name,s.default.createElement("span",{className:"new-info"},"可更新",c-u)),s.default.createElement("p",{className:"txt-sm"},"已缓存",u,"/",c,d?" - 上次同步于"+(0,m.default)(d.lastTime):null),s.default.createElement("p",{className:"acts"},l?s.default.createElement("button",{className:"disabled"},s.default.createElement("i",{className:"iconfont icon-loading-anim"}),"同步中"):s.default.createElement("button",{onClick:e.syncOne.bind(e,n)},"同步"))))):s.default.createElement("li",{key:t.id},s.default.createElement("div",null,s.default.createElement("h4",null,t.name),s.default.createElement("p",{className:"txt-sm"},"已缓存",u,"/",c),s.default.createElement("p",{className:"acts"},s.default.createElement("button",{className:"disabled"},"获取同步历史记录中...."))))})):t=N.sources.map(function(e,t){return s.default.createElement("li",{key:e.id},s.default.createElement("div",null,s.default.createElement("h4",null,e.name),s.default.createElement("p",{className:"txt-sm"},s.default.createElement("i",{className:"iconfont icon-loading-anim"}),"载入中"),s.default.createElement("p",{className:"acts"},s.default.createElement("button",{className:"disabled"},"载入中...."))))}),s.default.createElement(S.default,{cardname:"离线缓存"},s.default.createElement("div",{className:"lum-list "},s.default.createElement("ul",null,t)))}}]),t}(u.Component);t.default=C},WoSU:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("O27J"),d=a(c),f=n("F8kA"),h=n("gK+r"),p=a(h),m=n("f7Do"),v=a(m),y=n("uY+K"),E=a(y),b=n("YpvI"),g=a(b),k=n("mScD"),w=a(k),O=n("LCwm"),_=a(O),S=n("eUtn"),N=a(S),C=n("+S9/"),P=a(C),T=n("9jXU"),I=a(T),R=n("a0hn"),A=a(R),x=(n("z55N"),function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={inited:!1,error:null,currentPage:1,totalPages:0,publicHitokotos:[],favorites:[],userProfile:{},isUnmouted:!1},n.getAllPublicHitokotos=n.getAllPublicHitokotos.bind(n),n.addToFavorite=n.addToFavorite.bind(n),n.removeFromRavorite=n.removeFromRavorite.bind(n),n.getExploreComp=n.getExploreComp.bind(n),n.getExploreUserComp=n.getExploreUserComp.bind(n),n.getExploreUserCollectComp=n.getExploreUserCollectComp.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){this.getAllPublicHitokotos()}},{key:"componentWillUnmount",value:function(){this.setState({isUnmouted:!0})}},{key:"getAllPublicHitokotos",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=d.default.findDOMNode(this);n&&(n.scrollIntoView?n.firstElementChild.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}):n.scrollTop=0),this.setState({inited:!1}),E.default.API_getAllPublicHitokotos(t,10).then(function(t){e.setState({inited:!0,error:null,totalPages:t.total,currentPage:t.current,publicHitokotos:t.hitokotos,favorites:new Array(t.hitokotos)}),t.hitokotos.map(function(t,n){w.default.isInFavorite(t).then(function(t){t?e.setState(function(e){return e.favorites[n]=!0,e}):e.setState(function(e){return e.favorites[n]=!1,e})})})}).catch(function(t){e.setState({error:t.message||t||"获取失败",inited:!1}),(0,g.default)("获取所有公开数据失败","error")})}},{key:"uidByName",value:function(e){for(var t=void 0,n=this.state.publicHitokotos,a=0;a<n.length;a++)if(n[a].creator===e){t=n[a].creator_id;break}return t}},{key:"addToFavorite",value:function(e){var t=this,n=e.target.getAttribute("data-index");w.default.addToFavorite(this.state.publicHitokotos[n]).then(function(e){t.setState(function(e){return(0,g.default)("加入收藏成功！","success"),e.favorites[n]=!0,e})})}},{key:"removeFromRavorite",value:function(e){var t=this,n=e.target.getAttribute("data-index");w.default.removeFromFavorite(this.state.publicHitokotos[n]).then(function(e){t.setState(function(e){return(0,g.default)("取消收藏成功！","info"),e.favorites[n]=!1,e})})}},{key:"getExploreComp",value:function(){var e=this;return s.default.createElement("div",{className:"hitokoto-list"},s.default.createElement(v.default,{ease:"easeOutQuart",animConfig:[{opacity:[1,0]},{left:"0",right:"0",position:"absolute",opacity:[1,0]}]},this.state.inited?null:s.default.createElement(A.default,{error:this.state.error,retry:function(){return e.getAllPublicHitokotos(e.state.currentPage)},key:"loading"}),s.default.createElement("div",{className:"view"},this.state.publicHitokotos.map(function(t,n){return s.default.createElement(I.default,{data:t,key:t.id},e.state.favorites[n]?s.default.createElement("a",{href:"javascript:"},s.default.createElement("i",{className:"iconfont icon-favorfill",title:"已收藏","data-index":n,onClick:e.removeFromRavorite})):s.default.createElement("a",{href:"javascript:"},s.default.createElement("i",{className:"iconfont icon-favor",title:"点击加入收藏","data-index":n,onClick:e.addToFavorite})))}))),s.default.createElement(P.default,{current:this.state.currentPage||1,total:this.state.totalPages||1,limit:10,func:this.getAllPublicHitokotos}))}},{key:"getExploreUserComp",value:function(e){var t=e.match.params.user;return s.default.createElement(_.default,{userName:t,uid:this.uidByName(t)||window.trickyUid})}},{key:"getExploreUserCollectComp",value:function(e){var t=e.match.params,n=t.user,a=t.collection;return s.default.createElement(N.default,{collectionName:a,uid:this.uidByName(n)||window.trickyUid})}},{key:"render",value:function(){return s.default.createElement(p.default,{cardname:"探索"},s.default.createElement(f.Switch,null,s.default.createElement(f.Route,{exact:!0,path:"/explore",render:this.getExploreComp}),s.default.createElement(f.Route,{exact:!0,path:"/explore/:user",render:this.getExploreUserComp}),s.default.createElement(f.Route,{exact:!0,path:"/explore/:user/:collection",render:this.getExploreUserCollectComp})))}}]),t}(u.Component));t.default=x},X5W0:function(e,t){e.exports={wrapper:"_2tXucMM7cZFQ1lsCADeViJ"}},Xd3r:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n("GiK3"),c=a(s),d=n("KSGD"),f=a(d),h=(n("F8kA"),n("f7Do")),p=a(h),m=n("dtTU"),v=a(m),y=n("YpvI"),E=a(y),b=n("uY+K"),g=a(b),k=n("YRpt"),w=a(k),O=n("EjY7"),_=n("z55N"),S=n("oHpa"),N=a(S),C=function(e){function t(e){r(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={username:void 0,password:void 0,password2:void 0,showPasswordDiff:!1,passwordBlur:0,email:void 0,emailBlur:0,nickname:void 0,errinfo:void 0,code:null,step:1,user:{}},n.handleUsernameChange=n.handleUsernameChange.bind(n),n.handlePasswordBlur=n.handlePasswordBlur.bind(n),n.handlePasswordChange=n.handlePasswordChange.bind(n),n.handlePassword2Change=n.handlePassword2Change.bind(n),n.handleEmailBlur=n.handleEmailBlur.bind(n),n.handleEmailChange=n.handleEmailChange.bind(n),n.handleNicknameChange=n.handleNicknameChange.bind(n),n.handleRegist=n.handleRegist.bind(n),n.handleCodeChange=n.handleCodeChange.bind(n),n.handleCodeBlur=n.handleCodeBlur.bind(n),n.handleRegist2=n.handleRegist2.bind(n),n}return i(t,e),u(t,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordBlur",value:function(){var e=this.state,t=e.password,n=e.password2;void 0!==t&&void 0!==n&&(this.setState({showPasswordDiff:!0}),this.validatePassword())}},{key:"handlePasswordChange",value:function(e){var t=e.target.value;this.setState({password:t}),this.state.showPasswordDiff&&this.validatePassword(t,this.state.password2)}},{key:"handlePassword2Change",value:function(e){var t=e.target.value;this.setState({password2:t}),this.state.showPasswordDiff&&this.validatePassword(this.state.password,t)}},{key:"validatePassword",value:function(e,t){return e||(e=this.state.password),t||(t=this.state.password2),void 0===e||void 0===t?(this.setState({errinfo:"密码不能为空！\n若不能输入中文，可以复制粘贴。"}),!1):0==e.trim().length||0==t.trim().length?(this.setState({errinfo:"密码不能为空！\n若不能输入中文，可以复制粘贴。"}),!1):e!=t?(this.setState({errinfo:"两次密码不一致！\n若不能输入中文，可以复制粘贴。"}),!1):(this.setState({errinfo:""}),!0)}},{key:"handleNicknameChange",value:function(e){this.setState({nickname:e.target.value})}},{key:"handleEmailBlur",value:function(){this.validateEmail()}},{key:"handleEmailChange",value:function(e){var t=e.target.value;this.setState({email:t})}},{key:"validateEmail",value:function(e){return e||(e=this.state.email),/^[a-z0-9]+([\.\_\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/.test(e)?(this.setState({errinfo:void 0}),!0):(this.setState({errinfo:"请输入正确的邮箱"}),!1)}},{key:"handleCodeBlur",value:function(){this.validateCode()}},{key:"validateCode",value:function(e){return e||(e=this.state.code),/^[a-z0-9]{4}$/.test(e)?(this.setState({errinfo:void 0}),!0):(this.setState({errinfo:"请输入正确的验证码"}),!1)}},{key:"handleCodeChange",value:function(e){var t=e.target.value.toLowerCase();this.setState({code:t})}},{key:"handleRegist",value:function(){var e=this,t=this.state,n=t.username,a=t.password,o=(t.password2,t.email),r=t.nickname;if(void 0===n)return void this.setState({errinfo:"用户名不能为空！\n用户名至少7位任意字符，包括中文!"});if(0==n.trim().length)return void this.setState({errinfo:"用户名不能为空！\n用户名至少7位任意字符，包括中文!"});if(n.length<7&&this.setState({errinfo:"用户名过短！\n至少要7位任意字符，包括中文。"}),this.validatePassword()&&this.validateEmail()){this.setState({errinfo:void 0});var l=(0,v.default)(n),i=(0,v.default)(a);this.setState({user:{username:l,password:i,email:o,nickname:r}}),g.default.API_regist({username:l,password:i,email:o,nickname:r}).then(function(t){(0,E.default)(t.message,"success"),e.setState({step:2})})}}},{key:"handleRegist2",value:function(){var e=this,t=this.state.code,n=this.state.user,a=n.username,o=n.password,r=n.email,l=n.nickname;this.validateCode()&&g.default.API_regist({code:t,username:a,password:o,email:r,nickname:l}).then(function(t){(0,E.default)(t.message,"success",!0),e.props.registDone(t),e.setState({username:void 0,password:void 0,password2:void 0,showPasswordDiff:!1,email:void 0,nickname:void 0,errinfo:void 0,code:null,step:1}),e.props.hideRegist()})}},{key:"render",value:function(){var e=this,t="";this.state.errinfo&&(t=c.default.createElement("p",null,c.default.createElement("span",{style:{display:"inline-block",margin:"5px",padding:"14px 15px",backgroundColor:" #ffd9ea",border:"solid 1px pink",borderRadius:"4px",width:"200px",whiteSpace:"pre-line"}},this.state.errinfo)));var n=this.props,a=n.panel,r=(n.showLogin,n.hideRegist,void 0);return r=a===O.PANEL_OPEN+"regist"?1==this.state.step?c.default.createElement(w.default,o({key:"regist-step1",style:{backgroundColor:"transparent"},onClick:this.props.hideRegist},"key","step1"),c.default.createElement("div",{className:N.default["login-box"],onClick:function(e){return e.stopPropagation(),!1}},c.default.createElement("h1",null,"注册"),c.default.createElement("div",{className:"text-filed"},c.default.createElement("input",{type:"text",required:!0,onChange:this.handleUsernameChange,defaultValue:this.state.username}),c.default.createElement("label",{"data-content":"用户名(仅登录时使用)"},"用户名(仅登录时使用)")),c.default.createElement("div",{className:"text-filed"},c.default.createElement("input",{type:"password",required:!0,onChange:this.handlePasswordChange,onBlur:this.handlePasswordBlur,defaultValue:this.state.password}),c.default.createElement("label",{"data-content":"密码(任意字符至少七位)"},"密码")),c.default.createElement("div",{className:"text-filed"},c.default.createElement("input",{type:"password",required:!0,onBlur:this.handlePasswordBlur,onChange:this.handlePassword2Change,defaultValue:this.state.password2}),c.default.createElement("label",{"data-content":"请再次确认您的密码"},"请再次确认您的密码")),c.default.createElement("div",{className:"text-filed"},c.default.createElement("input",{type:"text",required:!0,onChange:this.handleEmailChange,onBlur:this.handleEmailBlur,defaultValue:this.state.email}),c.default.createElement("label",{"data-content":"验证邮箱(非常重要)"},"验证邮箱(非常重要)")),c.default.createElement("div",{className:"text-filed"},c.default.createElement("input",{type:"text",required:!0,maxLength:"20",onChange:this.handleNicknameChange,defaultValue:this.state.nickname}),c.default.createElement("label",{"data-content":"显示的昵称(不可修改)"},"显示的昵称(不可修改)")),t,c.default.createElement("p",null,c.default.createElement("br",null),c.default.createElement("button",{onClick:this.handleRegist},"下一步"),c.default.createElement("button",{onClick:this.props.showLogin},"前往登录")),c.default.createElement("p",null,c.default.createElement("br",null),c.default.createElement("button",{href:"javascript:",onClick:this.props.hideRegist},"关闭")))):c.default.createElement(w.default,o({key:"regist-step2",style:{backgroundColor:"transparent"}},"key","step2"),c.default.createElement("div",{className:N.default["login-box"]},c.default.createElement("h1",null,"请输入您收到的验证码"),c.default.createElement("p",null,c.default.createElement("div",{className:"text-filed"},c.default.createElement("input",{type:"text",required:!0,maxLength:"4",onBlur:this.handleCodeBlur,onChange:this.handleCodeChange}),c.default.createElement("label",{"data-content":"验证码"},"验证码"))),t,c.default.createElement("p",null,"没有收到验证码？",c.default.createElement("button",{onClick:this.handleRegist},"重新发送")),c.default.createElement("p",null,c.default.createElement("br",null),c.default.createElement("button",{onClick:function(t){e.setState({step:1,errinfo:void 0})}},"上一步")," ",c.default.createElement("button",{onClick:this.handleRegist2},"立即注册")))):c.default.createElement("div",{key:"none"}),c.default.createElement(p.default,{type:_.GLOBAL_ANIMATE_TYPE,ease:["easeOutQuart","easeInOutQuart"]},r)}}]),t}(s.Component);C.propTypes={registDone:f.default.func.isRequired,showLogin:f.default.func.isRequired,hideRegist:f.default.func.isRequired,panel:f.default.string.isRequired},t.default=C},YRpt:function(e,t,n){"use strict";function a(e){var t=e.style,n=e.onClick,a=Object.assign({position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",zIndex:"500",overflow:"auto",backgroundColor:"white"},t);return r.default.createElement("div",{style:a,onClick:n},e.children)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var o=n("GiK3"),r=function(e){return e&&e.__esModule?e:{default:e}}(o)},YXrc:function(e,t){e.exports={CardContainer:"_znoYXFz1VOmfgW8jsBVU",Card:"_11f6MaDNUaqQzkcYKiitjx","Card--change":"_2Gz9xG671grTFb380c08gn",Card_content:"_1ioGf12YLBtRyxkaVxeQRC",Card_options:"_2UGDpWzQQfwJvDIa3hDUX0",hide:"_3Y7P-dzQrWmrgWF3xliHDm",HitoCollection:"HJzEEZ8jcHnKpNgucRR70",newone:"_3aQrj2vcMElN7XWthR5Vjn"}},YpvI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("cS16"),o=function(e){return e&&e.__esModule?e:{default:e}}(a),r=n("EjY7");t.default=function(){return o.default.dispatch(r.sendNotification.apply(void 0,arguments))}},ZRDb:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(){var e=localStorage.getItem(E);return e&&"undefined"!=e?JSON.parse(e):b}function u(e){localStorage.setItem(E,JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n("GiK3"),d=a(c),f=n("KSGD"),h=(a(f),n("f7Do")),p=(a(h),n("8f34")),m=a(p),v=n("evxO"),y=a(v),E="instantHitokoto",b={creator:"Tao.Da",from:"张嘉佳 从你的全世界路过",hitokoto:"在季节的车上，如果你要提前下车，请别推醒装睡的我，这样我可以沉睡到终点，假装不知道你已经离开。",id:"1995",type:"origin"},g=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=i();return n.state={instant:a,hitokoto:null,processing:!1,direction:"next",lastCount:1,nextCount:5},n.handleLast=n.handleLast.bind(n),n.handleNext=n.handleNext.bind(n),m.default.initRollback(a).registNextHitokotoHandler(n.nextHitokotoHandler.bind(n)).registLastHitokotoHandler(n.lastHitokotoHandler.bind(n)).registUIProcessingHandler(n.processingHandler.bind(n)).start(),n}return l(t,e),s(t,[{key:"componentDidMount",value:function(){console.log("componentDidMount start hitokoto"),m.default.start()}},{key:"componentWillUnmount",value:function(){m.default.registNextHitokotoHandler(Function.prototype).registLastHitokotoHandler(Function.prototype).registUIProcessingHandler(Function.prototype).stop()}},{key:"processingHandler",value:function(e){this.setState({processing:e})}},{key:"nextHitokotoHandler",value:function(e,t){var n=t.lastCount,a=t.nextCount;this.setState({hitokoto:e,direction:"next",lastCount:n,nextCount:a}),u(e)}},{key:"lastHitokotoHandler",value:function(e,t){var n=t.lastCount,a=t.nextCount;this.setState({hitokoto:e,direction:"back",lastCount:n,nextCount:a})}},{key:"handleNext",value:function(){this.state.processing||m.default.next()}},{key:"handleLast",value:function(){m.default.last()}},{key:"render",value:function(){var e=this.state.hitokoto||this.state.instant;return d.default.createElement(y.default,{hitokoto:e,callbacks:{handleNext:this.handleNext,handleLast:this.handleLast},direction:this.state.direction,lastCount:this.state.lastCount,nextCount:this.state.nextCount,processing:this.state.processing})}}]),t}(c.Component);t.default=g},a0hn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("GiK3"),o=function(e){return e&&e.__esModule?e:{default:e}}(a),r=n("spEe");t.default=function(e){var t=e.inited,n=e.error,a=e.retry;return t?null:n?o.default.createElement("div",{className:r.loading},o.default.createElement("h1",{className:"color-red"},o.default.createElement("i",{className:"iconfont icon-error-message"}," 哦豁....")),o.default.createElement("p",null,"似乎出了点状况",o.default.createElement("button",{onClick:a},"重试"))):o.default.createElement("div",{className:r.loading},o.default.createElement("h1",null,o.default.createElement("i",{className:"iconfont icon-loading-anim"})),o.default.createElement("p",null,"Loading..."))}},aDbo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("GiK3"),o=function(e){return e&&e.__esModule?e:{default:e}}(a),r=n("d6mP"),l=function(e){switch(e){case"info":return r.info;case"success":return r.success;case"error":return r.error;default:return r.info}};t.default=function(e){var t=e.data,n=e.remove,a=t.interactive?o.default.createElement("div",{className:r.actions,onClick:function(){return n(t.id)}},o.default.createElement("i",{className:"iconfont icon-roundclose icon-paceholder"})):o.default.createElement("div",{className:r.actions},o.default.createElement("i",{className:"iconfont icon-loading-anim icon-paceholder"}));"task"==t.type&&(a=null);var i=void 0;switch(t.type){case"success":i=o.default.createElement("div",{className:"pull-left"},o.default.createElement("i",{className:"iconfont icon-check icon-paceholder"}));break;case"error":i=o.default.createElement("div",{className:"pull-left"},o.default.createElement("i",{className:"iconfont icon-error-message icon-paceholder"}));break;case"task":i=o.default.createElement("div",{className:"pull-left"},o.default.createElement("i",{className:"iconfont icon-loading-anim icon-paceholder"}));break;case"info":default:i=o.default.createElement("div",{className:"pull-left"},o.default.createElement("i",{className:"iconfont icon-info icon-paceholder"}))}var u=t.detail?o.default.createElement("div",null,"详情"):null;return[o.default.createElement("div",{key:t.id,className:r.NWrapper,onClick:t.interactive||"task"==t.type?null:function(){return n(t.id)}},o.default.createElement("div",{className:r.notification+" clearfix "+l(t.type)},a,i,o.default.createElement("div",{className:r.content},o.default.createElement("span",null,t.msg),u))),o.default.createElement("br",{key:"br"+t.id})]}},akvE:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}n("C42Q"),n("O2pb"),n("sIQx"),n("j/K4"),n("cUYv"),n("wg8Y"),n("7N90"),n("/Ife");var o=n("GiK3"),r=a(o),l=n("O27J"),i=n("iDSo"),u=a(i),s=n("t8iB"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),d=n("YpvI"),f=a(d);c.install({onInstalled:function(){return(0,f.default)("应用安装完成！您已可以在离线时使用。","success",!0)},onUpdating:function(){return(0,f.default)("新版本下载中....","info",!1,5)},onUpdateReady:function(){return c.applyUpdate()},onUpdateFailed:function(){return(0,f.default)("更新失败！","error","error")},onUpdated:function(){window.swUpdate=!0}}),(0,l.render)(r.default.createElement(u.default,null),document.getElementById("root"))},bEzl:function(e,t,n){"use strict";function a(e){return function(t){var n=t.dispatch,a=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,a,e):t(o)}}}}Object.defineProperty(t,"__esModule",{value:!0});var o=a();o.withExtraArgument=a,t.default=o},bFiM:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n("cS16"),l=function(e){return e&&e.__esModule?e:{default:e}}(r),i=n("EjY7"),u=function(){function e(){a(this,e),this.id=""+(new Date).getTime()+Math.random()}return o(e,[{key:"update",value:function(e){l.default.dispatch((0,i.updateTask)(this.id,e))}},{key:"success",value:function(e){l.default.dispatch((0,i.updateTask)(this.id,e,!0))}},{key:"failed",value:function(e){l.default.dispatch((0,i.updateTask)(this.id,e,!1))}},{key:"remove",value:function(){l.default.dispatch((0,i.removeTask)(this.id))}}]),e}();t.default=u},bU7B:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=(n("F8kA"),n("uY+K")),d=a(c),f=n("dtTU"),h=a(f),p=n("YpvI"),m=a(p),v=n("gK+r"),y=a(v),E=n("3CI+"),b=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={email:0,emailDelay:0,password:0,useremail:"*****"},n.sendOldCode=n.sendOldCode.bind(n),n.verifyOldCode=n.verifyOldCode.bind(n),n.sendNewEmailCode=n.sendNewEmailCode.bind(n),n.verifyNewEmailCode=n.verifyNewEmailCode.bind(n),n.updatePassword=n.updatePassword.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){this.getUserEmail()}},{key:"getUserEmail",value:function(){var e=this;d.default.API_getUserEmail().then(function(t){e.setState({useremail:t.email})})}},{key:"sendOldCode",value:function(){var e=this;d.default.API_sendOldEmailCode().then(function(t){(0,m.default)(t.message,"success"),e.setState({email:1,emailDelay:59});var n=setInterval(function(){0!=e.state.emailDelay?e.setState(function(e){return e.emailDelay-=1,e}):clearInterval(n)},1e3)})}},{key:"verifyOldCode",value:function(){var e=this;d.default.API_verifyOldEmailCode(this.refs.oldemailcode.value.trim()).then(function(t){(0,m.default)(t.message),e.setState({email:2,emailDelay:0})})}},{key:"sendNewEmailCode",value:function(){var e=this,t=this.refs.newemail.value.trim();if(!/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/.test(t))return void(0,m.default)("请输入正确的邮箱！","error");d.default.API_sendNewEmailCode(t).then(function(t){(0,m.default)(t.message),e.setState({email:3,emailDelay:59});var n=setInterval(function(){0!=e.state.emailDelay?e.setState(function(e){return e.emailDelay-=1,e}):clearInterval(n)},1e3)})}},{key:"verifyNewEmailCode",value:function(){var e=this,t=this.refs.newemail.value.trim(),n=this.refs.newemailcode.value.trim();d.default.API_verifyNewEmailCode(t,n).then(function(t){(0,m.default)(t.message),e.setState({email:0,emailDelay:0}),e.getUserEmail()})}},{key:"updatePassword",value:function(){var e=this,t=this.refs.originpass.value,n=this.refs.newpass.value,a=this.refs.newpasscheck.value;return 0==t.trim().length?void(0,m.default)("原密码不能为空！\n若不能输入中文，可以复制粘贴。","error"):0==n.trim().length?void(0,m.default)("密码不能为空！\n若不能输入中文，可以复制粘贴。","error"):a!=n?void(0,m.default)("两次密码不一致！\n若不能输入中文，可以复制粘贴。","error"):void d.default.API_updatePassword((0,h.default)(t),(0,h.default)(n)).then(function(t){(0,m.default)(t.message),e.refs.originpass.value="",e.refs.newpass.value="",e.refs.newpasscheck.value=""})}},{key:"render",value:function(){var e=this,t=this.props,n=(t.path,t.location,t.user),a=this.state;return s.default.createElement(y.default,{cardname:"账号设置"},s.default.createElement("div",{className:"form"},s.default.createElement("div",{className:E.mb20},s.default.createElement("h4",null,"基本信息"),s.default.createElement("hr",null),s.default.createElement("label",{htmlFor:""},"昵称(暂不开放修改)："),s.default.createElement("span",null,n.nickname)),s.default.createElement("div",{className:E.mb20},s.default.createElement("h4",null,"修改验证邮箱"),s.default.createElement("hr",null),s.default.createElement("label",{htmlFor:""},"原验证邮箱:"),a.useremail,s.default.createElement("br",null),s.default.createElement("i",{className:"iconfont icon-tishi"}),s.default.createElement("small",null,"若无法接收验证邮件，请联系网站管理员"),s.default.createElement("br",null),s.default.createElement("div",{className:0==a.email?"":"hide"},s.default.createElement("button",{onClick:this.sendOldCode,className:0==a.emailDelay?"":"disabled"},"发送验证码")),s.default.createElement("div",{className:1==a.email?"":"hide"},s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"text",ref:"oldemailcode",required:!0}),s.default.createElement("label",{"data-content":"请输入您收到的验证码"},"请输入您收到的验证码")),s.default.createElement("br",null),s.default.createElement("button",{onClick:this.verifyOldCode},"立即验证")," ",s.default.createElement("button",{onClick:this.sendOldCode,className:0==a.emailDelay?"":"disabled"},"重新发送验证码",0==a.emailDelay?"":"("+a.emailDelay+")")),s.default.createElement("div",{className:2==a.email?"":"hide"},s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"text",ref:"newemail",required:!0}),s.default.createElement("label",{"data-content":"请输入新的验证邮箱"},"请输入新的验证邮箱")),s.default.createElement("br",null),s.default.createElement("button",{onClick:this.sendNewEmailCode,className:0==a.emailDelay?"":"disabled"},"发送新邮箱验证码",0==a.emailDelay?"":"("+a.emailDelay+")")),s.default.createElement("div",{className:3==a.email?"":"hide"},s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"text",ref:"newemailcode",required:!0}),s.default.createElement("label",{"data-content":"确认新邮箱收到的验证码"},"确认新邮箱收到的验证码")),s.default.createElement("br",null),s.default.createElement("button",{onClick:function(){e.setState({email:2})}},"上一步"),s.default.createElement("button",{onClick:this.verifyNewEmailCode},"完成验证"),s.default.createElement("button",{onClick:this.sendNewEmailCode,className:0==a.emailDelay?"":"disabled"},"重新发送验证码",0==a.emailDelay?"":"("+a.emailDelay+")"))),s.default.createElement("div",{className:E.mb20},s.default.createElement("h4",null,"修改密码"),s.default.createElement("hr",null),s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"password",ref:"originpass",required:!0}),s.default.createElement("label",{"data-content":"原密码"},"原密码")),s.default.createElement("br",null),s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"password",ref:"newpass",required:!0}),s.default.createElement("label",{"data-content":"新密码"},"新密码")),s.default.createElement("br",null),s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"password",ref:"newpasscheck",required:!0}),s.default.createElement("label",{"data-content":"再次确认新密码"},"再次确认新密码")),s.default.createElement("br",null),s.default.createElement("div",null,s.default.createElement("button",{onClick:this.updatePassword},"确认修改密码")))))}}]),t}(u.Component);t.default=b},bvS8:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("f7Do"),d=(a(c),n("z55N"),n("8f34")),f=a(d),h=n("EjY7"),p=n("cS16"),m=a(p),v=n("gK+r"),y=a(v),E=n("qTPi"),b=(a(E),n("opgY")),g=a(b),k=f.default.patterManager,w=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={deleteSourceModal:null},n.showDeleteModal=n.showDeleteModal.bind(n),n.hideDeleteModal=n.hideDeleteModal.bind(n),n.handleDeleteSource=n.handleDeleteSource.bind(n),n}return l(t,e),i(t,[{key:"showDeleteModal",value:function(e){this.setState({deleteSourceModal:e})}},{key:"hideDeleteModal",value:function(){this.setState({deleteSourceModal:null})}},{key:"handleDeleteSource",value:function(){var e=this.state.deleteSourceModal,t=f.default.patterManager.deleteSource(e);m.default.dispatch((0,h.removeOneSource)(t)),this.hideDeleteModal(),this.forceUpdate()}},{key:"render",value:function(){var e=this,t=k.sources.map(function(t){return s.default.createElement("li",{key:t.id},s.default.createElement("div",null,s.default.createElement("h4",{className:"ellipsis"},t.name),s.default.createElement("p",{className:"ellipsis txt-sm"},s.default.createElement("span",null,t.url)),s.default.createElement("p",{className:"acts"},s.default.createElement("button",{onClick:function(){return e.props.history.push(e.props.location.pathname+"/"+t.id+"/update")}},"修改"),s.default.createElement("button",{className:"color-red",onClick:function(n){e.showDeleteModal(t.id)}},"删除"))))});return s.default.createElement(y.default,{cardname:"来源管理"},s.default.createElement("p",null,s.default.createElement("i",{className:"iconfont icon-tishi"}),"在这里新增其他域名下的hitokoto一言接口，然后在「模式管理」中使用哦~"),s.default.createElement("div",{className:"lum-list "},s.default.createElement("ul",null,t,s.default.createElement("li",{key:"new"},s.default.createElement("div",{className:"pointer"},s.default.createElement("h3",{href:"javascript:",onClick:function(){return e.props.history.push(e.props.location.pathname+"/new")}},s.default.createElement("i",{className:"iconfont icon-add"})," 新增"))))),this.state.deleteSourceModal?s.default.createElement(g.default,{exit:this.hideDeleteModal},s.default.createElement("h1",null,"你确定要删除该来源?"),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{role:"exit"},"取消"),s.default.createElement("button",{onClick:this.handleDeleteSource},"确定")))):null)}}]),t}(u.Component);t.default=w},cS16:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("2KeS"),r=n("bEzl"),l=a(r),i=n("6RZU"),u=a(i),s=void 0,c=void 0;s=[l.default];var d=o.applyMiddleware.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(s))(o.createStore);c=function(e){return d(u.default,e)}(),t.default=c;String,String,String,Number,Object,String,Boolean,Number,Number,Boolean,Array},cgPw:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("O27J"),d=(a(c),n("f7Do")),f=a(d),h=n("Vgyu"),p=a(h),m=n("uY+K"),v=a(m),y=n("8f34"),E=(a(y),n("mScD")),b=(a(E),n("YpvI")),g=a(b),k=n("9jXU"),w=(a(k),n("gK+r")),O=a(w),_=n("a0hn"),S=a(_),N=n("opgY"),C=a(N),P=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={messages:[],modal:null,editing:null,inited:!1,error:null},n.showNewModal=n.showNewModal.bind(n),n.showUpdateModal=n.showUpdateModal.bind(n),n.hideModal=n.hideModal.bind(n),n.confirmCreate=n.confirmCreate.bind(n),n.confirmUpdate=n.confirmUpdate.bind(n),n.removeBroadcast=n.removeBroadcast.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){this.getAllMessage()}},{key:"getAllMessage",value:function(){var e=this;this.setState({inited:!1}),v.default.API_Admin_getBroadcasts().then(function(t){e.setState({inited:!0,error:null,messages:t.messages})}).catch(function(t){(0,g.default)("获取失败！"+t.message||t,"error"),e.setState({error:t.message||t||"获取句集内容失败！",inited:!1})})}},{key:"showNewModal",value:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),a=e.getDate(),o=e.getHours(),r=e.getMinutes(),l=e.getSeconds();this.setState({modal:"new",editing:{endAt:t+"/"+(n+1)+"/"+a+" "+o+":"+r+":"+l,message:""}})}},{key:"showUpdateModal",value:function(e){var t=e.target.getAttribute("data-index"),n=this.state.messages[t],a=new Date(n.endAt),o=a.getFullYear(),r=a.getMonth(),l=a.getDate(),i=a.getHours(),u=a.getMinutes(),s=a.getSeconds();this.setState({modal:"update",editing:{index:t,_id:n._id,endAt:o+"/"+(r+1)+"/"+l+" "+i+":"+u+":"+s,message:n.message}})}},{key:"removeBroadcast",value:function(e){var t=this,n=e.target.getAttribute("data-index"),a=this.state.messages[n];v.default.API_Admin_deleteBroadcast({_id:a._id}).then(function(){t.setState(function(e){return e.messages.splice(n,1),e})})}},{key:"hideModal",value:function(){this.setState({modal:null})}},{key:"confirmUpdate",value:function(){var e=this,t=this.textarea.value,n=this.refs.time.value.trim(),a=/(\d{4})\/(\d+)\/(\d+) (\d+):(\d+):(\d+)/.exec(n);if(a){var o=new Date(a[1],a[2]-1,a[3],a[4],a[5],a[6]);v.default.API_Admin_updateBroadcast({endAt:o,_id:this.state.editing._id,message:t}).then(function(t){e.hideModal(),e.setState(function(e){var n=e.editing.index;return e.messages.splice(n,1,t.message),e})})}else(0,g.default)("参数不合法！\n"+n,"error")}},{key:"confirmCreate",value:function(){var e=this,t=this.textarea.value,n=this.refs.time.value.trim(),a=/(\d{4})\/(\d+)\/(\d+) (\d+):(\d+):(\d+)/.exec(n);if(a){var o=new Date(a[1],a[2]-1,a[3],a[4],a[5],a[6]);v.default.API_Admin_putBroadcast({endAt:o,message:t}).then(function(t){e.hideModal(),e.setState(function(e){return e.messages.push(t.message),e})})}else(0,g.default)("参数不合法！\n"+n,"error")}},{key:"render",value:function(){var e=this,t=this.state.messages,n=null;if(this.state.inited)if(0==t.length)n=s.default.createElement("div",{key:"empty",className:"align-center"},s.default.createElement("h1",{className:"color-red"},"没有要广播的消息！"),s.default.createElement("p",null,"这里什么都没有"));else{this.state.passed;n=t.map(function(t,n){return s.default.createElement("div",{key:t.endAt+t.message},s.default.createElement("blockquote",null,t.message,s.default.createElement("br",null),new Date(t.endAt).toLocaleString()),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{"data-index":n,onClick:e.showUpdateModal},"修改"),s.default.createElement("button",{"data-index":n,onClick:e.removeBroadcast},"删除"))),s.default.createElement("hr",null))})}return s.default.createElement(O.default,{cardname:"通知公告",actions:[s.default.createElement("a",{key:"newone-hito",href:"javascript:",title:"点击新增",onClick:this.showNewModal,"data-text":"新增"},s.default.createElement("i",{className:"iconfont icon-add hide-pc"}))]},s.default.createElement(f.default,{ease:"easeOutQuart",animConfig:[{opacity:[1,0]},{left:"0",right:"0",position:"absolute",opacity:[1,0]}]},this.state.inited?null:s.default.createElement(S.default,{error:this.state.error,retry:function(){e.getNeedReviewHitokotos(e.state.current)},key:"loading"}),s.default.createElement("div",{className:"view"},n)),this.state.modal?s.default.createElement(C.default,{exit:this.hideModal},s.default.createElement(p.default,{minRows:3,style:{height:"200px",maxHeight:300},inputRef:function(t){return e.textarea=t},placeholder:"请在此输入hitokoto",defaultValue:this.state.editing.message}),s.default.createElement("p",null,s.default.createElement("input",{type:"text",ref:"time",defaultValue:this.state.editing.endAt})),s.default.createElement("p",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},"new"==this.state.modal?s.default.createElement("button",{onClick:this.confirmCreate},"新增"):s.default.createElement("button",{onClick:this.confirmUpdate},"修改")))):null)}}]),t}(u.Component);t.default=P},d6mP:function(e,t){e.exports={contianer:"_3bIey1ExKpLK2YKzRD93Qg",NWrapper:"_141HQGQP8ngMLQLfkJqJ-x",notification:"_3zzSFLanRS2r2ceM5T4_1b",info:"_3-O7thaUne21mrzMkAqu5A",success:"_3v-3ONCfe-yeCj34InRfzC",error:"_17_BUUobhlgQNwlf2fBvwL",actions:"_2IcEHj4uQDs5YIJY0wUR3c",content:"_10-m72xlRfUjyqL4SiBfF7"}},dtTU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(""+e+r,r).toString()};var a=n("Ff/Y"),o=function(e){return e&&e.__esModule?e:{default:e}}(a),r="AreYouPervert？??????!kbgxFVFjoyITVDwJigTGYyBpTuCYa1Ubk/Bpnp7ZOWtE1NF3S2v6wIJAM4XNXbOwHOMAfDv/AkEA1W01RTgniEZFTvAFq3qwRgsR1ODq2JK0LefT2wuRyQPuhCzsKq0yhCS5fzwd146vU+uGfQE6lpUCaV0FAKDT1wJAUJM4sRBb1b28DcwI7M8i7YHE2+PS;BkwJE2+TZaY5DxbwfpB2IZ0GyhI1ZCmzmzywK/GSxPS7GPW1IeVeXT1sCQJBAJ+G45x7nsDzlXatXe+Q4xVXzNpLy/5Zmaf+cpJ2EWApOi09zsEPeIThVm3OJ5gppM+baokhVAOeGZFb4BNaIz0CQQCmq+tVF0esSprc5+4rW7BsKfIEosV9YShDhZZiUdlBC6f5FglpnkvC37017tcHtUVYoWGUN9Gq+sgzJp42+rYy傻逼;"},eKmS:function(e,t,n){"use strict";function a(e){localStorage.setItem(o,JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0});var o="hitokotoBroadcasts",r=function(){var e=localStorage.getItem(o);if(e){var t=JSON.parse(e),n=(new Date).toISOString();return t.reduce(function(e,t){return t>n&&e.push(t),e},[])}return[]}();t.default={hasDisplayed:function(e){return!!~r.indexOf(e)},add:function(e){r.push(e),a(r)}}},eUtn:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("O27J"),d=a(c),f=n("F8kA"),h=n("f7Do"),p=a(h),m=n("uY+K"),v=a(m),y=n("8f34"),E=a(y),b=n("mScD"),g=a(b),k=n("YpvI"),w=a(k),O=(n("YXrc"),n("9jXU")),_=a(O),S=n("jdew"),N=(a(S),n("gK+r")),C=a(N),P=n("+S9/"),T=a(P),I=n("a0hn"),R=a(I),A=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hitokotos:[],favorites:[],inited:!1,error:null,total:1,current:1},n.exploreUserCollection=n.exploreUserCollection.bind(n),n.addToFavorite=n.addToFavorite.bind(n),n.removeFromRavorite=n.removeFromRavorite.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){this.exploreUserCollection(1)}},{key:"exploreUserCollection",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=this.props,o=a.uid,r=a.collectionName;if(!o)return this.props.history.push("/");var l=d.default.findDOMNode(this);l&&(l.scrollIntoView?l.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}):l.scrollTop=0),this.setState({inited:!1}),v.default.API_getPublicUserHitokotos(o,r,e,n).then(function(e){t.setState({inited:!0,error:null,hitokotos:e.hitokotos,favorites:new Array(e.hitokotos.length).fill(null),current:e.currentPage,total:e.totalPage}),e.hitokotos.map(function(e,n){g.default.isInFavorite(e).then(function(e){e?t.setState(function(e){return e.favorites[n]=!0,e}):t.setState(function(e){return e.favorites[n]=!1,e})})})}).catch(function(e){(0,w.default)("获取句集内容失败！","error"),t.setState({error:e.message||e||"获取句集内容失败！",inited:!1})})}},{key:"addToFavorite",value:function(e){var t=this,n=e.target.getAttribute("data-index");g.default.addToFavorite(this.state.hitokotos[n]).then(function(e){t.setState(function(e){return(0,w.default)("加入收藏成功！","success"),e.favorites[n]=!0,e})})}},{key:"removeFromRavorite",value:function(e){var t=this,n=e.target.getAttribute("data-index");g.default.removeFromFavorite(this.state.hitokotos[n]).then(function(e){t.setState(function(e){return(0,w.default)("取消收藏成功！","info"),e.favorites[n]=!1,e})})}},{key:"addToSource",value:function(e,t){E.default.patterManager.newSourceWithUsernameAndCol(this.props.userName,e),this.forceUpdate(),t.stopPropagation()}},{key:"render",value:function(){var e=this,t=this.props,n=(t.path,t.location,t.collectionName),a=this.state.hitokotos,o=null;return this.state.inited&&(o=0==a.length?s.default.createElement("div",{key:"empty",className:"align-center"},s.default.createElement("h1",null,"哦豁..."),s.default.createElement("p",null,"这里什么都没有")):a.map(function(t,n){return s.default.createElement(_.default,{key:t._id,data:t,viewonly:!0},e.state.favorites[n]?s.default.createElement("a",{href:"javascript:"},s.default.createElement("i",{className:"iconfont icon-favorfill",title:"已收藏","data-index":n,onClick:e.removeFromRavorite})):s.default.createElement("a",{href:"javascript:"},s.default.createElement("i",{className:"iconfont icon-favor",title:"点击加入收藏","data-index":n,onClick:e.addToFavorite})))})),s.default.createElement(C.default,{cardname:n},s.default.createElement(p.default,{ease:"easeOutQuart",animConfig:[{opacity:[1,0]},{left:"0",right:"0",position:"absolute",opacity:[1,0]}]},this.state.inited?null:s.default.createElement(R.default,{error:this.state.error,retry:function(){e.exploreUserCollection(e.state.current)},key:"loading"}),s.default.createElement("div",{className:"view"},o)),s.default.createElement(T.default,{current:this.state.current||1,total:this.state.total||1,limit:10,func:this.exploreUserCollection}))}}]),t}(u.Component);t.default=(0,f.withRouter)(A)},evxO:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("RH2O"),d=n("f7Do"),f=(a(d),n("KSGD")),h=a(f),p=n("F8kA"),m=n("uY+K"),v=n("mScD"),y=a(v),E=n("YpvI"),b=a(E),g=n("opgY"),k=a(g),w=n("wNBo"),O=a(w),_=n("LhJ3"),S=a(_),N=n("EjY7"),C=(n("D9xO"),n("z55N")),P=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={infoModal:!1,favor:!1},n.addToFavorite=n.addToFavorite.bind(n),n.removeFromFavorite=n.removeFromFavorite.bind(n),n.showInfo=n.showInfo.bind(n),n.hideInfo=n.hideInfo.bind(n),n.whenSpaceKeyPressed=n.whenSpaceKeyPressed.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.hitokoto;t&&y.default.isInFavorite(t).then(function(t){t&&e.setState({favor:t.hitokoto})}),window.addEventListener("keydown",this.whenSpaceKeyPressed,!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.whenSpaceKeyPressed,!0)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.hitokoto;n.hitokoto!=this.props.hitokoto.hitokoto&&(this.setState({favor:null}),n&&y.default.isInFavorite(n).then(function(e){e&&t.setState({favor:e.hitokoto})}))}},{key:"whenSpaceKeyPressed",value:function(e){if("Space"==e.code||32==e.keyCode){var t=this.props,n=t.processing,a=t.callbacks.handleNext;n||a()}}},{key:"addToFavorite",value:function(){var e=this,t=this.props.hitokoto;y.default.addToFavorite(t).then(function(){(0,b.default)("加入收藏成功！","success"),e.setState({favor:t.hitokoto})}).catch(function(e){(0,b.default)("操作失败"+e,"error")})}},{key:"removeFromFavorite",value:function(){var e=this,t=this.props.hitokoto;y.default.removeFromFavorite(t).then(function(){(0,b.default)("移除成功！","info"),e.setState({favor:null})}).catch(function(e){(0,b.default)("操作失败"+e,"error")})}},{key:"showInfo",value:function(){this.setState({infoModal:!0})}},{key:"hideInfo",value:function(){this.setState({infoModal:!1})}},{key:"render",value:function(){var e=this.props,t=e.hitokoto,n=e.layout,a=e.callbacks,o=a.handleNext,r=a.handleLast,l=e.direction,i=e.lastCount,u=(e.nextCount,e.processing),c=e.showLayoutSetting,d=t.id,f=n.layoutHorizon,h=[s.default.createElement("li",{key:d+"info"},s.default.createElement("a",{href:"javascript:",title:"关于",onClick:this.showInfo},s.default.createElement("i",{className:"iconfont icon-info"}))),this.state.favor==t.hitokoto?s.default.createElement("li",{key:d+"love"},s.default.createElement("a",{href:"javascript:",title:"已收藏",onClick:this.removeFromFavorite},s.default.createElement("i",{className:"iconfont icon-favorfill"}))):s.default.createElement("li",{key:d+"love"},s.default.createElement("a",{href:"javascript:",title:"点击收藏",onClick:this.addToFavorite},s.default.createElement("i",{className:"iconfont icon-favor"}))),s.default.createElement("li",{key:d+"setting",title:"页面设置"},s.default.createElement("a",{href:"javascript:",onClick:c},s.default.createElement("i",{className:"iconfont icon-shezhi"}))),i>1?s.default.createElement("li",{key:d+"last"},s.default.createElement("a",{href:"javascript:",onClick:r,title:"上一条"},s.default.createElement("i",{className:"iconfont icon-last"}))):null,s.default.createElement("li",{key:d+"next"},s.default.createElement("a",{href:"javascript:",onClick:o,title:"下一条"},u?s.default.createElement("i",{className:"iconfont icon-loading-anim"}):s.default.createElement("i",{className:"iconfont icon-next"})))],v=null;if(this.state.infoModal){var y=t.created_at;if(y){var E=new Date(y).toLocaleString();"Invalid Date"!=E&&(y=E)}else y="未知";m.SAME_ORIGIN.test(t.url)?(window.trickyUid=t.creator_id,v=s.default.createElement(k.default,{exit:this.hideInfo,key:"player-info-sameorigin"},s.default.createElement("p",null,"ID：",t.id||"未知"),s.default.createElement("p",null,"发布者：",s.default.createElement(p.Link,{to:"/explore/"+t.creator,role:"exit"},t.creator)),s.default.createElement("p",null,"所在句集：",t.collection?s.default.createElement(p.Link,{to:"/explore/"+t.creator+"/"+t.collection,role:"exit"},t.collection):"未知"),s.default.createElement("p",null,"分类：",t.category||"未知"),s.default.createElement("p",null,"发布时间：",y))):v=s.default.createElement(k.default,{exit:this.hideInfo,key:"player-info"},s.default.createElement("p",null,"ID：",t.id||"未知"),s.default.createElement("p",null,"发布者：",t.creator||"未知"),s.default.createElement("p",null,"所在句集：",t.collection||"未知"),s.default.createElement("p",null,"分类：",t.category||"未知"),s.default.createElement("p",null,"发布时间：",y))}return[f?s.default.createElement(O.default,{key:"player-horizon",onKeyPress:this.whenSpaceKeyPressed,overflowhide:this.props.panel===N.PANEL_OPEN+"nav",animateConfig:"next"==l?C.ANIMATE_CONFIG_NEXT:C.ANIMATE_CONFIG_LAST,hitokoto:t,layout:n,actions:h}):s.default.createElement(S.default,{key:"player-vertical",onKeyPress:this.whenSpaceKeyPressed,animateConfig:"next"==l?C.ANIMATE_CONFIG_NEXT:C.ANIMATE_CONFIG_LAST,hitokoto:t,layout:n,actions:h}),this.state.infoModal?v:null]}}]),t}(u.Component);P.PropTypes={hitokoto:h.default.object.isRequired,layout:h.default.object.isRequired,callbacks:h.default.shape({handleNext:h.default.func,handleLast:h.default.func}),direction:h.default.string.isRequired,lastCount:h.default.number,nextCount:h.default.number,processing:h.default.bool,showLayoutSetting:h.default.func.isRequired};var T=function(e){return{layout:e.layout,panel:e.panel}},I=function(e){return{showLayoutSetting:function(){return e((0,N.showPanel)("layoutSetting"))}}};t.default=(0,c.connect)(T,I)(P)},"gK+r":function(e,t,n){"use strict";function a(e){var t=e.style,n=e.onClick,a=e.actions;return r.default.createElement("div",{key:"default",style:t,className:i.wrapper,onClick:n},r.default.createElement("div",{className:i.paper},r.default.createElement("div",{className:i.manageBox},r.default.createElement("header",{className:i.header+(a?" "+i.withAction:"")},r.default.createElement("a",{href:"javascript:",onClick:e.close?e.close:function(){return e.history.goBack()},className:i.backButton},r.default.createElement("i",{className:"iconfont icon-back_android"})),r.default.createElement("span",null,e.cardname),a?r.default.createElement("div",{className:i.cardActions},a):null),r.default.createElement("div",{className:i.content},e.children))))}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),l=n("F8kA"),i=n("ivXE");t.default=(0,l.withRouter)(a)},hrmx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("EjY7"),o=n("vxS+"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case a.SOURCES_NEW_ONE:return(0,r.default)(e,{sourceNew:{$set:t.value}});case a.SOURCES_NEW_ONE_DONE:return(0,r.default)(e,{sourceNew:{$set:null}});case a.SOURCES_REMOVE_ONE:return(0,r.default)(e,{sourceRemove:{$set:t.value}});case a.SOURCES_REMOVE_ONE_DONE:return(0,r.default)(e,{sourceRemove:{$set:null}});default:return e}};t.default=l},hy1G:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("bU7B"),i=a(l),u=(n("EjY7"),function(e){return{user:e.user}}),s=function(e){return{}};t.default=(0,r.connect)(u,s)(i.default)},iDSo:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("F8kA"),d=n("RH2O"),f=n("cS16"),h=a(f),p=n("rhec"),m=a(p),v=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),i(t,[{key:"render",value:function(){return s.default.createElement(d.Provider,{store:h.default},s.default.createElement(c.HashRouter,null,s.default.createElement(m.default,null)))}}]),t}(u.Component);t.default=v},iiOv:function(e,t){e.exports={thanksList:"_1YitsXr22paRCDEmOQwltg",debug:"_24GyQku_fj-4cwUuTd4epv",article:"_27EGe9ZkrzrgXgbliV1JQ3"}},ivXE:function(e,t){e.exports={wrapper:"_6dW3arjlv1YILf-HcgZLo",paper:"_2yd8Wa0O3KZAZaQNPU1jl6",header:"_3NbbMGPG-NdoUYi3TWE53k",content:"_3SbZI-Z8FOQ8u8wwECCoPY",closeButton:"_3ACx8an18ZgfN1NqyQgR_n",backButton:"_192feMLyM6rdOc2meGgb-c",manageBox:"_1-8U7ar8v2DXuMiw3W49ZQ",cardActions:"_1OPawTeaB5TLK-Pe-o2ZZc",withAction:"May4WQAtzRDImMYKgXJPg"}},ivrE:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(new Date).getFullYear();return l.default.createElement("div",{className:f},l.default.createElement("input",{type:"checkbox",id:s,hidden:!0}),l.default.createElement("label",{className:c,htmlFor:s}),l.default.createElement("div",{className:u.default.copyright},l.default.createElement("label",{className:d,htmlFor:s}),l.default.createElement("p",null,"Copyright ©2017-",t," heitaov.cn",l.default.createElement("span",{className:h},"蜀ICP备16001587号-1 QQ群：302713047"))))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n("GiK3"),l=a(r),i=n("RoSH"),u=a(i),s=u.default["copyright-state"],c=u.default["copyright-open"],d=u.default["copyright-close"],f=u.default.copyrightWrapper,h=u.default.hoverToShow},iwfW:function(e,t){e.exports={logo:"_1BGcT95RJSaI81k3isFTN5"}},"j/K4":function(e,t){e.exports={red:"_2sQO4P_-rCNGkv5krDMmwk"}},j1Hv:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(){return localStorage.getItem(v)}function i(e){localStorage.setItem(v,e)}function u(){var e=localStorage.getItem(g);return e?JSON.parse(e):e}function s(e){null!=e&&("object"==(void 0===e?"undefined":f(e))?localStorage.setItem(g,JSON.stringify(e)):"string"==typeof e&&localStorage.setItem(g,e))}Object.defineProperty(t,"__esModule",{value:!0}),t.PATTERNS=t.PATTERN_UPDATE_KEYS=t.VERSION=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=function e(t,n,a){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,a)}if("value"in o)return o.value;var l=o.get;if(void 0!==l)return l.call(a)},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=n("EWX9"),p=function(e){return e&&e.__esModule?e:{default:e}}(h),m=t.VERSION="20170811 count1",v="hikotokopatterns_version",y=t.PATTERN_UPDATE_KEYS=["name","interval","type"],E=t.PATTERNS=[{id:100124,name:"第三方API定时刷新",interval:6,sources:h.SOURCES,type:"random",default:!0},{id:100123,name:"第三方API",interval:0,sources:h.SOURCES,type:"random",default:!1},{id:100100,name:"网站默认",interval:0,sources:h.SITE_DEFAULT,type:"next",default:!1}],b=["name","url","adapter"],g="hikotokopatterns",k=function(e){function t(){a(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(e.version_pattern=l(),e.version_pattern||(i(m),e.version_pattern=m),e.patterns=u(),e.patterns||(s(E),e.patterns=E),-1===e.version_pattern.indexOf("count1")&&(console.log("restore count",e.version_pattern),e.patterns.forEach(function(e){e.sources.forEach(function(e){e.count=0})}),s(e.patterns)),m>e.version_pattern){var n={},r=!1;e.patterns.forEach(function(e){n[e.id]=!0}),E.forEach(function(e){n[e.id]||(this.patterns.push(e),r=!0)}),r&&s(e.patterns),i(m)}return e}return r(t,e),c(t,[{key:"updateSource",value:function(e,n){d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateSource",this).call(this,e,n),this.patterns.forEach(function(t){t.sources.forEach(function(t,a){t.id==e&&b.forEach(function(e){t[e]=n[e]})})}),s(this.patterns)}},{key:"increaseSourceCount",value:function(e,t){var n=this.patterns.find(function(t){return t.id==e}),a=n.sources.find(function(e){return e.id==t});a.count=a.count+1,s(this.patterns)}},{key:"deleteSource",value:function(e){return d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deleteSource",this).call(this,e)}},{key:"newPattern",value:function(e){this.patterns.push(e),e.default&&this.setDefaultPattern(e.id),s(this.patterns)}},{key:"updatePattern",value:function(e,t){var n=this;console.log(e,t);for(var a=0,o=this.patterns.length;a<o;a++)this.patterns[a].id==e&&function(){var o=n.patterns[a];y.forEach(function(e){o[e]!=t[e]&&(o[e]=t[e])}),o.sources.length=0,t.sources.forEach(function(e){o.sources.push(e)}),t.default&&n.setDefaultPattern(e)}();s(this.patterns)}},{key:"deletePattern",value:function(e){for(var t=0,n=this.patterns.length;t<n;t++)this.patterns[t].id==e&&(this.patterns.splice(t,1),t--,n--);s(this.patterns)}},{key:"setDefaultPattern",value:function(e){this.patterns.forEach(function(t){t.id==e?t.default=!0:t.default=!1}),s(this.patterns)}},{key:"getDefaultPattern",value:function(){for(var e=0,t=this.patterns.length;e<t;e++){var n=this.patterns[e];if(n.default)return n}return this.patterns[0]}},{key:"getPatternById",value:function(e){return this.patterns.find(function(t){return t.id==e})}},{key:"restorePatterns",value:function(e){e&&e.length&&(this.patterns=JSON.parse(JSON.stringify(e)),s(this.patterns))}}]),t}(p.default);t.default=k},jdew:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=(n("F8kA"),n("KSGD")),d=a(c),f=n("RH2O"),h=n("YpvI"),p=a(h),m=n("8f34"),v=a(m),y=n("YXrc"),E=a(y),b=n("EjY7"),g=v.default.patterManager,k=E.default["Card--change"],w=(E.default.hide,E.default.newone),O=E.default.Card,_=E.default.Card_options,S=E.default.Card_content,N=function(e){return{nickname:e.user.nickname}},C=function(e){return{newSource:function(t){return e((0,b.newOneSource)(t))},removeSource:function(t){return e((0,b.removeOneSource)(t))}}},P=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:"normal"},n.handleViewClick=n.handleViewClick.bind(n),n.handleChangeClick=n.handleChangeClick.bind(n),n.doChange=n.doChange.bind(n),n.doDelete=n.doDelete.bind(n),n.handleChangeKeyPress=n.handleChangeKeyPress.bind(n),n.handleKeyPress=n.handleKeyPress.bind(n),n.handleNewOneClick=n.handleNewOneClick.bind(n),n.newOne=n.newOne.bind(n),n.returnToNormal=n.returnToNormal.bind(n),n.addToSources=n.addToSources.bind(n),n.removeFromSources=n.removeFromSources.bind(n),n}return l(t,e),i(t,[{key:"handleViewClick",value:function(){this.props.view(this.props.data.name)}},{key:"handleChangeClick",value:function(e){if((0,p.default)("重命名后，原来的添加的来源将无法使用！需要重新添加来源！","error",!0),"默认句集"==this.props.data.name)return void(0,p.default)("默认句集无法修改！","error");this.setState({status:"change"}),e.stopPropagation()}},{key:"handleNewOneClick",value:function(e){this.setState({status:"newone"}),e.stopPropagation()}},{key:"newOne",value:function(){var e=this,t=this.refs.name.value.trim();if("默认句集"==t)return void(0,p.default)("无法命名为默认句集无法修改！","error");this.props.newCollection(t).then(function(){e.refs.name.value="",e.setState({status:"normal"})})}},{key:"doChange",value:function(){var e=this.refs.name.value.trim(),t=this.props.data.name;if("默认句集"==t)return void(0,p.default)("默认句集无法修改！","error");e==t?(0,p.default)("两次名称相等！无法修改","error"):this.props.changeName(t,e)}},{key:"doDelete",value:function(e){var t=this.props.data.name;if("默认句集"==t)return void(0,p.default)("默认句集无法删除！","error");this.props.delete(t),e.stopPropagation()}},{key:"returnToNormal",value:function(){this.setState({status:"normal"})}},{key:"handleKeyPress",value:function(e){"enter"==e.key.toLowerCase()&&this.newOne()}},{key:"handleChangeKeyPress",value:function(e){"enter"==e.key.toLowerCase()&&this.doChange()}},{key:"removeFromSources",value:function(e){e.stopPropagation();var t=this.props,n=t.nickname,a=t.ownerName,o=t.data,r=o.name,l=o.owner,i=o._id,u=t.isPublic,s=void 0;s=u&&a!=n?g.removeSourceWithUsernameAndCol(n,r,!0):g.removeSourceWithUsernameAndCol(l,i,!1),this.props.removeSource?this.props.removeSource(s):(0,p.default)("将「"+r+"」从来源中删除成功！","info",!1,4),this.forceUpdate()}},{key:"addToSources",value:function(e){e.stopPropagation();var t=this.props,n=t.nickname,a=t.ownerName,o=t.data,r=o.name,l=o.owner,i=o._id,u=t.isPublic,s=void 0;s=u&&a!=n?g.newSourceWithUsernameAndCol(a,r,!0):g.newSourceWithUsernameAndCol(n,r,!1,l,i),this.props.newSource?this.props.newSource(s):(0,p.default)("将「"+r+"」加入来源成功！\n该来源可以获取「公开」和「私密」的所有句子。","success"),this.forceUpdate()}},{key:"isSourcesContians",value:function(){var e=this.props,t=e.nickname,n=e.ownerName,a=e.data,o=a.name,r=a.owner,l=a._id,i=e.isPublic,u=void 0;return u=i&&n!=t?g.getUrlOfUserCol(n,o,!0):g.getUrlOfUserCol(r,l,!1),g.isSourceExsit(u)}},{key:"render",value:function(){var e=this.props,t=e.tabIndex,n=(e.view,e.data),a=n.name,o=n.count,r=(n.owner,n._id,e.newone),l=e.isPublic,i=this.state.status;return l?s.default.createElement("div",{tabIndex:t,className:O,title:"点击查看该句集",onClick:this.handleViewClick},s.default.createElement("div",{className:S},s.default.createElement("p",{className:"ellipsis"},a),s.default.createElement("span",null,o,"条"),s.default.createElement("div",{className:_},this.isSourcesContians()?s.default.createElement("a",{tabIndex:t,href:"javascript:",title:"点击删除该句集",onClick:this.removeFromSources},"撤销来源"):s.default.createElement("a",{tabIndex:t,href:"javascript:",title:"点击删除该句集",onClick:this.addToSources},"加入来源")," "))):r&&"normal"==i?s.default.createElement("div",{tabIndex:1,className:O,title:"点击新增句集",onClick:this.handleNewOneClick},s.default.createElement("div",{className:S},s.default.createElement("span",{className:w},s.default.createElement("i",{className:"iconfont icon-add"})))):"newone"==i?s.default.createElement("div",{className:O+" "+k,tabIndex:t},s.default.createElement("div",{className:S},s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"text",required:!0,ref:"name",onKeyPress:this.handleKeyPress,tabIndex:t}),s.default.createElement("label",{"data-content":"句集的名称"},"句集的名称")),s.default.createElement("div",{className:_},s.default.createElement("a",{href:"javascript:",onClick:this.newOne,tabIndex:t},"新增")," ",s.default.createElement("a",{href:"javascript:",onClick:this.returnToNormal,tabIndex:t},"取消")))):"normal"==i?s.default.createElement("div",{tabIndex:t,className:O,title:"点击查看该句集",onClick:this.handleViewClick},s.default.createElement("div",{className:S},s.default.createElement("p",{className:"ellipsis"},a),s.default.createElement("span",null,o,"条"),s.default.createElement("div",{className:_},this.isSourcesContians()?s.default.createElement("a",{tabIndex:t,href:"javascript:",title:"点击删除该句集",onClick:this.removeFromSources},"撤销来源"):s.default.createElement("a",{tabIndex:t,href:"javascript:",title:"点击删除该句集",onClick:this.addToSources},"加入来源")," ",s.default.createElement("a",{tabIndex:t,href:"javascript:",title:"点击修改该句集名称",className:"默认句集"==a?"hide color-red":"color-red",onClick:this.handleChangeClick},"重命名")," ",s.default.createElement("a",{tabIndex:t,href:"javascript:",title:"点击删除该句集",className:"默认句集"==a?"hide color-red":"color-red",onClick:this.doDelete},"删除")))):"change"==i?s.default.createElement("div",{className:O+" "+k,tabIndex:t},s.default.createElement("div",{className:S},s.default.createElement("div",{className:"text-filed"},s.default.createElement("input",{type:"text",required:!0,ref:"name",defaultValue:a,onKeyPress:this.handleChangeKeyPress}),s.default.createElement("label",{"data-content":"句集的名称"},"句集的名称")),s.default.createElement("div",{className:_},s.default.createElement("a",{href:"javascript:",onClick:this.doChange,tabIndex:0},"确认修改")," ",s.default.createElement("a",{href:"javascript:",onClick:this.returnToNormal,tabIndex:0},"取消")))):void 0}}]),t}(u.Component);P.propTypes={nickname:d.default.string.isRequired},t.default=(0,f.connect)(N,C)(P)},jm2v:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("f7Do"),d=a(c),f=n("d6mP"),h=n("aDbo"),p=a(h),m=n("z55N"),v=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showError=n.showError.bind(n),n}return l(t,e),i(t,[{key:"showError",value:function(e){console.log(e),this.props.sendNotification("运行错误！\n未捕获的全局错误\n"+e.error.stack,"error",!0)}},{key:"componentWillMount",value:function(){window.addEventListener("error",this.showError)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("error",this.showError)}},{key:"render",value:function(){var e=this.props,t=e.notifications,n=e.removeNotification;return s.default.createElement(d.default,{className:f.contianer,type:m.GLOBAL_ANIMATE_TYPE},t.map(function(e){return s.default.createElement(p.default,{data:e,key:e.id,remove:n})}))}}]),t}(u.Component);t.default=v},jyx7:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("ptZP"),i=a(l),u=n("EjY7"),s=function(e){return{layout:e.layout,panel:e.panel,user:e.user}},c=function(e){return{hideNav:function(){return e((0,u.hidePanel)("nav"))}}};t.default=(0,r.connect)(s,c)(i.default)},lDx5:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("bFiM"),d=a(c),f=n("YpvI"),h=a(f),p=n("HvcI"),m=(a(p),n("uY+K")),v=(a(m),n("mScD")),y=a(v),E=n("mtXx"),b=(a(E),n("8f34")),g=a(b),k=n("gK+r"),w=a(k),O=n("opgY"),_=a(O),S=n("9jXU"),N=a(S),C=(g.default.patterManager,function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hitokotos:null,chooseModal:!1,deleteFavorite:null},n.showDelete=n.showDelete.bind(n),n.hideDelete=n.hideDelete.bind(n),n.confirmDelete=n.confirmDelete.bind(n),n.showChooseModal=n.showChooseModal.bind(n),n.userNameClickProxy=n.userNameClickProxy.bind(n),n.collectionClickProxy=n.collectionClickProxy.bind(n),n}return l(t,e),i(t,[{key:"componentWillMount",value:function(){var e=this;y.default.getAllFavorite().then(function(t){e.setState({hitokotos:t})})}},{key:"showDelete",value:function(e){var t=parseInt(e.target.getAttribute("data-index"));this.setState({deleteFavorite:t})}},{key:"confirmDelete",value:function(){var e=this,t=this.state.hitokotos,n=this.state.deleteFavorite,a=t[n-1];y.default.removeFromFavorite(a).then(function(t){(0,h.default)("已删除！"),e.setState(function(e){return e.hitokotos.splice(n-1,1),e})}).catch(function(e){(0,h.default)("删除失败！"+e,"error")}),this.hideDelete()}},{key:"hideDelete",value:function(){this.setState({deleteFavorite:null})}},{key:"showChooseModal",value:function(e){this.setState({chooseModal:e})}},{key:"export",value:function(e){var t=new d.default,n=this.state.hitokotos,a=void 0;t.update("数据准备完成，格式转换中..."),"txt"==e?a=new Blob(n.map(function(e){return"\n"+e.id+"\n"+e.hitokoto+"\n"+e.author+" - "+e.source+"\n由 "+e.creator+" 创建于\n"+e.created_at+"\n\n"}),{type:"text/plain"}):"json"==e&&(a=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}));var o=document.createElement("a");o.href=URL.createObjectURL(a),o.download=(new Date).toLocaleString()+"."+e,o.onclick=function(){URL.revokeObjectURL(a)},o=document.body.appendChild(o),o.click(),t.success("格式转换完成，尝试下载"),this.hideChooseModal()}},{key:"hideChooseModal",value:function(){this.setState({chooseModal:!1})}},{key:"userNameClickProxy",value:function(e){var t=this.state.hitokotos[e];t.creator_id&&t.creator?(window.trickyUid=t.creator_id,this.props.history.push("/explore/"+t.creator)):(0,h.default)("无法跳转到用户详情，可能句子不是本网站的。")}},{key:"collectionClickProxy",value:function(e){var t=this.state.hitokotos[e];t.creator_id&&t.creator&&t.collection?(window.trickyUid=t.creator_id,this.props.history.push("/explore/"+t.creator+"/"+t.collection)):(0,h.default)("无法跳转到句集详情，可能句子不是本网站的。")}},{key:"render",value:function(){var e=this,t=this.state.hitokotos,n=void 0;return n=t?t.map(function(t,n){return s.default.createElement(N.default,{data:t,key:n,usernameProxy:function(){return e.userNameClickProxy(n)},collectionProxy:function(){return e.collectionClickProxy(n)}},s.default.createElement("button",{className:"color-red","data-index":n+1,onClick:e.showDelete},"删除"))}):s.default.createElement("div",{key:"loading"},s.default.createElement("h1",null,s.default.createElement("i",{className:"iconfont icon-loading-anim"}),"载入中")),t&&0==t.length&&(n=s.default.createElement("div",{key:"zero"},s.default.createElement("h1",{className:"color-red"},s.default.createElement("i",{className:"iconfont icon-tishi"}),"空空如也"),s.default.createElement("p",null,"这里还没有收藏句子"))),s.default.createElement(w.default,{cardname:"我的收藏",actions:[s.default.createElement("a",{key:"export",href:"javascript:",title:"",onClick:this.showChooseModal,"data-text":"导出数据"},s.default.createElement("i",{className:"iconfont icon-pulldown hide-pc"}))]},s.default.createElement("p",null,"收藏的句子保存在本地，清空浏览器缓存可能导致数据丢失。"),s.default.createElement("div",{className:"lum-list "},n),this.state.chooseModal?s.default.createElement(_.default,{exit:function(){return e.hideChooseModal()}},s.default.createElement("h1",null,"导出收藏的句子，请选择导出的类型："),s.default.createElement("p",null,s.default.createElement("button",{onClick:function(){return e.export("txt")}},"纯文本"),s.default.createElement("button",{onClick:function(){return e.export("json")}},"JSON"))):null,this.state.deleteFavorite?s.default.createElement(_.default,{exit:function(){return e.hideDelete()}},s.default.createElement("h1",{className:"color-red"},"从收藏里删除该句子？"),s.default.createElement("p",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{role:"exit",className:"color-basic"},"取消"),s.default.createElement("button",{onClick:this.confirmDelete,className:"color-red"},"确认删除")))):null)}}]),t}(u.Component));t.default=C},lqTJ:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("t8iB"),d=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(c),n("YpvI")),f=a(d),h=n("mScD"),p=a(h),m=n("gK+r"),v=a(m),y=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),i(t,[{key:"goBack",value:function(){this.props.history.go(-1)}},{key:"clearLS",value:function(){confirm("你确定？")&&(window.localStorage.clear(),(0,f.default)("localstorage已清空,将在3秒后回到首页","success"),setTimeout(function(){location.href="/"},3e3))}},{key:"clearIDB",value:function(){confirm("你确定？")&&p.default.DROP_DB().then(function(){(0,f.default)("全删了！快跑！\nUncaught (in promise) Error: IndexedDB database has been deleted.\n\tat indexedManager.js:46\n\tat (anonymous)","error"),setTimeout(function(){location.href="/"},3e3)},function(e){(0,f.default)(e,"error")})}},{key:"render",value:function(){var e=this,t=this.props;t.path,t.location;return s.default.createElement(v.default,{cardname:"工具箱"},s.default.createElement("div",{className:"lum-list "},s.default.createElement("h1",{className:"color-red"},"下列的按钮很危险！如果你不知道自己在做什么，请返回。"),s.default.createElement("ul",null,s.default.createElement("li",null,s.default.createElement("a",{href:"javascript:",onClick:function(){return e.clearLS()}},s.default.createElement("h4",null,"清除Localstorage缓存"),s.default.createElement("p",null,"将会清除 模式，来源，页面设置，用户登录信息。"))),s.default.createElement("li",null,s.default.createElement("a",{href:"javascript:",onClick:function(){return e.clearIDB()}},s.default.createElement("h4",null,"删库跑路"),s.default.createElement("p",null,"将会删除本地的indexedDB数据库，包括缓存的hitokto，思源宋体字体文件、我的收藏。"))))))}}]),t}(u.Component);t.default=y},mScD:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n("D9q6"),u=a(i),s=n("cS16"),c=a(s),d=new u.default("hitokoto_pwa");d.version(1).stores({hitokoto:",url,_id,fid,author,source,offline",collection:"_id,owner,name,offline",syncRecord:",url",asserts:",name",favor:",url,hitokoto,_id,fid,author,source,offline"});var f=function(){function e(){r(this,e)}return l(e,[{key:"putCollections",value:function(e){return d.table("collection").bulkPut(e)}},{key:"putCollection",value:function(e){return d.table("collection").put(e)}},{key:"removeCollection",value:function(e){return d.table("collection").delete(e)}},{key:"getCollections",value:function(e){if(!e){var t=c.default.getState();e=t.user&&t.user.uid}return d.table("collection").where("owner").equals(e).toArray()}},{key:"getStates",value:function(){var e=this,t=new Set;return d.table("hitokoto").each(function(e){return t.add(e.url)}).then(function(){var n=new Map,a=[],r=!0,l=!1,i=void 0;try{for(var s,c=t.keys()[Symbol.iterator]();!(r=(s=c.next()).done);r=!0)!function(){var t=s.value;a.push(e.getHitokotoCount(t).then(function(e){n.set(t,e)}))}()}catch(e){l=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw i}}return u.default.Promise.all(a).then(function(e){return[].concat(o(n.entries()))})})}},{key:"getAllURLS",value:function(){var e=new Set;return d.table("hitokoto").each(function(t){return e.add(t.url)}).then(function(){return[].concat(o(e.keys()))})}},{key:"getHitokotoCount",value:function(e){return d.table("hitokoto").where("url").equals(e).count()}},{key:"exportHitokotos",value:function(e){return d.table("hitokoto").where("url").equals(e).sortBy("create_at").toArray()}},{key:"clearOneSource",value:function(e){return d.table("hitokoto").where("url").equals(e).delete()}},{key:"putHitokoto",value:function(e,t){return t.url||(t.url=e),d.table("hitokoto").put(t,e+"<%hitokoto%>"+t.id)}},{key:"updateHitokoto",value:function(e,t){t.url||(t.url=e)}},{key:"removeHitokoto",value:function(e){return d.table("hitokoto").where("_id").equals(e).delete()}},{key:"putHitokotoBulk",value:function(e,t){var n=[];return t.forEach(function(t){t.url||(t.url=e),n.push(e+"<%hitokoto%>"+t.id)}),d.table("hitokoto").bulkPut(t,n)}},{key:"getHitokoto",value:function(e,t){var n=d.table("hitokoto").where("url").equals(e);return n.count().then(function(e){if(0==e)return u.default.Promise.reject("本地无缓存！");var a=void 0;return a=t&&"next"==t.type?t.source.count%e:Math.floor(Math.random()*e),0==a?n.first():n.offset(a).first()})}},{key:"putSyncRecord",value:function(e,t){return d.table("syncRecord").put(t,e)}},{key:"removeSyncRecord",value:function(e){return d.table("syncRecord").delete(e)}},{key:"getSyncRecord",value:function(e){return d.table("syncRecord").get(e)}},{key:"putAssert",value:function(e,t){return d.table("asserts").put(t,e)}},{key:"getAssert",value:function(e){return d.table("asserts").get(e)}},{key:"getHitokotoSuggestion",value:function(e,t){return d.table("hitokoto").where(e).startsWithAnyOfIgnoreCase(t).toArray().then(function(t){var n=t.map(function(t){return t[e]});return[].concat(o(new Set(n)))})}},{key:"addToFavorite",value:function(e){return d.table("favor").put(e,e.hitokoto)}},{key:"removeFromFavorite",value:function(e){return d.table("favor").delete(e.hitokoto)}},{key:"isInFavorite",value:function(e){return d.table("favor").get(e.hitokoto)}},{key:"getAllFavorite",value:function(){return d.table("favor").toArray()}},{key:"DEBUG_CLEAR_ALL",value:function(){d.table("hitokoto").clear()}},{key:"DROP_DB",value:function(){return u.default.delete("hitokoto_pwa")}}]),e}();t.default=new f},mtXx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[],o=[],r={online:!!navigator.onLine,whenOnline:function(e){return a.push(e),this},whenOffline:function(e){return o.push(e),this}};!function(){window.addEventListener("online",function(){r.online=!0,setTimeout(function(){a.forEach(function(e){e()})},0)}),window.addEventListener("offline",function(){r.online=!1,setTimeout(function(){o.forEach(function(e){e()})},0)})}(),t.default=r},nhtK:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("EjY7"),i=n("jm2v"),u=a(i),s=function(e){return{notifications:e.notify}},c=function(e){return{sendNotification:function(){return e(l.sendNotification.apply(void 0,arguments))},removeNotification:function(t){return e((0,l.removeNotification)(t))}}};t.default=(0,r.connect)(s,c)(u.default)},o16Y:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("EjY7"),i=n("LdmG"),u=a(i),s=function(e){return{sourceNew:e.sources.sourceNew,sourceRemove:e.sources.sourceRemove}},c=function(e){return{newOneSourceDone:function(){return e((0,l.newOneSourceDone)())},removeOneSourceDone:function(){return e((0,l.removeOneSourceDone)())}}};t.default=(0,r.connect)(s,c)(u.default)},oHpa:function(e,t){e.exports={"login-box":"_1FWEkCo444SwopOm9BTNib"}},opgY:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("O27J"),d=a(c),f=document.getElementById("modal-root"),h=t.Modal=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.el=document.createElement("div"),n.el.classList.add("modal__root"),n}return l(t,e),i(t,[{key:"componentDidMount",value:function(){var e=this;this.el.classList.add("modal-enter"),f.appendChild(this.el),setTimeout(function(){e.el.classList.remove("modal-enter")},300);var t=document.body.classList;t.contains("overflowhide")||t.add("overflowhide")}},{key:"componentWillReceiveProps",value:function(e){e.exit&&!this.props.exit&&this.el.classList.add("modal-leave")}},{key:"componentWillUnmount",value:function(){if(1==f.children.length){var e=document.body.classList;e.contains("overflowhide")&&e.remove("overflowhide")}f.removeChild(this.el)}},{key:"render",value:function(){return d.default.createPortal(this.props.children,this.el)}}]),t}(s.default.Component),p=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={exit:!1},n.proxyExit=n.proxyExit.bind(n),n}return l(t,e),i(t,[{key:"proxyExit",value:function(e){var t=this;this.setState({exit:!0},function(){setTimeout(function(){t.props.exit()},400)}),e&&e.stopPropagation()}},{key:"render",value:function(){var e=this,t=this.props,n=(t.exit,t.children),a=t.focus;return s.default.createElement(h,{exit:this.state.exit},s.default.createElement("div",{className:"modal",onClick:a?null:this.proxyExit},s.default.createElement("div",{className:"modal__card",onClick:function(t){"exit"==t.target.getAttribute("role")&&e.proxyExit(),a||t.stopPropagation()}},s.default.createElement("span",{className:"modal__default-close",onClick:this.proxyExit},s.default.createElement("i",{className:"iconfont icon-round_close_light",onClick:this.proxyExit})),n)))}}]),t}(s.default.Component);t.default=p},ptZP:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("KSGD"),d=a(c),f=n("8f34"),h=a(f),p=n("8Hyw"),m=a(p),v=n("ivrE"),y=a(v),E=n("ZRDb"),b=a(E),g=(n("z55N"),function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:"",path:"/",currentPatternID:h.default.pattern.id},n}return l(t,e),i(t,[{key:"updateNameAndToken",value:function(e){var t=e.nickname,n=e.token;this.setState({nickname:t}),$setNickname(t),h.default.httpManager.updateToken(n)}},{key:"componentWillUnmount",value:function(){this.props.hideNav()}},{key:"render",value:function(){var e=this.props,t=(e.user,e.layout),n=(e.panel,t.backgroundColor,t.revert2white),a={height:"100%",width:"100%",overflow:"hidden"};return s.default.createElement("div",{key:"firstFrame",style:a,className:n?"revert2white":""},s.default.createElement(b.default,null),s.default.createElement(m.default,null),s.default.createElement(y.default,null))}}]),t}(u.Component));g.propTypes={layout:d.default.object.isRequired,user:d.default.object.isRequired,panel:d.default.string.isRequired},t.default=g},qTPi:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n("GiK3"),c=a(s),d=n("f7Do"),f=(a(d),n("Vgyu")),h=a(f),p=n("8f34"),m=a(p),v=n("YpvI"),y=a(v),E=n("EjY7"),b=n("cS16"),g=a(b),k=n("gK+r"),w=a(k),O=m.default.patterManager,_=function(e){var t=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i");return e.length<2083&&t.test(e)},S=function(){(0,y.default)("Adapter是一个JavaScript函数，接收一个json格式的参数，返回一个hitokoto，用于将其他网站返回的json数据转换成本地需要的hitokoto格式。使用new Function(\"resp\",函数体代码)，构造adapter函数，所以只写函数体的代码。API请求的结果将作为参数resp传入函数，你可以直接在函数体里使用resp变量。\n函数体需要返回一个JSON对象，包含的键名有id、hitokoto、source、creator、type、created_at。\n示例：\nfunction (resp){\n\treturn {\n\t\tid: resp.uuid,  //  不建议使用随机值\n\t\thitokoto: resp.hitokoto,\n\t\tsource: resp.source || '无来源',\n\t\tcreator: resp.owner,\n\t\ttype: resp.info.type,\n\t\tcreated_at: resp.info.when\n\t}}","info",!0)},N=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.goBack=n.goBack.bind(n),n}return l(t,e),u(t,[{key:"goBack",value:function(){this.props.history.goBack()}},{key:"handleUpdate",value:function(){var e=this,t=this.props.rinfo,n=Number(t[1]),a=this.refs.sourceName.value.trim(),o=this.refs.sourceUrl.value.trim(),r=this.sourceAdapter.value.trim();if(r=r||0,0==a.length)return void(0,y.default)("名字不能为空！","error");if(0==o.length)return void(0,y.default)("url不能为空！","error");if(!_(o))return void(0,y.default)("请填写正确的URL！包括请求的协议！","error");var l={id:n,name:a,url:o,adapter:r};l.adapter?m.default.testSourceAdapter(l.url,l.adapter).then(function(){O.updateSource(l.id,l),(0,y.default)("修改成功！","success"),e.goBack()}).catch(function(e){"string"==typeof e?(0,y.default)(e,"error"):"object"==(void 0===e?"undefined":i(e))&&(0,y.default)(e.message||e.err.message,"error")}):(O.updateSource(l.id,l),(0,y.default)("修改成功！","success"),this.goBack())}},{key:"handleNewSource",value:function(){var e=this,t=(this.props.rinfo,this.refs.sourceName.value.trim()),n=this.refs.sourceUrl.value.trim(),a=this.sourceAdapter.value.trim();if(0==t.length)return void(0,y.default)("名字不能为空！","error");if(0==n.length)return void(0,y.default)("url不能为空！","error");if(!_(n))return void(0,y.default)("请填写正确的URL！包括请求的协议！","error");a.length;var o={id:Date.now(),name:t,url:n,adapter:a,online:!0,local:!0};o.adapter?m.default.testSourceAdapter(o.url,o.adapter).then(function(){O.newSource(o),g.default.dispatch((0,E.newOneSource)(o)),e.goBack()}).catch(function(e){"string"==typeof e?(0,y.default)(e,"error"):"object"==(void 0===e?"undefined":i(e))&&(0,y.default)(e.message||e.err.message,"error")}):(O.newSource(o),g.default.dispatch((0,E.newOneSource)(o)),this.goBack())}},{key:"render",value:function(){var e=this,t=this.props.rinfo,n=t[1],a="new"===n,o=void 0,r=void 0;return a||(n=Number(n),r=O.sources.find(function(e){return e.id===n})),r&&"string"==typeof r.adapter&&(o=r.adapter.split("\n").length),o<10&&(o=10),r=r||{},c.default.createElement(w.default,{cardname:a?"新增来源":"修改来源"},c.default.createElement("p",{className:"fs-tip"},c.default.createElement("i",{className:"iconfont icon-tishi"}),c.default.createElement("span",null,"手机全屏模式下可能无法编辑底部区域，请退出全屏模式再编辑。")),c.default.createElement("div",{className:"form"},c.default.createElement("div",{className:"text-filed blocked"},c.default.createElement("input",{type:"text",required:!0,ref:"sourceName",defaultValue:r.name}),c.default.createElement("label",{"data-content":"来源名字"},"来源名字")),c.default.createElement("div",{className:"text-filed blocked"},c.default.createElement("input",{type:"text",required:!0,ref:"sourceUrl",defaultValue:r.url}),c.default.createElement("label",{"data-content":"URL(参数也写上)"},"URL")),c.default.createElement("label",{htmlFor:""},"Adapter:"),c.default.createElement("br",null),c.default.createElement("p",null,c.default.createElement("i",{className:"iconfont icon-tishi"}),c.default.createElement("a",{href:"javascript:",onClick:S},"查看示例"),"（非开发人员请跳过该设置，也不要粘贴来历不明的代码，不填写内容表示不使用Adapter。）"),c.default.createElement(h.default,{inputRef:function(t){return e.sourceAdapter=t},minRows:3,defaultValue:0==r.adapter?"":r.adapter,placeholder:"PS:不要在此粘贴来历不明的代码！"})),c.default.createElement("br",null),c.default.createElement("div",null,a?c.default.createElement("button",{onClick:this.handleNewSource.bind(this)},"确认新增"):c.default.createElement("button",{onClick:this.handleUpdate.bind(this)},"确认修改"),c.default.createElement("button",{onClick:this.goBack,className:"color-basic"},"取消")))}}]),t}(s.Component);t.default=N},qZf1:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n("GiK3"),r=(a(o),n("RH2O")),l=n("4/At"),i=a(l),u=n("EjY7"),s=function(e){var t=e.collections,n=e.layout;return{preview:t.preview,layout:n}},c=function(e){return{cleanPreview:function(t){return e((0,u.cleanPreview)(t))}}};t.default=(0,r.connect)(s,c)(i.default)},rhec:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("f7Do"),d=a(c),f=n("D9xO"),h=(a(f),n("F8kA")),p=n("bFiM"),m=(a(p),n("YpvI")),v=a(m),y=n("mtXx"),E=a(y),b=n("Bn1k"),g=a(b),k=n("84MT"),w=a(k),O=n("bvS8"),_=a(O),S=n("qTPi"),N=a(S),C=n("0xOS"),P=a(C),T=n("SMjv"),I=a(T),R=n("lqTJ"),A=a(R),x=n("+IY7"),j=a(x),M=n("WoSU"),D=a(M),L=n("N9Rm"),H=a(L),F=n("8d1s"),U=a(F),Y=n("cgPw"),W=a(Y),B=n("IfnF"),K=a(B),G=n("C0xF"),q=a(G),J=n("IpQa"),V=a(J),z=n("jyx7"),X=a(z),Q=n("hy1G"),$=a(Q),Z=n("E5dx"),ee=a(Z),te=n("OH9m"),ne=a(te),ae=n("WC+y"),oe=a(ae),re=n("UA1V"),le=a(re),ie=n("Ic9l"),ue=a(ie),se=n("lDx5"),ce=a(se),de=n("SC4H"),fe=a(de),he=n("Ppqp"),pe=a(he),me=n("T0SW"),ve=a(me),ye=n("qZf1"),Ee=a(ye),be=n("SUp7"),ge=a(be),ke=n("QcX0"),we=(a(ke),n("nhtK")),Oe=a(we),_e=n("o16Y"),Se=a(_e),Ne=n("z55N"),Ce=[{to:/^(\/|\/login)$/,component:X.default,name:"首页",reload:!0},{to:/^\/managements\/?$/,component:j.default,name:"管理导航页面",reload:!0},{to:/^\/admin\/?$/,component:H.default,name:"后台管理页面",reload:!0},{to:/^\/admin\/review\/?$/,component:U.default,name:"审核句子页面",reload:!0},{to:/^\/admin\/broadcast\/?$/,component:W.default,name:"广播页面",reload:!0},{to:/^\/managements\/sources$/,component:_.default,name:"来源管理",reload:!0},{to:/^\/managements\/sources\/(new|\d+)(\/update)?$/,component:N.default,name:"来源编辑页面"},{to:/^\/managements\/patterns$/,component:g.default,name:"模式管理",reload:!0},{to:/^\/managements\/patterns\/(new|\d+)(\/update)?$/,component:w.default,name:"模式编辑页面"},{to:/^\/managements\/sync$/,component:oe.default,name:"离线缓存页面",reload:!0},{to:/^\/managements\/cleaner$/,component:le.default,name:"缓存清理页面",reload:!0},{to:/^\/managements\/favorites$/,component:ce.default,name:"我的收藏页面",reload:!0},{to:/^\/managements\/backup$/,component:fe.default,name:"备份还原页面",reload:!0},{to:/^\/explore\/?/,component:D.default,name:"广场页面",reload:!0},{to:/^\/about\/?$/,component:P.default,name:"关于页面",reload:!0},{to:/^\/doc\/?$/,component:I.default,name:"接口文档页面",reload:!0},{to:/^\/myspace\/?$/,component:ee.default,name:"个人中心页面",reload:!0},{to:/^\/myspace\/collections\/?$/,component:pe.default,name:"我的全部句集页面",reload:!0},{to:/^\/myspace\/collections\/([^\/]+)\/?$/,component:ve.default,name:"句集详情页面",reload:!0},{to:/^\/myspace\/collections\/([^\/]+)(\/update|\/new)?\/preview$/,component:Ee.default,name:"句子预览页面"},{to:/^\/myspace\/collections\/([^\/]+)\/(new|update)$/,component:ge.default,name:"句子编辑页面"},{to:/^\/myspace\/profiles$/,component:$.default,name:"账号设置",reload:!0},{to:/^\/tools/,component:A.default,name:"工具页面",reload:!0},{to:/^\/license/,component:K.default,name:"开源协议页面",reload:!0},{to:/\w*/,component:ne.default,name:"404页面",reload:!0}];E.default.whenOnline(function(){return(0,v.default)("检测到网络已上线","success")}),E.default.whenOffline(function(){return(0,v.default)("检测到网络已离线","error")});var Pe=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getChildren.bind(n),n}return l(t,e),i(t,[{key:"getChildren",value:function(e){var t=e.location,n=e.history,a=Ce.map(function(e){if(e.to.test(t.pathname))return e}).filter(function(e){return e})[0],o=a.to.exec(t.pathname),r=a.component;return a.reload&&window.swUpdate?(window.location.href=e.location.pathname,s.default.createElement(ue.default,null)):s.default.createElement("div",{style:{width:"100%",position:"relative",height:"100%",backgroundColor:"white"}},s.default.createElement(d.default,{style:{width:"100%",position:"relative",height:"100%",backgroundColor:"white",overflow:"hidden",willChange:"contents"},key:"frameChange",duration:"900",animConfig:Ne.ANIMATE_CONFIG_NEXT},s.default.createElement(r,{key:a.name,rinfo:o,location:t,history:n})),s.default.createElement(V.default,null),s.default.createElement(q.default,null),s.default.createElement(Oe.default,null),s.default.createElement(Se.default,null))}},{key:"render",value:function(){return s.default.createElement(h.Route,{key:"appcontainer",render:this.getChildren})}}]),t}(u.Component);t.default=(0,h.withRouter)(Pe)},sIQx:function(e,t){e.exports={rolling:"_25lK_MB-7ErYu70k9xgoi2"}},spEe:function(e,t){e.exports={loading:"_1eOG7o4VENaJpaAKOCBMJ4"}},t8iB:function(e,t){function n(){return"serviceWorker"in navigator&&(window.fetch||"imageRendering"in document.documentElement.style)&&("https:"===window.location.protocol||"localhost"===window.location.hostname||0===window.location.hostname.indexOf("127."))}function a(e){if(e||(e={}),n()){var t=navigator.serviceWorker.register("/hitokoto-pwa/sw.js"),a=function(e){function t(){switch(l.state){case"redundant":o("onUpdateFailed"),l.onstatechange=null;break;case"installing":a||o("onUpdating");break;case"installed":r||o("onUpdateReady");break;case"activated":o("onUpdated"),l.onstatechange=null}}function n(){switch(l.state){case"redundant":l.onstatechange=null;break;case"installing":case"installed":break;case"activated":o("onInstalled"),l.onstatechange=null}}var a,r,l=e.installing||e.waiting;if(l&&!l.onstatechange){var i;e.active?(t(),i=t):(n(),i=n),a=!0,e.waiting&&(r=!0),l.onstatechange=i}},o=function(t){"function"==typeof e[t]&&e[t]({source:"ServiceWorker"})};return void t.then(function(e){e&&(a(e),e.onupdatefound=function(){a(e)})}).catch(function(e){return o("onError"),Promise.reject(e)})}if(window.applicationCache){var r=function(){var e=document.createElement("iframe");e.src="/hitokoto-pwa/appcache/manifest.html",e.style.display="none",l=e,document.body.appendChild(e)};return void("complete"===document.readyState?setTimeout(r):window.addEventListener("load",r))}}function o(e,t){if(n())return void navigator.serviceWorker.getRegistration().then(function(n){if(!n||!n.waiting)return void(t&&t());n.waiting.postMessage({action:"skipWaiting"}),e&&e()})}function r(){if(n()&&navigator.serviceWorker.getRegistration().then(function(e){if(e)return e.update()}),l)try{l.contentWindow.applicationCache.update()}catch(e){}}var l;setInterval(r,6e5),t.install=a,t.applyUpdate=o,t.update=r},"uY+K":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(){return localStorage.getItem(b+"localStored")}function l(e){localStorage.setItem(b+"localStored",e)}function i(e,t){return new Promise(function(n,a){var o=setTimeout(function(){o=void 0,a(new Error("请求超时！"))},e);t.then(function(e){o&&(clearTimeout(o),n(e))},function(e){o&&(clearTimeout(o),a(e))})})}function u(e){return console.log(e),console.warn(e),"string"==typeof e?(0,m.default)(e,"error",!0):"object"==(void 0===e?"undefined":c(e))&&e.message?/Failed to fetch/m.test(e.message)?(0,m.default)("请求未发送成功！\n      可能的原因:\n      1.您的网络异常\n      2.服务器未上线\n  \n      详细:"+e.stack,"error",!0):(0,m.default)(e.message,"error",!0):(0,m.default)("请求出错，错误："+JSON.stringify(e),"error",!0),Promise.reject(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SAME_ORIGIN=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.timeoutPromise=i;var d=n("eKmS"),f=a(d),h=n("mScD"),p=(a(h),n("YpvI")),m=a(p),v=n("EjY7"),y=n("cS16"),E=a(y),b="hitokotoToken",g=Object.prototype.toString,k=new RegExp("^"+location.protocol+"//"+location.host+"/api/sources/[^/]+/[^/]+"),w=t.SAME_ORIGIN=new RegExp("^"+location.protocol+"//"+location.host),O=function(e){if(!e||"object"!==(void 0===e?"undefined":c(e))||e.nodeType||null!=e&&e==e.window)return!1;try{if(e.constructor&&!Object.prototype.hasOwnProperty.call(e,"constructor")&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var t;for(t in e);return void 0===t||Object.prototype.hasOwnProperty.call.call(e,t)},_=function(){function e(){o(this,e),this.initQ=[],this.token=r()||"",this.responseHeaderResolver=this.responseHeaderResolver.bind(this)}return s(e,[{key:"responseHeaderResolver",value:function(e){if(w.test(e.url)){var t=e.headers.get("broadcast");if(t){t.split("|").map(function(e){return e.replace(/"/gm,"")}).some(function(e){return!f.default.hasDisplayed(e)})&&this.API_Admin_getBroadcasts().then(function(e){var t=e.messages;t&&t.length&&t.forEach(function(e){f.default.hasDisplayed(e.endAt)||(f.default.add(e.endAt),(0,m.default)(e.message,"info",!0))})})}}return e}},{key:"parseToJSON",value:function(e){return console.log("enter parseToJSON"),200===e.status?e.json():e.clone().json().catch(function(t){if(console.log(t),"string"==typeof t)return console.log(t),/^Uncaught SyntaxError/.test(t)?(console.log(t),Promise.reject(t)):Promise.reject(t);if("object"==(void 0===t?"undefined":c(t))){if(t instanceof SyntaxError){var n=t.message;return e.clone().text().catch(function(e){return console.log(e),Promise.reject(e)}).then(function(t){return t=t.trim(),0==t.length?Promise.reject(e.status+"-"+e.statusText+"\n尝试转换为JSON，错误："+n+"\n尝试转换为文本，文本长度为0."):(console.log(t),Promise.reject(t))})}return t instanceof TypeError?Promise.reject("请求失败："+t.message):Promise.reject(t)}return Promise.reject(e.status+" - "+e.statusText)}).then(function(e){if("string"==typeof e)return console.log(e),Promise.reject(e);if("object"==(void 0===e?"undefined":c(e))){var t=e.message;return"授权过期，请重新登录"==t&&(E.default.dispatch((0,v.userLogout)()),alert("授权已过期，需要重新登录"),window.location="/"),Promise.reject(t)}return Promise.reject(e)})}},{key:"updateToken",value:function(e){this.token=e,l(e)}},{key:"afterInited",value:function(){for(;this.initQ.length;){var e=this.initQ.shift();e&&e()}}},{key:"getHitokoto",value:function(e,t,n){if("next"==t){var a=this.parseQeuery({seed:n.count});/\?/.test(e)?e+="&"+a:e+="?"+a}return k.test(e)?i(13e3,fetch(e,{headers:{"X-API-TOKEN":this.token}})).then(this.responseHeaderResolver).then(this.parseToJSON):i(13e3,fetch(e)).then(this.responseHeaderResolver).then(this.parseToJSON)}},{key:"_buildPrams",value:function(e,t,n,a){var o=this;if(Array.isArray(t))t.forEach(function(t,r){n||/\[\]$/.test(e)?a(e,t):o._buildPrams(e+"["+("object"===(void 0===t?"undefined":c(t))?r:"")+"]",t,n,a)});else if(n||"object"!==(void 0===t?"undefined":c(t)))a(e,t);else for(var r in t)this._buildPrams(e+"["+r+"]",t[r],n,a)}},{key:"parseQeuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],a=function(e,t){n.push(encodeURIComponent(e)+"="+encodeURIComponent(t))};if(Array.isArray(e)&&O(e))e.forEach(function(e,t){a(t,e)});else for(var o in e)this._buildPrams(o,e[o],t,a);return n.join("&").replace(/%20/g,"+")}},{key:"_buildFormParams",value:function(e,t,n,a){var o=this;if(Array.isArray(t))t.forEach(function(t,r){n?a(e+"[]",t):o._buildFormParams(e,t,n,a)});else if(n||"object"!==(void 0===t?"undefined":c(t))||t.length||!O(t))if("[object FileList]"===g.call(t))for(var r=0;r<t.length;r++)n?a(e+"[]",t[r]):a(e,t[r]);else a(e,t);else for(var l in t)this._buildFormParams(e+"["+l+"]",t[l],n,a)}},{key:"parseFormData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(console.log(e),e){if("[object FormData]"===g.call(e))return e;var n=new FormData,a=function(t,a){~["number","string","boolean"].indexOf(void 0===a?"undefined":c(a))?n.append(t,String(a)):~["[object Blob]","[object File]"].indexOf(g.call(e))?n.append(t,a,a.name||""+Date.now()):n.append(t,a)};for(var o in e)this._buildFormParams(o,e[o],t,a);return n}}},{key:"fetchJSON",value:function(e,t,n){var a=void 0,o=void 0;return e=e.toLowerCase(),~["get","head"].indexOf(e)?a=this.parseQeuery(n):~["post","put","delete"].indexOf(e)&&(o=this.parseFormData(n)),fetch(t+(a?"?"+a:""),{method:e,body:o}).then(this.responseHeaderResolver).then(this.parseToJSON).catch(u)}},{key:"fetchAuthJSON",value:function(e,t,n){var a=void 0,o=void 0;return e=e.toLowerCase(),~["get","head"].indexOf(e)?a=this.parseQeuery(n):~["post","put","delete"].indexOf(e)&&(o=this.parseFormData(n)),fetch(t+(a?"?"+a:""),{method:e,body:o,headers:{"X-API-TOKEN":this.token}}).then(this.responseHeaderResolver).then(this.parseToJSON).catch(u)}},{key:"API_sync",value:function(e,t){t||(t={}),t.sync||(t.sync=!0);var n=this.parseQeuery(t);return/\?/.test(e)?e+="&"+n:e+="?"+n,k.test(e)?fetch(e,{headers:{"X-API-TOKEN":this.token}}).then(this.responseHeaderResolver).then(this.parseToJSON).catch(u):fetch(e).then(this.responseHeaderResolver).then(this.parseToJSON).catch(u)}},{key:"API_login",value:function(e){return this.fetchJSON("post","/api/login",e)}},{key:"API_regist",value:function(e){return this.fetchJSON("post","/api/regist",e)}},{key:"API_getAllPublicHitokotos",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.fetchJSON("get","/api/explore",{page:e,perpage:t})}},{key:"API_getPublicUserDetail",value:function(e){return this.fetchJSON("get","/api/explore/users/"+e)}},{key:"API_getPublicUserHitokotos",value:function(e,t,n,a){return this.fetchJSON("get","/api/explore/users/"+e+"/"+t,{page:n,perpage:a})}},{key:"API_updatePassword",value:function(e,t){return this.fetchAuthJSON("post","/api/password",{oldpass:e,newpass:t})}},{key:"API_getUserEmail",value:function(){return this.fetchAuthJSON("get","/api/useremail")}},{key:"API_sendOldEmailCode",value:function(){return this.fetchAuthJSON("get","/api/oldemailcode")}},{key:"API_verifyOldEmailCode",value:function(e){return this.fetchAuthJSON("post","/api/oldemailcode",{code:e})}},{key:"API_sendNewEmailCode",value:function(e){return this.fetchAuthJSON("get","/api/newemailcode",{email:e})}},{key:"API_verifyNewEmailCode",value:function(e,t){return this.fetchAuthJSON("post","/api/newemailcode",{email:e,code:t})}},{key:"API_myCollections",value:function(){return this.fetchAuthJSON("get","/api/collections")}},{key:"API_newCollection",value:function(e){return this.fetchAuthJSON("put","/api/collections",e)}},{key:"API_updateCollectionName",value:function(e){return this.fetchAuthJSON("post","/api/collections",e)}},{key:"API_deleteCollection",value:function(e){return this.fetchAuthJSON("delete","/api/collections",e)}},{key:"API_viewCollection",value:function(e,t,n){return this.fetchAuthJSON("get","/api/collections/"+e,{page:t,perpage:n})}},{key:"API_newHitokoto",value:function(e,t){return this.fetchAuthJSON("put","/api/collections/"+e,t)}},{key:"API_updateHitokoto",value:function(e,t){return this.fetchAuthJSON("post","/api/collections/"+e,t)}},{key:"API_deleteHitokoto",value:function(e,t){return this.fetchAuthJSON("delete","/api/collections/"+e,t)}},{key:"API_backup",value:function(e){return this.fetchAuthJSON("post","/api/backups",e)}},{key:"API_restore",value:function(){return this.fetchAuthJSON("get","/api/backups")}},{key:"API_Admin_getNeedReviewHitokotos",value:function(e,t){return this.fetchAuthJSON("get","/api/admin/hitokotos/review",{page:e,perpage:t})}},{key:"API_Admin_changeHitokotoState",value:function(e,t){return this.fetchAuthJSON("post","/api/admin/hitokotos/review",{hid:e,state:t})}},{key:"API_Admin_putBroadcast",value:function(e){return this.fetchAuthJSON("put","/api/admin/broadcasts",e)}},{key:"API_Admin_updateBroadcast",value:function(e){return this.fetchAuthJSON("post","/api/admin/broadcasts",e)}},{key:"API_Admin_deleteBroadcast",value:function(e){return this.fetchAuthJSON("delete","/api/admin/broadcasts",e)}},{key:"API_Admin_getBroadcasts",value:function(){return this.fetchAuthJSON("get","/api/admin/broadcasts")}}]),e}();t.default=new _},uuIP:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("GiK3"),s=a(u),c=n("KSGD"),d=a(c),f=n("f7Do"),h=a(f),p=n("uY+K"),m=a(p),v=n("YpvI"),y=a(v),E=n("mScD"),b=a(E),g=n("jdew"),k=a(g),w=n("opgY"),O=a(w),_=n("a0hn"),S=a(_),N=n("gK+r"),C=a(N),P=n("YXrc"),T=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={status:"collections",currentView:null,hitokotos:null,inited:!1,error:null,deleteCollectionModal:null},n.fetchCollections=n.fetchCollections.bind(n),n.viewCollection=n.viewCollection.bind(n),n.newCollection=n.newCollection.bind(n),n.changeCollectionName=n.changeCollectionName.bind(n),n.showDeleteModal=n.showDeleteModal.bind(n),n.hideDeleteModal=n.hideDeleteModal.bind(n),n.deleteCollection=n.deleteCollection.bind(n),n}return l(t,e),i(t,[{key:"componentDidMount",value:function(){this.fetchCollections()}},{key:"fetchCollections",value:function(){var e=this;m.default.API_myCollections().then(function(t){e.setState({inited:!0,error:null}),e.props.fetchCollectionSuccess(t.collections),b.default.putCollections(t.collections)}).catch(function(t){e.setState({error:t.message||t,inited:!1})})}},{key:"viewCollection",value:function(e){this.props.history.push(this.props.location.pathname+"/"+e)}},{key:"newCollection",value:function(e){var t=this;return m.default.API_newCollection({name:e}).then(function(e){(0,y.default)(e.message,"success"),t.props.fetchCollectionSuccess(e.collections)})}},{key:"changeCollectionName",value:function(e,t){var n=this;if("默认句集"===e)return void(0,y.default)("默认句集无法修改","error");m.default.API_updateCollectionName({oldname:e,newname:t}).then(function(e){(0,y.default)(e.message,"success"),n.props.fetchCollectionSuccess(e.collections)})}},{key:"showDeleteModal",value:function(e){if("默认句集"===e)return void(0,y.default)(默认句集无法删除,"error");this.setState({deleteCollectionModal:e})}},{key:"hideDeleteModal",value:function(){this.setState({deleteCollectionModal:null})}},{key:"deleteCollection",value:function(){var e=this,t=this.state.deleteCollectionModal;m.default.API_deleteCollection({name:t}).then(function(t){e.hideDeleteModal(),(0,y.default)(t.message,"success"),e.props.fetchCollectionSuccess(t.collections)})}},{key:"render",value:function(){var e=this,t=this.state,n=(t.status,t.inited),a=this.props.collections.data,o=void 0;return n?(o=a.map(function(t,n){return s.default.createElement(k.default,{changeName:e.changeCollectionName,nickname:e.props.user.nickname,delete:e.showDeleteModal,tabIndex:n+1,view:e.viewCollection,key:t.name,data:t})}),o.unshift(s.default.createElement(k.default,{tabIndex:0,newone:!0,newCollection:this.newCollection,key:"newcol",data:{}}))):o=s.default.createElement(S.default,{error:this.state.error,retry:this.fetchCollections,key:"loading"}),s.default.createElement(C.default,{cardname:"我的句集"},s.default.createElement(h.default,{animConfig:[{opacity:[1,0],translateX:[0,50]},{opacity:[1,0],position:"absolute",translateX:[0,-50]}],className:P.CardContainer},o),this.state.deleteCollectionModal?s.default.createElement(O.default,{exit:this.hideDeleteModal},s.default.createElement("h1",null,"你确定要删除该句集?"),s.default.createElement("div",{className:"clearfix"},s.default.createElement("span",{className:"pull-right"},s.default.createElement("button",{role:"exit"},"取消"),s.default.createElement("button",{onClick:this.deleteCollection},"确定")))):null)}}]),t}(u.Component);T.propTypes={history:d.default.object.isRequired,collections:d.default.object.isRequired,fetchCollectionSuccess:d.default.func.isRequired},t.default=T},uwXn:function(e,t,n){"use strict";function a(e){e=e||document.documentElement,e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function o(){return document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled}function r(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function l(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}Object.defineProperty(t,"__esModule",{value:!0}),t.launchIntoFullscreen=a,t.isFullscreenEnabled=o,t.getFullScreenELement=r,t.exitFullscreen=l,t.default={launchIntoFullscreen:a,fullscreenEnabled:o(),isFullscreenEnabled:o,getFullScreenELement:r,exitFullscreen:l,toggleFullScreen:function(){if(this.fullscreenEnabled){this.getFullScreenELement()?this.exitFullscreen():this.launchIntoFullscreen()}}}},"vxS+":function(e,t,n){function a(e){if(Array.isArray(e))return E(e.constructor(e.length),e);if("Map"===y(e))return new Map(e);if("Set"===y(e))return new Set(e);if(e&&"object"==typeof e){var t=Object.getPrototypeOf(e);return E(Object.create(t),e)}return e}function o(){function e(n,o){"function"==typeof o&&(o={$apply:o}),Array.isArray(n)&&Array.isArray(o)||h(!Array.isArray(o),"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."),h("object"==typeof o&&null!==o,"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: %s.",Object.keys(t).join(", "));var r=n;return b(o).forEach(function(l){if(p.call(t,l)){var i=n===r;r=t[l](o[l],r,o,n),i&&e.isEquals(r,n)&&(r=n)}else{var u="Map"===y(n)?e(n.get(l),o[l]):e(n[l],o[l]),s="Map"===y(r)?r.get(l):r[l];e.isEquals(u,s)&&(void 0!==u||p.call(n,l))||(r===n&&(r=a(n)),"Map"===y(r)?r.set(l,u):r[l]=u)}}),r}var t=E({},g);return e.extend=function(e,n){t[e]=n},e.isEquals=function(e,t){return e===t},e}function r(e,t,n){h(Array.isArray(e),"update(): expected target of %s to be an array; got %s.",n,e),l(t[n],n)}function l(e,t){h(Array.isArray(e),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",t,e)}function i(e,t){h(Array.isArray(e),"Expected $splice target to be an array; got %s",e),u(t.$splice)}function u(e){h(Array.isArray(e),"update(): expected spec of $splice to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",e)}function s(e){h("function"==typeof e,"update(): expected spec of $apply to be a function; got %s.",e)}function c(e){h(1===Object.keys(e).length,"Cannot have more than one key in an object with $set")}function d(e,t){h(t&&"object"==typeof t,"update(): $merge expects a spec of type 'object'; got %s",t),h(e&&"object"==typeof e,"update(): $merge expects a target of type 'object'; got %s",e)}function f(e,t){var n=y(e);h("Map"===n||"Set"===n,"update(): %s expects a target of type Set or Map; got %s",t,n)}var h=n("crWv"),p=Object.prototype.hasOwnProperty,m=Array.prototype.splice,v=Object.prototype.toString,y=function(e){return v.call(e).slice(8,-1)},E=Object.assign||function(e,t){return b(t).forEach(function(n){p.call(t,n)&&(e[n]=t[n])}),e},b="function"==typeof Object.getOwnPropertySymbols?function(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.keys(e)},g={$push:function(e,t,n){return r(t,n,"$push"),e.length?t.concat(e):t},$unshift:function(e,t,n){return r(t,n,"$unshift"),e.length?e.concat(t):t},$splice:function(e,t,n,o){return i(t,n),e.forEach(function(e){u(e),t===o&&e.length&&(t=a(o)),m.apply(t,e)}),t},$set:function(e,t,n){return c(n),e},$toggle:function(e,t){l(e,"$toggle");var n=e.length?a(t):t;return e.forEach(function(e){n[e]=!t[e]}),n},$unset:function(e,t,n,o){return l(e,"$unset"),e.forEach(function(e){Object.hasOwnProperty.call(t,e)&&(t===o&&(t=a(o)),delete t[e])}),t},$add:function(e,t,n,o){return f(t,"$add"),l(e,"$add"),"Map"===y(t)?e.forEach(function(e){var n=e[0],r=e[1];t===o&&t.get(n)!==r&&(t=a(o)),t.set(n,r)}):e.forEach(function(e){t!==o||t.has(e)||(t=a(o)),t.add(e)}),t},$remove:function(e,t,n,o){return f(t,"$remove"),l(e,"$remove"),e.forEach(function(e){t===o&&t.has(e)&&(t=a(o)),t.delete(e)}),t},$merge:function(e,t,n,o){return d(t,e),b(e).forEach(function(n){e[n]!==t[n]&&(t===o&&(t=a(o)),t[n]=e[n])}),t},$apply:function(e,t){return s(e),e(t)}},k=o();e.exports=k,e.exports.default=k,e.exports.newContext=o},wNBo:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.hitokoto,n=t.id,a=t.source,o=t.author,r=t.hitokoto,i=(t.creator,t.created_at,t.type,e.layout),u=i.backgroundColor,s=i.font,d=i.fontWeight,f=e.animateConfig,h=e.actions,y=!1;return r&&r.length>b&&(y=!0),l.default.createElement("div",{className:m.layout_horizon+(e.overflowhide?" overflowhide":""),style:{backgroundColor:u}},l.default.createElement(p.default,null),l.default.createElement(E.default,null),l.default.createElement(c.default,{animConfig:f,ease:["easeOutQuart","easeInOutQuart"],className:"animate-none-sense",style:{position:"relative",height:"100%",width:"100%",maxWidth:"1000px",margin:"0 auto"}},l.default.createElement(c.default,{key:n+"content",ease:["easeOutQuart","easeInOutQuart"],animConfig:f,className:m.Content+(y?" "+m.overLoadHitokoto:"")},l.default.createElement("h1",{style:{fontFamily:v.FONT_MAP[s],fontWeight:d},key:n+"hito"},r),o||a?l.default.createElement("p",{key:n+"from",style:{fontFamily:v.FONT_MAP[s]}},"——  ",o||"",o?" ":"",a):null,l.default.createElement("div",{className:"oprations",key:n+"oprations"},l.default.createElement("ul",{className:m.actions},h)))))}Object.defineProperty(t,"__esModule",{value:!0});var r=n("GiK3"),l=a(r),i=n("KSGD"),u=a(i),s=n("f7Do"),c=a(s),d=n("16R6"),f=a(d),h=n("IaXC"),p=a(h),m=n("D9xO"),v=n("z55N"),y=n("Sw03"),E=a(y),b=f.default.width>768?140:40;f.default.subscriptb(function(){b=f.default.width>768?140:40}),o.PropTypes={hitokoto:u.default.object.isRequired,layout:u.default.object.isRequired},t.default=o},yoG6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("EjY7"),o=n("vxS+"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case a.SHOW_NOTIFICATION:return(0,r.default)(e,{$push:[{id:t.id,type:t.ntype,msg:t.value,interactive:t.interactive}]});case a.REMOVE_NOTIFICATION:var n=e.findIndex(function(e){return e.id==t.value});return(0,r.default)(e,{$splice:[[n,1]]});case a.UPDATE_TASK:var o=e.findIndex(function(e){return e.id==t.id}),l=void 0===t.done?"task":!0===t.done?"success":"error";return~o?(0,r.default)(e,{$splice:[[o,1,{id:t.id,type:l,msg:t.value,interactive:!0}]]}):(0,r.default)(e,{$push:[{id:t.id,type:l,msg:t.value,interactive:!0}]});case a.REMOVE_TASK:var i=e.findIndex(function(e){return e.id==t.value});return(0,r.default)(e,{$splice:[[i,1]]});default:return e}};t.default=l},z55N:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ANIMATE_CONFIG_NEXT=[{opacity:[1,0],translateX:[0,100]},{opacity:[1,0],zIndex:-1,position:"absolute",translateX:[0,-100]}],t.ANIMATE_CONFIG_LAST=[{opacity:[1,0],translateZ:[0,20],translateX:[0,-100]},{opacity:[1,0],zIndex:-1,position:"absolute",translateX:[0,100]}],t.ANIMATE_CONFIG_HORIZON=[{opacity:[1,0],translateX:[0,-50]},{opacity:[1,0],zIndex:-1,position:"absolute",translateX:[0,50]}],t.GLOBAL_ANIMATE_TYPE=["right","left"],t.FONT_MAP={default:"inherit",simsun:"'Noto Serif CJK SC', 'Source Han Serif SC', 'Source Han Serif', source-han-serif-sc, '宋体', SimSun, '华文细黑', STXihei, serif",fangsong:'Georgia,"Times New Roman", "FangSong", "仿宋", STFangSong, "华文仿宋", serif',kai:'"楷体",serif'}}},["akvE"]);